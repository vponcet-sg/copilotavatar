import{g as Yh}from"./react-CUnOHQ37.js";var ne={},ie={},Ne={},se={},D={},Zn={},oe={},Yn={},je={},Hn={},js;function Hp(){if(js)return Hn;js=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.default=n;let e;const r=new Uint8Array(16);function n(){if(!e&&(e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(r)}return Hn}var De={},qe={},Le={},qs;function el(){if(qs)return Le;qs=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.default=void 0;var e=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;return Le.default=e,Le}var Ls;function Jn(){if(Ls)return qe;Ls=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.default=void 0;var e=r(el());function r(s){return s&&s.__esModule?s:{default:s}}function n(s){return typeof s=="string"&&e.default.test(s)}var u=n;return qe.default=u,qe}var Bs;function Gn(){if(Bs)return De;Bs=1,Object.defineProperty(De,"__esModule",{value:!0}),De.default=void 0,De.unsafeStringify=u;var e=r(Jn());function r(i){return i&&i.__esModule?i:{default:i}}const n=[];for(let i=0;i<256;++i)n.push((i+256).toString(16).slice(1));function u(i,t=0){return n[i[t+0]]+n[i[t+1]]+n[i[t+2]]+n[i[t+3]]+"-"+n[i[t+4]]+n[i[t+5]]+"-"+n[i[t+6]]+n[i[t+7]]+"-"+n[i[t+8]]+n[i[t+9]]+"-"+n[i[t+10]]+n[i[t+11]]+n[i[t+12]]+n[i[t+13]]+n[i[t+14]]+n[i[t+15]]}function s(i,t=0){const o=u(i,t);if(!(0,e.default)(o))throw TypeError("Stringified UUID is invalid");return o}var a=s;return De.default=a,De}var Fs;function tl(){if(Fs)return je;Fs=1,Object.defineProperty(je,"__esModule",{value:!0}),je.default=void 0;var e=n(Hp()),r=Gn();function n(c){return c&&c.__esModule?c:{default:c}}let u,s,a=0,i=0;function t(c,p,d){let l=p&&d||0;const h=p||new Array(16);c=c||{};let g=c.node||u,f=c.clockseq!==void 0?c.clockseq:s;if(g==null||f==null){const R=c.random||(c.rng||e.default)();g==null&&(g=u=[R[0]|1,R[1],R[2],R[3],R[4],R[5]]),f==null&&(f=s=(R[6]<<8|R[7])&16383)}let S=c.msecs!==void 0?c.msecs:Date.now(),v=c.nsecs!==void 0?c.nsecs:i+1;const m=S-a+(v-i)/1e4;if(m<0&&c.clockseq===void 0&&(f=f+1&16383),(m<0||S>a)&&c.nsecs===void 0&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=S,i=v,s=f,S+=122192928e5;const C=((S&268435455)*1e4+v)%4294967296;h[l++]=C>>>24&255,h[l++]=C>>>16&255,h[l++]=C>>>8&255,h[l++]=C&255;const y=S/4294967296*1e4&268435455;h[l++]=y>>>8&255,h[l++]=y&255,h[l++]=y>>>24&15|16,h[l++]=y>>>16&255,h[l++]=f>>>8|128,h[l++]=f&255;for(let R=0;R<6;++R)h[l+R]=g[R];return p||(0,r.unsafeStringify)(h)}var o=t;return je.default=o,je}var Be={},Y={},Fe={},xs;function $p(){if(xs)return Fe;xs=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.default=void 0;var e=r(Jn());function r(s){return s&&s.__esModule?s:{default:s}}function n(s){if(!(0,e.default)(s))throw TypeError("Invalid UUID");let a;const i=new Uint8Array(16);return i[0]=(a=parseInt(s.slice(0,8),16))>>>24,i[1]=a>>>16&255,i[2]=a>>>8&255,i[3]=a&255,i[4]=(a=parseInt(s.slice(9,13),16))>>>8,i[5]=a&255,i[6]=(a=parseInt(s.slice(14,18),16))>>>8,i[7]=a&255,i[8]=(a=parseInt(s.slice(19,23),16))>>>8,i[9]=a&255,i[10]=(a=parseInt(s.slice(24,36),16))/1099511627776&255,i[11]=a/4294967296&255,i[12]=a>>>24&255,i[13]=a>>>16&255,i[14]=a>>>8&255,i[15]=a&255,i}var u=n;return Fe.default=u,Fe}var Us;function Kp(){if(Us)return Y;Us=1,Object.defineProperty(Y,"__esModule",{value:!0}),Y.URL=Y.DNS=void 0,Y.default=i;var e=Gn(),r=n($p());function n(t){return t&&t.__esModule?t:{default:t}}function u(t){t=unescape(encodeURIComponent(t));const o=[];for(let c=0;c<t.length;++c)o.push(t.charCodeAt(c));return o}const s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Y.DNS=s;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Y.URL=a;function i(t,o,c){function p(d,l,h,g){var f;if(typeof d=="string"&&(d=u(d)),typeof l=="string"&&(l=(0,r.default)(l)),((f=l)===null||f===void 0?void 0:f.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let S=new Uint8Array(16+d.length);if(S.set(l),S.set(d,l.length),S=c(S),S[6]=S[6]&15|o,S[8]=S[8]&63|128,h){g=g||0;for(let v=0;v<16;++v)h[g+v]=S[v];return h}return(0,e.unsafeStringify)(S)}try{p.name=t}catch{}return p.DNS=s,p.URL=a,p}return Y}var xe={},Ws;function rl(){if(Ws)return xe;Ws=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.default=void 0;function e(h){if(typeof h=="string"){const g=unescape(encodeURIComponent(h));h=new Uint8Array(g.length);for(let f=0;f<g.length;++f)h[f]=g.charCodeAt(f)}return r(u(s(h),h.length*8))}function r(h){const g=[],f=h.length*32,S="0123456789abcdef";for(let v=0;v<f;v+=8){const m=h[v>>5]>>>v%32&255,C=parseInt(S.charAt(m>>>4&15)+S.charAt(m&15),16);g.push(C)}return g}function n(h){return(h+64>>>9<<4)+14+1}function u(h,g){h[g>>5]|=128<<g%32,h[n(g)-1]=g;let f=1732584193,S=-271733879,v=-1732584194,m=271733878;for(let C=0;C<h.length;C+=16){const y=f,R=S,I=v,w=m;f=o(f,S,v,m,h[C],7,-680876936),m=o(m,f,S,v,h[C+1],12,-389564586),v=o(v,m,f,S,h[C+2],17,606105819),S=o(S,v,m,f,h[C+3],22,-1044525330),f=o(f,S,v,m,h[C+4],7,-176418897),m=o(m,f,S,v,h[C+5],12,1200080426),v=o(v,m,f,S,h[C+6],17,-1473231341),S=o(S,v,m,f,h[C+7],22,-45705983),f=o(f,S,v,m,h[C+8],7,1770035416),m=o(m,f,S,v,h[C+9],12,-1958414417),v=o(v,m,f,S,h[C+10],17,-42063),S=o(S,v,m,f,h[C+11],22,-1990404162),f=o(f,S,v,m,h[C+12],7,1804603682),m=o(m,f,S,v,h[C+13],12,-40341101),v=o(v,m,f,S,h[C+14],17,-1502002290),S=o(S,v,m,f,h[C+15],22,1236535329),f=c(f,S,v,m,h[C+1],5,-165796510),m=c(m,f,S,v,h[C+6],9,-1069501632),v=c(v,m,f,S,h[C+11],14,643717713),S=c(S,v,m,f,h[C],20,-373897302),f=c(f,S,v,m,h[C+5],5,-701558691),m=c(m,f,S,v,h[C+10],9,38016083),v=c(v,m,f,S,h[C+15],14,-660478335),S=c(S,v,m,f,h[C+4],20,-405537848),f=c(f,S,v,m,h[C+9],5,568446438),m=c(m,f,S,v,h[C+14],9,-1019803690),v=c(v,m,f,S,h[C+3],14,-187363961),S=c(S,v,m,f,h[C+8],20,1163531501),f=c(f,S,v,m,h[C+13],5,-1444681467),m=c(m,f,S,v,h[C+2],9,-51403784),v=c(v,m,f,S,h[C+7],14,1735328473),S=c(S,v,m,f,h[C+12],20,-1926607734),f=p(f,S,v,m,h[C+5],4,-378558),m=p(m,f,S,v,h[C+8],11,-2022574463),v=p(v,m,f,S,h[C+11],16,1839030562),S=p(S,v,m,f,h[C+14],23,-35309556),f=p(f,S,v,m,h[C+1],4,-1530992060),m=p(m,f,S,v,h[C+4],11,1272893353),v=p(v,m,f,S,h[C+7],16,-155497632),S=p(S,v,m,f,h[C+10],23,-1094730640),f=p(f,S,v,m,h[C+13],4,681279174),m=p(m,f,S,v,h[C],11,-358537222),v=p(v,m,f,S,h[C+3],16,-722521979),S=p(S,v,m,f,h[C+6],23,76029189),f=p(f,S,v,m,h[C+9],4,-640364487),m=p(m,f,S,v,h[C+12],11,-421815835),v=p(v,m,f,S,h[C+15],16,530742520),S=p(S,v,m,f,h[C+2],23,-995338651),f=d(f,S,v,m,h[C],6,-198630844),m=d(m,f,S,v,h[C+7],10,1126891415),v=d(v,m,f,S,h[C+14],15,-1416354905),S=d(S,v,m,f,h[C+5],21,-57434055),f=d(f,S,v,m,h[C+12],6,1700485571),m=d(m,f,S,v,h[C+3],10,-1894986606),v=d(v,m,f,S,h[C+10],15,-1051523),S=d(S,v,m,f,h[C+1],21,-2054922799),f=d(f,S,v,m,h[C+8],6,1873313359),m=d(m,f,S,v,h[C+15],10,-30611744),v=d(v,m,f,S,h[C+6],15,-1560198380),S=d(S,v,m,f,h[C+13],21,1309151649),f=d(f,S,v,m,h[C+4],6,-145523070),m=d(m,f,S,v,h[C+11],10,-1120210379),v=d(v,m,f,S,h[C+2],15,718787259),S=d(S,v,m,f,h[C+9],21,-343485551),f=a(f,y),S=a(S,R),v=a(v,I),m=a(m,w)}return[f,S,v,m]}function s(h){if(h.length===0)return[];const g=h.length*8,f=new Uint32Array(n(g));for(let S=0;S<g;S+=8)f[S>>5]|=(h[S/8]&255)<<S%32;return f}function a(h,g){const f=(h&65535)+(g&65535);return(h>>16)+(g>>16)+(f>>16)<<16|f&65535}function i(h,g){return h<<g|h>>>32-g}function t(h,g,f,S,v,m){return a(i(a(a(g,h),a(S,m)),v),f)}function o(h,g,f,S,v,m,C){return t(g&f|~g&S,h,g,v,m,C)}function c(h,g,f,S,v,m,C){return t(g&S|f&~S,h,g,v,m,C)}function p(h,g,f,S,v,m,C){return t(g^f^S,h,g,v,m,C)}function d(h,g,f,S,v,m,C){return t(f^(g|~S),h,g,v,m,C)}var l=e;return xe.default=l,xe}var Vs;function nl(){if(Vs)return Be;Vs=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.default=void 0;var e=n(Kp()),r=n(rl());function n(a){return a&&a.__esModule?a:{default:a}}var s=(0,e.default)("v3",48,r.default);return Be.default=s,Be}var Ue={},We={},Hs;function il(){if(Hs)return We;Hs=1,Object.defineProperty(We,"__esModule",{value:!0}),We.default=void 0;var r={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};return We.default=r,We}var $s;function sl(){if($s)return Ue;$s=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.default=void 0;var e=u(il()),r=u(Hp()),n=Gn();function u(i){return i&&i.__esModule?i:{default:i}}function s(i,t,o){if(e.default.randomUUID&&!t&&!i)return e.default.randomUUID();i=i||{};const c=i.random||(i.rng||r.default)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,t){o=o||0;for(let p=0;p<16;++p)t[o+p]=c[p];return t}return(0,n.unsafeStringify)(c)}var a=s;return Ue.default=a,Ue}var Ve={},He={},Ks;function ol(){if(Ks)return He;Ks=1,Object.defineProperty(He,"__esModule",{value:!0}),He.default=void 0;function e(s,a,i,t){switch(s){case 0:return a&i^~a&t;case 1:return a^i^t;case 2:return a&i^a&t^i&t;case 3:return a^i^t}}function r(s,a){return s<<a|s>>>32-a}function n(s){const a=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof s=="string"){const p=unescape(encodeURIComponent(s));s=[];for(let d=0;d<p.length;++d)s.push(p.charCodeAt(d))}else Array.isArray(s)||(s=Array.prototype.slice.call(s));s.push(128);const t=s.length/4+2,o=Math.ceil(t/16),c=new Array(o);for(let p=0;p<o;++p){const d=new Uint32Array(16);for(let l=0;l<16;++l)d[l]=s[p*64+l*4]<<24|s[p*64+l*4+1]<<16|s[p*64+l*4+2]<<8|s[p*64+l*4+3];c[p]=d}c[o-1][14]=(s.length-1)*8/Math.pow(2,32),c[o-1][14]=Math.floor(c[o-1][14]),c[o-1][15]=(s.length-1)*8&4294967295;for(let p=0;p<o;++p){const d=new Uint32Array(80);for(let v=0;v<16;++v)d[v]=c[p][v];for(let v=16;v<80;++v)d[v]=r(d[v-3]^d[v-8]^d[v-14]^d[v-16],1);let l=i[0],h=i[1],g=i[2],f=i[3],S=i[4];for(let v=0;v<80;++v){const m=Math.floor(v/20),C=r(l,5)+e(m,h,g,f)+S+a[m]+d[v]>>>0;S=f,f=g,g=r(h,30)>>>0,h=l,l=C}i[0]=i[0]+l>>>0,i[1]=i[1]+h>>>0,i[2]=i[2]+g>>>0,i[3]=i[3]+f>>>0,i[4]=i[4]+S>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,i[0]&255,i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,i[1]&255,i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,i[2]&255,i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,i[3]&255,i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,i[4]&255]}var u=n;return He.default=u,He}var Js;function al(){if(Js)return Ve;Js=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.default=void 0;var e=n(Kp()),r=n(ol());function n(a){return a&&a.__esModule?a:{default:a}}var s=(0,e.default)("v5",80,r.default);return Ve.default=s,Ve}var $e={},Gs;function cl(){if(Gs)return $e;Gs=1,Object.defineProperty($e,"__esModule",{value:!0}),$e.default=void 0;var e="00000000-0000-0000-0000-000000000000";return $e.default=e,$e}var Ke={},Qs;function ul(){if(Qs)return Ke;Qs=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.default=void 0;var e=r(Jn());function r(s){return s&&s.__esModule?s:{default:s}}function n(s){if(!(0,e.default)(s))throw TypeError("Invalid UUID");return parseInt(s.slice(14,15),16)}var u=n;return Ke.default=u,Ke}var Xs;function pl(){return Xs||(Xs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return i.default}});var r=p(tl()),n=p(nl()),u=p(sl()),s=p(al()),a=p(cl()),i=p(ul()),t=p(Jn()),o=p(Gn()),c=p($p());function p(d){return d&&d.__esModule?d:{default:d}}}(Yn)),Yn}var Zs;function be(){if(Zs)return oe;Zs=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.createNoDashGuid=oe.createGuid=void 0;const e=pl(),r=()=>(0,e.v4)();oe.createGuid=r;const n=()=>r().replace(new RegExp("-","g"),"").toUpperCase();return oe.createNoDashGuid=n,oe}var Ys;function Un(){return Ys||(Ys=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PlatformEvent=e.EventType=void 0;const r=be();(function(u){u[u.Debug=0]="Debug",u[u.Info=1]="Info",u[u.Warning=2]="Warning",u[u.Error=3]="Error",u[u.None=4]="None"})(e.EventType||(e.EventType={}));class n{constructor(s,a){this.privName=s,this.privEventId=(0,r.createNoDashGuid)(),this.privEventTime=new Date().toISOString(),this.privEventType=a,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}e.PlatformEvent=n}(Zn)),Zn}var eo;function dl(){if(eo)return D;eo=1,Object.defineProperty(D,"__esModule",{value:!0}),D.AudioStreamNodeErrorEvent=D.AudioStreamNodeDetachedEvent=D.AudioStreamNodeAttachedEvent=D.AudioStreamNodeAttachingEvent=D.AudioStreamNodeEvent=D.AudioSourceErrorEvent=D.AudioSourceOffEvent=D.AudioSourceReadyEvent=D.AudioSourceInitializingEvent=D.AudioSourceEvent=void 0;const e=Un();class r extends e.PlatformEvent{constructor(l,h,g=e.EventType.Info){super(l,g),this.privAudioSourceId=h}get audioSourceId(){return this.privAudioSourceId}}D.AudioSourceEvent=r;class n extends r{constructor(l){super("AudioSourceInitializingEvent",l)}}D.AudioSourceInitializingEvent=n;class u extends r{constructor(l){super("AudioSourceReadyEvent",l)}}D.AudioSourceReadyEvent=u;class s extends r{constructor(l){super("AudioSourceOffEvent",l)}}D.AudioSourceOffEvent=s;class a extends r{constructor(l,h){super("AudioSourceErrorEvent",l,e.EventType.Error),this.privError=h}get error(){return this.privError}}D.AudioSourceErrorEvent=a;class i extends r{constructor(l,h,g){super(l,h),this.privAudioNodeId=g}get audioNodeId(){return this.privAudioNodeId}}D.AudioStreamNodeEvent=i;class t extends i{constructor(l,h){super("AudioStreamNodeAttachingEvent",l,h)}}D.AudioStreamNodeAttachingEvent=t;class o extends i{constructor(l,h){super("AudioStreamNodeAttachedEvent",l,h)}}D.AudioStreamNodeAttachedEvent=o;class c extends i{constructor(l,h){super("AudioStreamNodeDetachedEvent",l,h)}}D.AudioStreamNodeDetachedEvent=c;class p extends i{constructor(l,h,g){super("AudioStreamNodeErrorEvent",l,h),this.privError=g}get error(){return this.privError}}return D.AudioStreamNodeErrorEvent=p,D}var k={},to;function hl(){if(to)return k;to=1,Object.defineProperty(k,"__esModule",{value:!0}),k.ConnectionRedirectEvent=k.ConnectionMessageSentEvent=k.ConnectionMessageReceivedEvent=k.ConnectionEstablishErrorEvent=k.ConnectionErrorEvent=k.ConnectionClosedEvent=k.ConnectionEstablishedEvent=k.ConnectionStartEvent=k.ConnectionEvent=k.ServiceEvent=void 0;const e=Un();class r extends e.PlatformEvent{constructor(l,h,g=e.EventType.Info){super(l,g),this.privJsonResult=h}get jsonString(){return this.privJsonResult}}k.ServiceEvent=r;class n extends e.PlatformEvent{constructor(l,h,g=e.EventType.Info){super(l,g),this.privConnectionId=h}get connectionId(){return this.privConnectionId}}k.ConnectionEvent=n;class u extends n{constructor(l,h,g){super("ConnectionStartEvent",l),this.privUri=h,this.privHeaders=g}get uri(){return this.privUri}get headers(){return this.privHeaders}}k.ConnectionStartEvent=u;class s extends n{constructor(l){super("ConnectionEstablishedEvent",l)}}k.ConnectionEstablishedEvent=s;class a extends n{constructor(l,h,g){super("ConnectionClosedEvent",l,e.EventType.Debug),this.privReason=g,this.privStatusCode=h}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}k.ConnectionClosedEvent=a;class i extends n{constructor(l,h,g){super("ConnectionErrorEvent",l,e.EventType.Debug),this.privMessage=h,this.privType=g}get message(){return this.privMessage}get type(){return this.privType}}k.ConnectionErrorEvent=i;class t extends n{constructor(l,h,g){super("ConnectionEstablishErrorEvent",l,e.EventType.Error),this.privStatusCode=h,this.privReason=g}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}k.ConnectionEstablishErrorEvent=t;class o extends n{constructor(l,h,g){super("ConnectionMessageReceivedEvent",l),this.privNetworkReceivedTime=h,this.privMessage=g}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}k.ConnectionMessageReceivedEvent=o;class c extends n{constructor(l,h,g){super("ConnectionMessageSentEvent",l),this.privNetworkSentTime=h,this.privMessage=g}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}k.ConnectionMessageSentEvent=c;class p extends n{constructor(l,h,g,f){super("ConnectionRedirectEvent",l,e.EventType.Info),this.privRedirectUrl=h,this.privOriginalUrl=g,this.privContext=f}get redirectUrl(){return this.privRedirectUrl}get originalUrl(){return this.privOriginalUrl}get context(){return this.privContext}}return k.ConnectionRedirectEvent=p,k}var ei={},G={},ro;function J(){if(ro)return G;ro=1,Object.defineProperty(G,"__esModule",{value:!0}),G.ObjectDisposedError=G.InvalidOperationError=G.ArgumentNullError=void 0;class e extends Error{constructor(s){super(s),this.name="ArgumentNull",this.message=s}}G.ArgumentNullError=e;class r extends Error{constructor(s){super(s),this.name="InvalidOperation",this.message=s}}G.InvalidOperationError=r;class n extends Error{constructor(s,a){super(a),this.name=s+"ObjectDisposed",this.message=a}}return G.ObjectDisposedError=n,G}var no;function Jp(){return no||(no=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionMessage=e.MessageType=void 0;const r=J(),n=be();var u;(function(a){a[a.Text=0]="Text",a[a.Binary=1]="Binary"})(u=e.MessageType||(e.MessageType={}));class s{constructor(i,t,o,c){if(this.privBody=null,i===u.Text&&t&&typeof t!="string")throw new r.InvalidOperationError("Payload must be a string");if(i===u.Binary&&t&&!(t instanceof ArrayBuffer))throw new r.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=i,this.privBody=t,this.privHeaders=o||{},this.privId=c||(0,n.createNoDashGuid)(),this.messageType){case u.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case u.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===u.Binary)throw new r.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===u.Text)throw new r.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}e.ConnectionMessage=s}(ei)),ei}var Je={},io;function ll(){if(io)return Je;io=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.ConnectionOpenResponse=void 0;let e=class{constructor(n,u){this.privStatusCode=n,this.privReason=u}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}};return Je.ConnectionOpenResponse=e,Je}var Ge={},so;function vl(){if(so)return Ge;so=1,Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.DeferralMap=void 0;let e=class{constructor(){this.privMap={}}add(n,u){this.privMap[n]=u}getId(n){return this.privMap[n]}complete(n,u){try{this.privMap[n].resolve(u)}catch(s){this.privMap[n].reject(s)}finally{this.privMap[n]=void 0}}};return Ge.DeferralMap=e,Ge}var ae={},oo;function Gp(){if(oo)return ae;oo=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.SendingAgentContextMessageEvent=ae.DialogEvent=void 0;const e=Un();class r extends e.PlatformEvent{constructor(s,a=e.EventType.Info){super(s,a)}}ae.DialogEvent=r;class n extends r{constructor(s){super("SendingAgentContextMessageEvent"),this.privAgentConfig=s}get agentConfig(){return this.privAgentConfig}}return ae.SendingAgentContextMessageEvent=n,ae}var Qe={},Xe={},ao;function Qp(){if(ao)return Xe;ao=1,Object.defineProperty(Xe,"__esModule",{value:!0}),Xe.EventSource=void 0;const e=J(),r=be();let n=class{constructor(s){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=s}onEvent(s){if(this.isDisposed())throw new e.ObjectDisposedError("EventSource");if(this.metadata)for(const a in this.metadata)a&&s.metadata&&(s.metadata[a]||(s.metadata[a]=this.metadata[a]));for(const a in this.privEventListeners)a&&this.privEventListeners[a]&&this.privEventListeners[a](s)}attach(s){const a=(0,r.createNoDashGuid)();return this.privEventListeners[a]=s,{detach:()=>(delete this.privEventListeners[a],Promise.resolve())}}attachListener(s){return this.attach(a=>s.onEvent(a))}attachConsoleListener(s){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(a=>s.onEvent(a)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}};return Xe.EventSource=n,Xe}var co;function fl(){if(co)return Qe;co=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.Events=void 0;const e=J(),r=Qp();let n=class fs{static setEventSource(s){if(!s)throw new e.ArgumentNullError("eventSource");fs.privInstance=s}static get instance(){return fs.privInstance}};return Qe.Events=n,n.privInstance=new r.EventSource,Qe}var ti={},uo;function gl(){return uo||(uo=1,Object.defineProperty(ti,"__esModule",{value:!0})),ti}var ri={},po;function Sl(){return po||(po=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionState=void 0,function(r){r[r.None=0]="None",r[r.Connected=1]="Connected",r[r.Connecting=2]="Connecting",r[r.Disconnected=3]="Disconnected"}(e.ConnectionState||(e.ConnectionState={}))}(ri)),ri}var ni={},ho;function ml(){return ho||(ho=1,Object.defineProperty(ni,"__esModule",{value:!0})),ni}var ii={},lo;function Cl(){return lo||(lo=1,Object.defineProperty(ii,"__esModule",{value:!0})),ii}var si={},vo;function yl(){return vo||(vo=1,Object.defineProperty(si,"__esModule",{value:!0})),si}var oi={},fo;function Rl(){return fo||(fo=1,Object.defineProperty(oi,"__esModule",{value:!0})),oi}var ai={},go;function Pl(){return go||(go=1,Object.defineProperty(ai,"__esModule",{value:!0})),ai}var ci={},So;function El(){return So||(So=1,Object.defineProperty(ci,"__esModule",{value:!0})),ci}var ui={},mo;function Il(){return mo||(mo=1,Object.defineProperty(ui,"__esModule",{value:!0})),ui}var pi={},Co;function Tl(){return Co||(Co=1,Object.defineProperty(pi,"__esModule",{value:!0})),pi}var Ze={},yo;function Xp(){if(yo)return Ze;yo=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.List=void 0;const e=J();let r=class Ae{constructor(u){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],u)for(const s of u)this.privList.push(s)}get(u){return this.throwIfDisposed(),this.privList[u]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(u){this.throwIfDisposed(),this.insertAt(this.privList.length,u)}insertAt(u,s){this.throwIfDisposed(),u===0?this.privList.unshift(s):u===this.privList.length?this.privList.push(s):this.privList.splice(u,0,s),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(u){return this.throwIfDisposed(),this.remove(u,1)[0]}remove(u,s){this.throwIfDisposed();const a=this.privList.splice(u,s);return this.triggerSubscriptions(this.privRemoveSubscriptions),a}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(u){this.throwIfDisposed();const s=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[s]=u,{detach:()=>(delete this.privAddSubscriptions[s],Promise.resolve())}}onRemoved(u){this.throwIfDisposed();const s=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[s]=u,{detach:()=>(delete this.privRemoveSubscriptions[s],Promise.resolve())}}onDisposed(u){this.throwIfDisposed();const s=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[s]=u,{detach:()=>(delete this.privDisposedSubscriptions[s],Promise.resolve())}}join(u){return this.throwIfDisposed(),this.privList.join(u)}toArray(){const u=Array();return this.privList.forEach(s=>{u.push(s)}),u}any(u){return this.throwIfDisposed(),u?this.where(u).length()>0:this.length()>0}all(u){return this.throwIfDisposed(),this.where(u).length()===this.length()}forEach(u){this.throwIfDisposed();for(let s=0;s<this.length();s++)u(this.privList[s],s)}select(u){this.throwIfDisposed();const s=[];for(let a=0;a<this.privList.length;a++)s.push(u(this.privList[a],a));return new Ae(s)}where(u){this.throwIfDisposed();const s=new Ae;for(let a=0;a<this.privList.length;a++)u(this.privList[a],a)&&s.add(this.privList[a]);return s}orderBy(u){this.throwIfDisposed();const a=this.toArray().sort(u);return new Ae(a)}orderByDesc(u){return this.throwIfDisposed(),this.orderBy((s,a)=>u(a,s))}clone(){return this.throwIfDisposed(),new Ae(this.toArray())}concat(u){return this.throwIfDisposed(),new Ae(this.privList.concat(u.toArray()))}concatArray(u){return this.throwIfDisposed(),new Ae(this.privList.concat(u))}isDisposed(){return this.privList==null}dispose(u){this.isDisposed()||(this.privDisposeReason=u,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new e.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(u){if(u)for(const s in u)s&&u[s]()}};return Ze.List=r,Ze}var di={},Ro;function Zp(){return Ro||(Ro=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.marshalPromiseToCallbacks=e.Sink=e.Deferred=e.PromiseResultEventSource=e.PromiseResult=e.PromiseState=void 0;var r;(function(t){t[t.None=0]="None",t[t.Resolved=1]="Resolved",t[t.Rejected=2]="Rejected"})(r=e.PromiseState||(e.PromiseState={}));class n{constructor(o){this.throwIfError=()=>{if(this.isError)throw this.error},o.on(c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=c)},c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=c)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}e.PromiseResult=n;class u{constructor(){this.setResult=o=>{this.privOnSetResult(o)},this.setError=o=>{this.privOnSetError(o)},this.on=(o,c)=>{this.privOnSetResult=o,this.privOnSetError=c}}}e.PromiseResultEventSource=u;class s{constructor(){this.resolve=o=>(this.privResolve(o),this),this.reject=o=>(this.privReject(o),this),this.privPromise=new Promise((o,c)=>{this.privResolve=o,this.privReject=c})}get promise(){return this.privPromise}}e.Deferred=s;class a{constructor(){this.privState=r.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new u,this.privPromiseResult=new n(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(o){if(this.privState!==r.None)throw new Error("'Cannot resolve a completed promise'");this.privState=r.Resolved,this.privPromiseResultEvents.setResult(o);for(let c=0;c<this.privSuccessHandlers.length;c++)this.executeSuccessCallback(o,this.privSuccessHandlers[c],this.privErrorHandlers[c]);this.detachHandlers()}reject(o){if(this.privState!==r.None)throw new Error("'Cannot reject a completed promise'");this.privState=r.Rejected,this.privPromiseResultEvents.setError(o);for(const c of this.privErrorHandlers)this.executeErrorCallback(o,c);this.detachHandlers()}on(o,c){o==null&&(o=()=>{}),this.privState===r.None?(this.privSuccessHandlers.push(o),this.privErrorHandlers.push(c)):(this.privState===r.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,o,c):this.privState===r.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,c),this.detachHandlers())}executeSuccessCallback(o,c,p){try{c(o)}catch(d){this.executeErrorCallback(`'Unhandled callback error: ${d}'`,p)}}executeErrorCallback(o,c){if(c)try{c(o)}catch(p){throw new Error(`'Unhandled callback error: ${p}. InnerError: ${o}'`)}else throw new Error(`'Unhandled error: ${o}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}e.Sink=a;function i(t,o,c){t.then(p=>{try{o&&o(p)}catch(d){if(c)try{if(d instanceof Error){const l=d;c(l.name+": "+l.message)}else c(d)}catch{}}},p=>{if(c)try{if(p instanceof Error){const d=p;c(d.name+": "+d.message)}else c(p)}catch{}})}e.marshalPromiseToCallbacks=i}(di)),di}var Ye={},Po;function Yp(){if(Po)return Ye;Po=1,Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.Queue=void 0;const e=J(),r=Xp(),n=Zp();var u;(function(a){a[a.Dequeue=0]="Dequeue",a[a.Peek=1]="Peek"})(u||(u={}));let s=class{constructor(i){this.privPromiseStore=new r.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=i||new r.List,this.privDetachables=[],this.privSubscribers=new r.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(i){this.throwIfDispose(),this.enqueueFromPromise(new Promise(t=>t(i)))}enqueueFromPromise(i){this.throwIfDispose(),i.then(t=>{this.privList.add(t)},()=>{})}dequeue(){this.throwIfDispose();const i=new n.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:i,type:u.Dequeue}),this.drain()),i.promise}peek(){this.throwIfDispose();const i=new n.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:i,type:u.Peek}),this.drain()),i.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(i,t){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;const o=this.privSubscribers;if(o){for(;o.length()>0;)o.removeFirst().deferral.resolve(void 0);this.privSubscribers===o&&(this.privSubscribers=o)}for(const c of this.privDetachables)await c.detach();if(this.privPromiseStore.length()>0&&i){const c=[];return this.privPromiseStore.toArray().forEach(p=>{c.push(p)}),Promise.all(c).finally(()=>{this.privSubscribers=null,this.privList.forEach(p=>{i(p)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(i){await this.drainAndDispose(null,i)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const i=this.privSubscribers,t=this.privList;if(i&&t){for(;t.length()>0&&i.length()>0&&!this.privIsDisposing;){const o=i.removeFirst();if(o.type===u.Peek)o.deferral.resolve(t.first());else{const c=t.removeFirst();o.deferral.resolve(c)}}this.privSubscribers===i&&(this.privSubscribers=i),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new e.InvalidOperationError(this.privDisposeReason):new e.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new e.InvalidOperationError("Queue disposing")}};return Ye.Queue=s,Ye}var et={},Eo;function Al(){if(Eo)return et;Eo=1,Object.defineProperty(et,"__esModule",{value:!0}),et.RawWebsocketMessage=void 0;const e=Jp(),r=J(),n=be();let u=class{constructor(a,i,t){if(this.privPayload=null,!i)throw new r.ArgumentNullError("payload");if(a===e.MessageType.Binary&&Object.getPrototypeOf(i).constructor.name!=="ArrayBuffer")throw new r.InvalidOperationError("Payload must be ArrayBuffer");if(a===e.MessageType.Text&&typeof i!="string")throw new r.InvalidOperationError("Payload must be a string");this.privMessageType=a,this.privPayload=i,this.privId=t||(0,n.createNoDashGuid)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===e.MessageType.Binary)throw new r.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===e.MessageType.Text)throw new r.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}};return et.RawWebsocketMessage=u,et}var tt={},Io;function wl(){if(Io)return tt;Io=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.RiffPcmEncoder=void 0;let e=class{constructor(n,u){this.privActualSampleRate=n,this.privDesiredSampleRate=u}encode(n){const u=this.downSampleAudioFrame(n,this.privActualSampleRate,this.privDesiredSampleRate);if(!u)return null;const s=u.length*2,a=new ArrayBuffer(s),i=new DataView(a);return this.floatTo16BitPCM(i,0,u),a}setString(n,u,s){for(let a=0;a<s.length;a++)n.setUint8(u+a,s.charCodeAt(a))}floatTo16BitPCM(n,u,s){for(let a=0;a<s.length;a++,u+=2){const i=Math.max(-1,Math.min(1,s[a]));n.setInt16(u,i<0?i*32768:i*32767,!0)}}downSampleAudioFrame(n,u,s){if(!n)return null;if(s===u||s>u)return n;const a=u/s,i=Math.round(n.length/a),t=new Float32Array(i);let o=0,c=0;for(;c<i;){const p=Math.round((c+1)*a);let d=0,l=0;for(;o<p&&o<n.length;)d+=n[o++],l++;t[c++]=d/l}return t}};return tt.RiffPcmEncoder=e,tt}var rt={},To;function _l(){if(To)return rt;To=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.Stream=void 0;const e=J(),r=be(),n=Yp();let u=class{constructor(a){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=a||(0,r.createNoDashGuid)(),this.privReaderQueue=new n.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(a){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(a)}catch{}}read(){if(this.privIsReadEnded)throw new e.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async a=>((a===void 0||a.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),a))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new n.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new e.InvalidOperationError("Stream closed")}};return rt.Stream=u,rt}var hi={},Ao;function Is(){return Ao||(Ao=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,function(r){r[r.Success=0]="Success",r[r.Error=1]="Error"}(e.TranslationStatus||(e.TranslationStatus={}))}(hi)),hi}var nt={},wo;function bl(){if(wo)return nt;wo=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.ChunkedArrayBufferStream=void 0;const e=A();let r=class extends e.Stream{constructor(u,s){super(s),this.privTargetChunkSize=Math.round(u),this.privNextBufferReadyBytes=0}writeStreamChunk(u){if(u.isEnd||this.privNextBufferReadyBytes===0&&u.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(u);return}let s=0;for(;s<u.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=u.timeReceived);const a=Math.min(u.buffer.byteLength-s,this.privTargetChunkSize-this.privNextBufferReadyBytes),i=new Uint8Array(this.privNextBufferToWrite),t=new Uint8Array(u.buffer.slice(s,a+s));i.set(t,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=a,s+=a,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return nt.ChunkedArrayBufferStream=r,nt}var li={},_o;function Ml(){return _o||(_o=1,Object.defineProperty(li,"__esModule",{value:!0})),li}var it={},bo;function Ol(){if(bo)return it;bo=1,Object.defineProperty(it,"__esModule",{value:!0}),it.Timeout=void 0;let e=class ee{static load(){const n=new Map([[0,()=>{}]]),u=new Map,a="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),i=new Worker(a);return i.addEventListener("message",({data:c})=>{if(ee.isCallNotification(c)){const{params:{timerId:p}}=c,d=n.get(p);if(typeof d=="number"){const l=u.get(d);if(l===void 0||l!==p)throw new Error("The timer is in an undefined state.")}else if(typeof d<"u")d(),n.delete(p);else throw new Error("The timer is in an undefined state.")}else if(ee.isClearResponse(c)){const{id:p}=c,d=u.get(p);if(d===void 0)throw new Error("The timer is in an undefined state.");u.delete(p),n.delete(d)}else{const{error:{message:p}}=c;throw new Error(p)}}),{clearTimeout:c=>{const p=Math.random();u.set(p,c),n.set(c,p),i.postMessage({id:p,method:"clear",params:{timerId:c}})},setTimeout:(c,p)=>{const d=Math.random();return n.set(d,c),i.postMessage({id:null,method:"set",params:{delay:p,now:performance.now(),timerId:d}}),d}}}static loadWorkerTimers(){return()=>(ee.workerTimers!==null||(ee.workerTimers=ee.load()),ee.workerTimers)}static isCallNotification(n){return n.method!==void 0&&n.method==="call"}static isClearResponse(n){return n.error===null&&typeof n.id=="number"}};return it.Timeout=e,e.workerTimers=null,e.clearTimeout=r=>e.timers().clearTimeout(r),e.setTimeout=(r,n)=>e.timers().setTimeout(r,n),e.timers=e.loadWorkerTimers(),it}var b={},Mo;function Dl(){if(Mo)return b;Mo=1,Object.defineProperty(b,"__esModule",{value:!0}),b.OCSPCacheUpdateErrorEvent=b.OCSPResponseRetrievedEvent=b.OCSPCacheFetchErrorEvent=b.OCSPVerificationFailedEvent=b.OCSPCacheHitEvent=b.OCSPCacheEntryNeedsRefreshEvent=b.OCSPCacheEntryExpiredEvent=b.OCSPWSUpgradeStartedEvent=b.OCSPStapleReceivedEvent=b.OCSPCacheUpdateCompleteEvent=b.OCSPDiskCacheStoreEvent=b.OCSPMemoryCacheStoreEvent=b.OCSPCacheUpdateNeededEvent=b.OCSPDiskCacheHitEvent=b.OCSPCacheMissEvent=b.OCSPMemoryCacheHitEvent=b.OCSPEvent=void 0;const e=Un();class r extends e.PlatformEvent{constructor(C,y,R){super(C,y),this.privSignature=R}}b.OCSPEvent=r;class n extends r{constructor(C){super("OCSPMemoryCacheHitEvent",e.EventType.Debug,C)}}b.OCSPMemoryCacheHitEvent=n;class u extends r{constructor(C){super("OCSPCacheMissEvent",e.EventType.Debug,C)}}b.OCSPCacheMissEvent=u;class s extends r{constructor(C){super("OCSPDiskCacheHitEvent",e.EventType.Debug,C)}}b.OCSPDiskCacheHitEvent=s;class a extends r{constructor(C){super("OCSPCacheUpdateNeededEvent",e.EventType.Debug,C)}}b.OCSPCacheUpdateNeededEvent=a;class i extends r{constructor(C){super("OCSPMemoryCacheStoreEvent",e.EventType.Debug,C)}}b.OCSPMemoryCacheStoreEvent=i;class t extends r{constructor(C){super("OCSPDiskCacheStoreEvent",e.EventType.Debug,C)}}b.OCSPDiskCacheStoreEvent=t;class o extends r{constructor(C){super("OCSPCacheUpdateCompleteEvent",e.EventType.Debug,C)}}b.OCSPCacheUpdateCompleteEvent=o;class c extends r{constructor(){super("OCSPStapleReceivedEvent",e.EventType.Debug,"")}}b.OCSPStapleReceivedEvent=c;class p extends r{constructor(C){super("OCSPWSUpgradeStartedEvent",e.EventType.Debug,C)}}b.OCSPWSUpgradeStartedEvent=p;class d extends r{constructor(C,y){super("OCSPCacheEntryExpiredEvent",e.EventType.Debug,C),this.privExpireTime=y}}b.OCSPCacheEntryExpiredEvent=d;class l extends r{constructor(C,y,R){super("OCSPCacheEntryNeedsRefreshEvent",e.EventType.Debug,C),this.privExpireTime=R,this.privStartTime=y}}b.OCSPCacheEntryNeedsRefreshEvent=l;class h extends r{constructor(C,y,R){super("OCSPCacheHitEvent",e.EventType.Debug,C),this.privExpireTime=R,this.privExpireTimeString=new Date(R).toLocaleDateString(),this.privStartTime=y,this.privStartTimeString=new Date(y).toLocaleTimeString()}}b.OCSPCacheHitEvent=h;class g extends r{constructor(C,y){super("OCSPVerificationFailedEvent",e.EventType.Debug,C),this.privError=y}}b.OCSPVerificationFailedEvent=g;class f extends r{constructor(C,y){super("OCSPCacheFetchErrorEvent",e.EventType.Debug,C),this.privError=y}}b.OCSPCacheFetchErrorEvent=f;class S extends r{constructor(C){super("OCSPResponseRetrievedEvent",e.EventType.Debug,C)}}b.OCSPResponseRetrievedEvent=S;class v extends r{constructor(C,y){super("OCSPCacheUpdateErrorEvent",e.EventType.Debug,C),this.privError=y}}return b.OCSPCacheUpdateErrorEvent=v,b}var st={},Oo;function kl(){if(Oo)return st;Oo=1,Object.defineProperty(st,"__esModule",{value:!0}),st.BackgroundEvent=void 0;const e=A();class r extends e.PlatformEvent{constructor(u){super("BackgroundEvent",e.EventType.Error),this.privError=u}get error(){return this.privError}}return st.BackgroundEvent=r,st}var Do;function A(){return Do||(Do=1,function(e){var r=se&&se.__createBinding||(Object.create?function(s,a,i,t){t===void 0&&(t=i),Object.defineProperty(s,t,{enumerable:!0,get:function(){return a[i]}})}:function(s,a,i,t){t===void 0&&(t=i),s[t]=a[i]}),n=se&&se.__exportStar||function(s,a){for(var i in s)i!=="default"&&!Object.prototype.hasOwnProperty.call(a,i)&&r(a,s,i)};Object.defineProperty(e,"__esModule",{value:!0}),e.TranslationStatus=void 0,n(dl(),e),n(hl(),e),n(Jp(),e),n(ll(),e),n(vl(),e),n(Gp(),e),n(J(),e),n(fl(),e),n(Qp(),e),n(be(),e),n(gl(),e),n(Sl(),e),n(ml(),e),n(Cl(),e),n(yl(),e),n(Rl(),e),n(Pl(),e),n(El(),e),n(Il(),e),n(Tl(),e),n(Xp(),e),n(Un(),e),n(Zp(),e),n(Yp(),e),n(Al(),e),n(wl(),e),n(_l(),e);var u=Is();Object.defineProperty(e,"TranslationStatus",{enumerable:!0,get:function(){return u.TranslationStatus}}),n(bl(),e),n(Ml(),e),n(Ol(),e),n(Dl(),e),n(kl(),e)}(se)),se}var ot={},ko;function q(){if(ko)return ot;ko=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.HeaderNames=void 0;let e=class{};return ot.HeaderNames=e,e.AuthKey="Ocp-Apim-Subscription-Key",e.Authorization="Authorization",e.SpIDAuthKey="Apim-Subscription-Id",e.ConnectionId="X-ConnectionId",e.ContentType="Content-Type",e.CustomCommandsAppId="X-CommandsAppId",e.Path="Path",e.RequestId="X-RequestId",e.RequestStreamId="X-StreamId",e.RequestTimestamp="X-Timestamp",ot}var at={},zo;function Ts(){if(zo)return at;zo=1,Object.defineProperty(at,"__esModule",{value:!0}),at.AuthInfo=void 0;class e{constructor(n,u){this.privHeaderName=n,this.privToken=u}get headerName(){return this.privHeaderName}get token(){return this.privToken}}return at.AuthInfo=e,at}var No;function zl(){if(No)return Ne;No=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.CognitiveSubscriptionKeyAuthentication=void 0;const e=A(),r=q(),n=Ts();let u=class{constructor(a){if(!a)throw new e.ArgumentNullError("subscriptionKey");this.privAuthInfo=new n.AuthInfo(r.HeaderNames.AuthKey,a)}fetch(a){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(a){return Promise.resolve(this.privAuthInfo)}};return Ne.CognitiveSubscriptionKeyAuthentication=u,Ne}var ct={},jo;function Nl(){if(jo)return ct;jo=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.CognitiveTokenAuthentication=void 0;const e=A(),r=Ts(),n=q();let u=class gs{constructor(a,i){if(!a)throw new e.ArgumentNullError("fetchCallback");if(!i)throw new e.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=a,this.privFetchOnExpiryCallback=i}fetch(a){return this.privFetchCallback(a).then(i=>new r.AuthInfo(n.HeaderNames.Authorization,i===void 0?void 0:gs.privTokenPrefix+i))}fetchOnExpiry(a){return this.privFetchOnExpiryCallback(a).then(i=>new r.AuthInfo(n.HeaderNames.Authorization,i===void 0?void 0:gs.privTokenPrefix+i))}};return ct.CognitiveTokenAuthentication=u,u.privTokenPrefix="Bearer ",ct}var vi={},qo;function jl(){return qo||(qo=1,Object.defineProperty(vi,"__esModule",{value:!0})),vi}var fi={},Lo;function ql(){return Lo||(Lo=1,Object.defineProperty(fi,"__esModule",{value:!0})),fi}var ut={},ce={},V={};const Ll={},Bl=Object.freeze(Object.defineProperty({__proto__:null,default:Ll},Symbol.toStringTag,{value:"Module"})),_e=Yh(Bl);var gi={},Bo;function ed(){return Bo||(Bo=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LogLevel=void 0;const r=A();Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return r.EventType}})}(gi)),gi}var pt={},Fo;function _(){if(Fo)return pt;Fo=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.Contracts=void 0;let e=class we{static throwIfNullOrUndefined(n,u){if(n==null)throw new Error("throwIfNullOrUndefined:"+u)}static throwIfNull(n,u){if(n===null)throw new Error("throwIfNull:"+u)}static throwIfNullOrWhitespace(n,u){if(we.throwIfNullOrUndefined(n,u),(""+n).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+u)}static throwIfNullOrTooLong(n,u,s){if(we.throwIfNullOrUndefined(n,u),(""+n).length>s)throw new Error("throwIfNullOrTooLong:"+u+" (more than "+s.toString()+" characters)")}static throwIfNullOrTooShort(n,u,s){if(we.throwIfNullOrUndefined(n,u),(""+n).length<s)throw new Error("throwIfNullOrTooShort:"+u+" (less than "+s.toString()+" characters)")}static throwIfDisposed(n){if(n)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(n,u){if(we.throwIfNullOrUndefined(n,u),n.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+u);for(const s of n)we.throwIfNullOrWhitespace(s,u)}static throwIfFileDoesNotExist(n,u){we.throwIfNullOrWhitespace(n,u)}static throwIfNotUndefined(n,u){if(n!==void 0)throw new Error("throwIfNotUndefined:"+u)}};return pt.Contracts=e,pt}var xo;function Fl(){if(xo)return V;xo=1;var e=V&&V.__createBinding||(Object.create?function(t,o,c,p){p===void 0&&(p=c),Object.defineProperty(t,p,{enumerable:!0,get:function(){return o[c]}})}:function(t,o,c,p){p===void 0&&(p=c),t[p]=o[c]}),r=V&&V.__setModuleDefault||(Object.create?function(t,o){Object.defineProperty(t,"default",{enumerable:!0,value:o})}:function(t,o){t.default=o}),n=V&&V.__importStar||function(t){if(t&&t.__esModule)return t;var o={};if(t!=null)for(var c in t)c!=="default"&&Object.prototype.hasOwnProperty.call(t,c)&&e(o,t,c);return r(o,t),o};Object.defineProperty(V,"__esModule",{value:!0}),V.ConsoleLoggingListener=void 0;const u=n(_e),s=ed(),a=_();let i=class{constructor(o=s.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=o}set logPath(o){a.Contracts.throwIfNullOrUndefined(u.openSync,`
File System access not available`),this.privLogPath=o}set enableConsoleOutput(o){this.privEnableConsoleOutput=o}onEvent(o){if(o.eventType>=this.privLogLevelFilter){const c=this.toString(o);if(this.logCallback&&this.logCallback(c),this.privLogPath&&u.writeFileSync(this.privLogPath,c+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(o.eventType){case s.LogLevel.Debug:console.debug(c);break;case s.LogLevel.Info:console.info(c);break;case s.LogLevel.Warning:console.warn(c);break;case s.LogLevel.Error:console.error(c);break;default:console.log(c);break}}}toString(o){const c=[`${o.eventTime}`,`${o.name}`],p=o;for(const d in p)if(d&&o.hasOwnProperty(d)&&d!=="eventTime"&&d!=="eventType"&&d!=="eventId"&&d!=="name"&&d!=="constructor"){const l=p[d];let h="<NULL>";l!=null&&(typeof l=="number"||typeof l=="string"?h=l.toString():h=JSON.stringify(l)),c.push(`${d}: ${h}`)}return c.join(" | ")}};return V.ConsoleLoggingListener=i,V}var Si={},Uo;function xl(){return Uo||(Uo=1,Object.defineProperty(Si,"__esModule",{value:!0})),Si}var mi={},Ci={},Wo;function Me(){return Wo||(Wo=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AudioStreamFormatImpl=e.AudioStreamFormat=e.AudioFormatTag=void 0;var r;(function(s){s[s.PCM=1]="PCM",s[s.MuLaw=2]="MuLaw",s[s.Siren=3]="Siren",s[s.MP3=4]="MP3",s[s.SILKSkype=5]="SILKSkype",s[s.OGG_OPUS=6]="OGG_OPUS",s[s.WEBM_OPUS=7]="WEBM_OPUS",s[s.ALaw=8]="ALaw",s[s.FLAC=9]="FLAC",s[s.OPUS=10]="OPUS",s[s.AMR_WB=11]="AMR_WB",s[s.G722=12]="G722"})(r=e.AudioFormatTag||(e.AudioFormatTag={}));class n{static getDefaultInputFormat(){return u.getDefaultInputFormat()}static getWaveFormat(a,i,t,o){return new u(a,i,t,o)}static getWaveFormatPCM(a,i,t){return new u(a,i,t)}}e.AudioStreamFormat=n;class u extends n{constructor(a=16e3,i=16,t=1,o=r.PCM){super();let c=!0;switch(o){case r.PCM:this.formatTag=1;break;case r.ALaw:this.formatTag=6;break;case r.MuLaw:this.formatTag=7;break;default:c=!1}if(this.bitsPerSample=i,this.samplesPerSec=a,this.channels=t,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),c){this.privHeader=new ArrayBuffer(44);const p=new DataView(this.privHeader);this.setString(p,0,"RIFF"),p.setUint32(4,0,!0),this.setString(p,8,"WAVEfmt "),p.setUint32(16,16,!0),p.setUint16(20,this.formatTag,!0),p.setUint16(22,this.channels,!0),p.setUint32(24,this.samplesPerSec,!0),p.setUint32(28,this.avgBytesPerSec,!0),p.setUint16(32,this.channels*(this.bitsPerSample/8),!0),p.setUint16(34,this.bitsPerSample,!0),this.setString(p,36,"data"),p.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new u}static getAudioContext(a){const i=window.AudioContext||window.webkitAudioContext||!1;if(i)return a!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new i({sampleRate:a}):new i;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(a,i,t){for(let o=0;o<t.length;o++)a.setUint8(i+o,t.charCodeAt(o))}}e.AudioStreamFormatImpl=u}(Ci)),Ci}var Vo;function Ul(){return Vo||(Vo=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MicAudioSource=e.AudioWorkletSourceURLPropertyName=void 0;const r=T(),n=A(),u=Me();e.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class s{constructor(i,t,o,c){this.privRecorder=i,this.deviceId=t,this.privStreams={},this.privOutputChunkSize=s.AUDIOFORMAT.avgBytesPerSec/10,this.privId=o||(0,n.createNoDashGuid)(),this.privEvents=new n.EventSource,this.privMediaStream=c||null,this.privIsClosing=!1}get format(){return Promise.resolve(s.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new n.Deferred;try{this.createAudioContext()}catch(o){if(o instanceof Error){const c=o;this.privInitializeDeferral.reject(c.name+": "+c.message)}else this.privInitializeDeferral.reject(o);return this.privInitializeDeferral.promise}const i=window.navigator;let t=i.getUserMedia||i.webkitGetUserMedia||i.mozGetUserMedia||i.msGetUserMedia;if(i.mediaDevices&&(t=(o,c,p)=>{i.mediaDevices.getUserMedia(o).then(c).catch(p)}),t){const o=()=>{this.onEvent(new n.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new n.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):t({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},c=>{this.privMediaStream=c,this.onEvent(new n.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},c=>{const p=`Error occurred during microphone initialization: ${c}`;this.privInitializeDeferral.reject(p),this.onEvent(new n.AudioSourceErrorEvent(this.privId,p))})};this.privContext.state==="suspended"?this.privContext.resume().then(o).catch(c=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${c}`)}):o()}else{const o="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(o),this.onEvent(new n.AudioSourceErrorEvent(o,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(i){return this.onEvent(new n.AudioStreamNodeAttachingEvent(this.privId,i)),this.listen(i).then(t=>(this.onEvent(new n.AudioStreamNodeAttachedEvent(this.privId,i)),{detach:async()=>(t.readEnded(),delete this.privStreams[i],this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,i)),this.turnOff()),id:()=>i,read:()=>t.read()}))}detach(i){i&&this.privStreams[i]&&(this.privStreams[i].close(),delete this.privStreams[i],this.onEvent(new n.AudioStreamNodeDetachedEvent(this.privId,i)))}async turnOff(){for(const i in this.privStreams)if(i){const t=this.privStreams[i];t&&t.close()}this.onEvent(new n.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(i=>({bitspersample:s.AUDIOFORMAT.bitsPerSample,channelcount:s.AUDIOFORMAT.channels,connectivity:r.connectivity.Unknown,manufacturer:"Speech SDK",model:i,samplerate:s.AUDIOFORMAT.samplesPerSec,type:r.type.Microphones}))}setProperty(i,t){if(i===e.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(t);else throw new Error("Property '"+i+"' is not supported on Microphone.")}getMicrophoneLabel(){const i="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(i);this.privMicrophoneLabel=i;const t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(t===void 0)return Promise.resolve(this.privMicrophoneLabel);const o=new n.Deferred;return navigator.mediaDevices.enumerateDevices().then(c=>{for(const p of c)if(p.deviceId===t){this.privMicrophoneLabel=p.label;break}o.resolve(this.privMicrophoneLabel)},()=>o.resolve(this.privMicrophoneLabel)),o.promise}async listen(i){await this.turnOn();const t=new n.ChunkedArrayBufferStream(this.privOutputChunkSize,i);this.privStreams[i]=t;try{this.privRecorder.record(this.privContext,this.privMediaStream,t)}catch(c){throw this.onEvent(new n.AudioStreamNodeErrorEvent(this.privId,i,c)),c}return t}onEvent(i){this.privEvents.onEvent(i),n.Events.instance.onEvent(i)}createAudioContext(){this.privContext||(this.privContext=u.AudioStreamFormatImpl.getAudioContext(s.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let i=!1;"close"in this.privContext&&(i=!0),i?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}e.MicAudioSource=s,s.AUDIOFORMAT=u.AudioStreamFormat.getDefaultInputFormat()}(mi)),mi}var dt={},Ho;function Wl(){if(Ho)return dt;Ho=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.FileAudioSource=void 0;const e=T(),r=A(),n=Me();let u=class{constructor(a,i,t){this.privStreams={},this.privHeaderEnd=44,this.privId=t||(0,r.createNoDashGuid)(),this.privEvents=new r.EventSource,this.privSource=a,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=a.name:this.privFilename=i||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const a=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new r.AudioSourceErrorEvent(a,"")),Promise.reject(a)}this.onEvent(new r.AudioSourceInitializingEvent(this.privId)),this.onEvent(new r.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(a){this.onEvent(new r.AudioStreamNodeAttachingEvent(this.privId,a));const i=await this.upload(a);return this.onEvent(new r.AudioStreamNodeAttachedEvent(this.privId,a)),Promise.resolve({detach:async()=>{i.readEnded(),delete this.privStreams[a],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,a)),await this.turnOff()},id:()=>a,read:()=>i.read()})}detach(a){a&&this.privStreams[a]&&(this.privStreams[a].close(),delete this.privStreams[a],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,a)))}turnOff(){for(const a in this.privStreams)if(a){const i=this.privStreams[a];i&&!i.isClosed&&i.close()}return this.onEvent(new r.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(a=>Promise.resolve({bitspersample:a.bitsPerSample,channelcount:a.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:a.samplesPerSec,type:e.type.File}))}readHeader(){const i=this.privSource.slice(0,4296),t=new r.Deferred,o=c=>{const p=new DataView(c),d=v=>String.fromCharCode(p.getUint8(v),p.getUint8(v+1),p.getUint8(v+2),p.getUint8(v+3));if(d(0)!=="RIFF"){t.reject("Invalid WAV header in file, RIFF was not found");return}if(d(8)!=="WAVE"||d(12)!=="fmt "){t.reject("Invalid WAV header in file, WAVEfmt was not found");return}const l=p.getInt32(16,!0),h=p.getUint16(22,!0),g=p.getUint32(24,!0),f=p.getUint16(34,!0);let S=36+Math.max(l-16,0);for(;d(S)!=="data";S+=2)if(S>4288){t.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=S+8,t.resolve(n.AudioStreamFormat.getWaveFormatPCM(g,f,h))};if(typeof window<"u"&&typeof Blob<"u"&&i instanceof Blob){const c=new FileReader;c.onload=p=>{const d=p.target.result;o(d)},c.readAsArrayBuffer(i)}else{const c=i;o(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength))}return t.promise}async upload(a){const i=t=>{const o=`Error occurred while processing '${this.privFilename}'. ${t}`;throw this.onEvent(new r.AudioStreamNodeErrorEvent(this.privId,a,o)),new Error(o)};try{await this.turnOn();const t=await this.privAudioFormatPromise,o=new r.ChunkedArrayBufferStream(t.avgBytesPerSec/10,a);this.privStreams[a]=o;const c=this.privSource.slice(this.privHeaderEnd),p=d=>{o.isClosed||(o.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()}),o.close())};if(typeof window<"u"&&typeof Blob<"u"&&c instanceof Blob){const d=new FileReader;d.onerror=l=>i(l.toString()),d.onload=l=>{const h=l.target.result;p(h)},d.readAsArrayBuffer(c)}else{const d=c;p(d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength))}return o}catch(t){i(t)}}onEvent(a){this.privEvents.onEvent(a),r.Events.instance.onEvent(a)}};return dt.FileAudioSource=u,dt}var ht={},$o;function Vl(){if($o)return ht;$o=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.PcmRecorder=void 0;const e=A();class r{constructor(u){this.privStopInputOnRelease=u}record(u,s,a){const t=new e.RiffPcmEncoder(u.sampleRate,16e3),o=u.createMediaStreamSource(s),c=()=>{const d=(()=>{let l=0;try{return u.createScriptProcessor(l,1,1)}catch{l=2048;let g=u.sampleRate;for(;l<16384&&g>=32e3;)l<<=1,g>>=1;return u.createScriptProcessor(l,1,1)}})();d.onaudioprocess=l=>{const h=l.inputBuffer.getChannelData(0);if(a&&!a.isClosed){const g=t.encode(h);g&&a.writeStreamChunk({buffer:g,isEnd:!1,timeReceived:Date.now()})}},o.connect(d),d.connect(u.destination),this.privMediaResources={scriptProcessorNode:d,source:o,stream:s}},p=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(u.audioWorklet&&!p){if(!this.privSpeechProcessorScript){const d=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,l=new Blob([d],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(l)}u.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const d=new AudioWorkletNode(u,"speech-processor");d.port.onmessage=l=>{const h=l.data;if(a&&!a.isClosed){const g=t.encode(h);g&&a.writeStreamChunk({buffer:g,isEnd:!1,timeReceived:Date.now()})}},o.connect(d),d.connect(u.destination),this.privMediaResources={scriptProcessorNode:d,source:o,stream:s}}).catch(()=>{c()})}else try{c()}catch(d){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${d}`)}}releaseMediaResources(u){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(u.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(s=>s.stop()),this.privMediaResources.source=null))}setWorkletUrl(u){this.privSpeechProcessorScript=u}}return ht.PcmRecorder=r,ht}var lt={},B={},Ko;function td(){if(Ko)return B;Ko=1;var e=B&&B.__createBinding||(Object.create?function(l,h,g,f){f===void 0&&(f=g),Object.defineProperty(l,f,{enumerable:!0,get:function(){return h[g]}})}:function(l,h,g,f){f===void 0&&(f=g),l[f]=h[g]}),r=B&&B.__setModuleDefault||(Object.create?function(l,h){Object.defineProperty(l,"default",{enumerable:!0,value:h})}:function(l,h){l.default=h}),n=B&&B.__importStar||function(l){if(l&&l.__esModule)return l;var h={};if(l!=null)for(var g in l)g!=="default"&&Object.prototype.hasOwnProperty.call(l,g)&&e(h,l,g);return r(h,l),h},u=B&&B.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(B,"__esModule",{value:!0}),B.WebsocketMessageAdapter=void 0;const s=n(_e),a=n(_e),i=u(_e),t=u(_e),o=u(_e),c=q(),p=A();let d=class Ss{constructor(h,g,f,S,v,m){if(!h)throw new p.ArgumentNullError("uri");if(!f)throw new p.ArgumentNullError("messageFormatter");this.proxyInfo=S,this.privConnectionEvents=new p.EventSource,this.privConnectionId=g,this.privMessageFormatter=f,this.privConnectionState=p.ConnectionState.None,this.privUri=h,this.privHeaders=v,this.privEnableCompression=m,this.privHeaders[c.HeaderNames.ConnectionId]=this.privConnectionId,this.privHeaders.connectionId=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===p.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new p.Deferred,this.privCertificateValidatedDeferral=new p.Deferred,this.privConnectionState=p.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!Ss.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let g=new URL(this.privUri).protocol;g?.toLocaleLowerCase()==="wss:"?g="https:":g?.toLocaleLowerCase()==="ws:"&&(g="http:");const f={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression,followRedirects:g.toLocaleLowerCase()==="https:"};this.privCertificateValidatedDeferral.resolve(),f.agent=this.getAgent(),f.agent.protocol=g,this.privWebsocketClient=new o.default(this.privUri,f),this.privWebsocketClient.on("redirect",S=>{const v=new p.ConnectionRedirectEvent(this.privConnectionId,S,this.privUri,`Getting redirect URL from endpoint ${this.privUri} with redirect URL '${S}'`);p.Events.instance.onEvent(v)})}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new p.Queue,this.privDisconnectDeferral=new p.Deferred,this.privSendMessageQueue=new p.Queue,this.processSendQueue().catch(h=>{p.Events.instance.onEvent(new p.BackgroundEvent(h))})}catch(h){return this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(500,h)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new p.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=p.ConnectionState.Connected,this.onEvent(new p.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(200,""))},h=>{this.privConnectionEstablishDeferral.reject(h)})},this.privWebsocketClient.onerror=h=>{this.onEvent(new p.ConnectionErrorEvent(this.privConnectionId,h.message,h.type)),this.privLastErrorReceived=h.message},this.privWebsocketClient.onclose=h=>{this.privConnectionState===p.ConnectionState.Connecting?(this.privConnectionState=p.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new p.ConnectionOpenResponse(h.code,h.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=p.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new p.ConnectionClosedEvent(this.privConnectionId,h.code,h.reason))),this.onClose(h.code,h.reason).catch(g=>{p.Events.instance.onEvent(new p.BackgroundEvent(g))})},this.privWebsocketClient.onmessage=h=>{const g=new Date().toISOString();if(this.privConnectionState===p.ConnectionState.Connected){const f=new p.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(f.promise),h.data instanceof ArrayBuffer){const S=new p.RawWebsocketMessage(p.MessageType.Binary,h.data);this.privMessageFormatter.toConnectionMessage(S).then(v=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,g,v)),f.resolve(v)},v=>{f.reject(`Invalid binary message format. Error: ${v}`)})}else{const S=new p.RawWebsocketMessage(p.MessageType.Text,h.data);this.privMessageFormatter.toConnectionMessage(S).then(v=>{this.onEvent(new p.ConnectionMessageReceivedEvent(this.privConnectionId,g,v)),f.resolve(v)},v=>{f.reject(`Invalid text message format. Error: ${v}`)})}}},this.privConnectionEstablishDeferral.promise}send(h){if(this.privConnectionState!==p.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${p.ConnectionState[this.privConnectionState]} state`);const g=new p.Deferred,f=new p.Deferred;return this.privSendMessageQueue.enqueueFromPromise(f.promise),this.privMessageFormatter.fromConnectionMessage(h).then(S=>{f.resolve({Message:h,RawWebsocketMessage:S,sendStatusDeferral:g})},S=>{f.reject(`Error formatting the message. ${S}`)}),g.promise}read(){return this.privConnectionState!==p.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(h){if(this.privWebsocketClient)this.privConnectionState!==p.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,h||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(h){try{if(!h)return Promise.resolve();if(this.onEvent(new p.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),h.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(h.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+h.Message.id+" "+new Error().stack);return Promise.resolve()}catch(g){return Promise.reject(`websocket send error: ${g}`)}}async onClose(h,g){const f=`Connection closed. ${h}: ${g}`;this.privConnectionState=p.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},f),await this.privSendMessageQueue.drainAndDispose(S=>{S.sendStatusDeferral.reject(f)},f)}async processSendQueue(){for(;;){const g=await this.privSendMessageQueue.dequeue();if(!g)return;try{await this.sendRawMessage(g),g.sendStatusDeferral.resolve()}catch(f){g.sendStatusDeferral.reject(f)}}}onEvent(h){this.privConnectionEvents.onEvent(h),p.Events.instance.onEvent(h)}getAgent(){const h=new i.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(h.proxyInfo=this.proxyInfo),h}static GetProxyAgent(h){const g={host:h.HostName,port:h.Port};return h.UserName?g.headers={"Proxy-Authentication":"Basic "+new Buffer(`${h.UserName}:${h.Password===void 0?"":h.Password}`).toString("base64")}:g.headers={},g.headers.requestOCSP="true",new t.default(g)}createConnection(h,g){let f;if(g={...g,requestOCSP:!0,servername:g.host},this.proxyInfo){const v=Ss.GetProxyAgent(this.proxyInfo);f=new Promise((m,C)=>{v.callback(h,g,(y,R)=>{y?C(y):m(R)})})}else g.secureEndpoint?f=Promise.resolve(a.connect(g)):f=Promise.resolve(s.connect(g));return f}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}};return B.WebsocketMessageAdapter=d,d.forceNpmWebSocket=!1,B}var Jo;function Hl(){if(Jo)return lt;Jo=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.WebsocketConnection=void 0;const e=A(),r=td();let n=class{constructor(s,a,i,t,o,c=!1,p){if(this.privIsDisposed=!1,!s)throw new e.ArgumentNullError("uri");if(!t)throw new e.ArgumentNullError("messageFormatter");this.privMessageFormatter=t;let d="",l=0;if(a){for(const h in a)if(h){d+=l===0&&s.indexOf("?")===-1?"?":"&";const g=encodeURIComponent(h);d+=g;let f=a[h];f&&(f=encodeURIComponent(f),d+=`=${f}`),l++}}if(i){for(const h in i)if(h){d+=l===0&&s.indexOf("?")===-1?"?":"&";const g=encodeURIComponent(i[h]);d+=`${h}=${g}`,l++}}this.privUri=s+d,this.privId=p||(0,e.createNoDashGuid)(),this.privConnectionMessageAdapter=new r.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,o,i,c)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(s){return this.privConnectionMessageAdapter.send(s)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}};return lt.WebsocketConnection=n,lt}var vt={},Go;function $l(){if(Go)return vt;Go=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.ReplayableAudioNode=void 0;let e=class{constructor(u,s){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=u,this.privBytesPerSecond=s}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const u=this.privReplayOffset-this.privBufferStartOffset;let s=Math.round(u*this.privBytesPerSecond*1e-7);s%2!==0&&s++;let a=0;for(;a<this.privBuffers.length&&s>=this.privBuffers[a].chunk.buffer.byteLength;)s-=this.privBuffers[a++].chunk.buffer.byteLength;if(a<this.privBuffers.length){const i=this.privBuffers[a].chunk.buffer.slice(s);return this.privReplayOffset+=i.byteLength/this.privBytesPerSecond*1e7,a===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:i,isEnd:!1,timeReceived:this.privBuffers[a].chunk.timeReceived})}}return this.privAudioNode.read().then(u=>(u&&u.buffer&&this.privBuffers&&(this.privBuffers.push(new r(u,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=u.buffer.byteLength),u))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(u){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=u;const s=u-this.privBufferStartOffset;let a=Math.round(s*this.privBytesPerSecond*1e-7),i=0;for(;i<this.privBuffers.length&&a>=this.privBuffers[i].chunk.buffer.byteLength;)a-=this.privBuffers[i++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(u-a/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(i)}findTimeAtOffset(u){if(u<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const s of this.privBuffers){const a=s.byteOffset/this.privBytesPerSecond*1e7,i=a+s.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(u>=a&&u<=i)return s.chunk.timeReceived}return 0}};vt.ReplayableAudioNode=e;class r{constructor(u,s,a){this.chunk=u,this.serial=s,this.byteOffset=a}}return vt}var ft={},yi={},Q={},H={},Qo;function rd(){if(Qo)return H;Qo=1;var e=H&&H.__createBinding||(Object.create?function(i,t,o,c){c===void 0&&(c=o),Object.defineProperty(i,c,{enumerable:!0,get:function(){return t[o]}})}:function(i,t,o,c){c===void 0&&(c=o),i[c]=t[o]}),r=H&&H.__setModuleDefault||(Object.create?function(i,t){Object.defineProperty(i,"default",{enumerable:!0,value:t})}:function(i,t){i.default=t}),n=H&&H.__importStar||function(i){if(i&&i.__esModule)return i;var t={};if(i!=null)for(var o in i)o!=="default"&&Object.prototype.hasOwnProperty.call(i,o)&&e(t,i,o);return r(t,i),t};Object.defineProperty(H,"__esModule",{value:!0}),H.AudioFileWriter=void 0;const u=n(_e),s=_();let a=class{constructor(t){s.Contracts.throwIfNullOrUndefined(u.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=u.openSync(t,"w")}set format(t){s.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=t;let o=0;this.privAudioFormat.hasHeader&&(o=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=u.createWriteStream("",{fd:this.privFd,start:o,autoClose:!1}))}write(t){s.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(t.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),u.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),u.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}};return H.AudioFileWriter=a,H}var F={},Xo;function nd(){if(Xo)return F;Xo=1,Object.defineProperty(F,"__esModule",{value:!0}),F.PullAudioInputStreamImpl=F.PullAudioInputStream=F.PushAudioInputStreamImpl=F.PushAudioInputStream=F.AudioInputStream=void 0;const e=T(),r=A(),n=be(),u=P(),s=Me();let a=class{constructor(){}static createPushStream(d){return i.create(d)}static createPullStream(d,l){return o.create(d,l)}};F.AudioInputStream=a;class i extends a{static create(d){return new t(d)}}F.PushAudioInputStream=i;class t extends i{constructor(d){super(),d===void 0?this.privFormat=s.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=d,this.privEvents=new r.EventSource,this.privId=(0,n.createNoDashGuid)(),this.privStream=new r.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(d){this.privStream.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new r.AudioSourceInitializingEvent(this.privId)),this.onEvent(new r.AudioSourceReadyEvent(this.privId))}async attach(d){this.onEvent(new r.AudioStreamNodeAttachingEvent(this.privId,d)),await this.turnOn();const l=this.privStream;return this.onEvent(new r.AudioStreamNodeAttachedEvent(this.privId,d)),{detach:async()=>(this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,d)),this.turnOff()),id:()=>d,read:()=>l.read()}}detach(d){this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,d))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:e.type.Stream})}onEvent(d){this.privEvents.onEvent(d),r.Events.instance.onEvent(d)}toBuffer(d){const l=Buffer.alloc(d.byteLength),h=new Uint8Array(d);for(let g=0;g<l.length;++g)l[g]=h[g];return l}}F.PushAudioInputStreamImpl=t;class o extends a{constructor(){super()}static create(d,l){return new c(d,l)}}F.PullAudioInputStream=o;class c extends o{constructor(d,l){super(),l===void 0?this.privFormat=u.AudioStreamFormat.getDefaultInputFormat():this.privFormat=l,this.privEvents=new r.EventSource,this.privId=(0,n.createNoDashGuid)(),this.privCallback=d,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new r.AudioSourceInitializingEvent(this.privId)),this.onEvent(new r.AudioSourceReadyEvent(this.privId))}async attach(d){return this.onEvent(new r.AudioStreamNodeAttachingEvent(this.privId,d)),await this.turnOn(),this.onEvent(new r.AudioStreamNodeAttachedEvent(this.privId,d)),{detach:()=>(this.privCallback.close(),this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,d)),this.turnOff()),id:()=>d,read:()=>{let l=0,h;for(;l<this.privBufferSize;){const g=new ArrayBuffer(this.privBufferSize-l),f=this.privCallback.read(g);if(h===void 0?h=g:new Int8Array(h).set(new Int8Array(g),l),f===0)break;l+=f}return Promise.resolve({buffer:h.slice(0,l),isEnd:this.privIsClosed||l===0,timeReceived:Date.now()})}}}detach(d){this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,d))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:e.type.Stream})}onEvent(d){this.privEvents.onEvent(d),r.Events.instance.onEvent(d)}}return F.PullAudioInputStreamImpl=c,F}var x={},gt={},Ri={},Zo;function id(){return Zo||(Zo=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisOutputFormat=void 0,function(r){r[r.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",r[r.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",r[r.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",r[r.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",r[r.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",r[r.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",r[r.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",r[r.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",r[r.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",r[r.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",r[r.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",r[r.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",r[r.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",r[r.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",r[r.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",r[r.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",r[r.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",r[r.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",r[r.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",r[r.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",r[r.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",r[r.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",r[r.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",r[r.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",r[r.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",r[r.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",r[r.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",r[r.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",r[r.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",r[r.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",r[r.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",r[r.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",r[r.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",r[r.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",r[r.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",r[r.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",r[r.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",r[r.AmrWb16000Hz=37]="AmrWb16000Hz",r[r.G72216Khz64Kbps=38]="G72216Khz64Kbps"}(e.SpeechSynthesisOutputFormat||(e.SpeechSynthesisOutputFormat={}))}(Ri)),Ri}var Yo;function Wn(){if(Yo)return gt;Yo=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.AudioOutputFormatImpl=void 0;const e=id(),r=Me();class n extends r.AudioStreamFormatImpl{constructor(s,a,i,t,o,c,p,d,l){super(i,c,a,s),this.formatTag=s,this.avgBytesPerSec=t,this.blockAlign=o,this.priAudioFormatString=p,this.priRequestAudioFormatString=d,this.priHasHeader=l}static fromSpeechSynthesisOutputFormat(s){return s===void 0?n.getDefaultOutputFormat():n.fromSpeechSynthesisOutputFormatString(n.SpeechSynthesisOutputFormatToString[s])}static fromSpeechSynthesisOutputFormatString(s){switch(s){case"raw-8khz-8bit-mono-mulaw":return new n(r.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,s,s,!1);case"riff-16khz-16kbps-mono-siren":return new n(r.AudioFormatTag.Siren,1,16e3,2e3,40,0,s,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new n(r.AudioFormatTag.Siren,1,16e3,2e3,40,0,s,s,!1);case"audio-16khz-32kbitrate-mono-mp3":return new n(r.AudioFormatTag.MP3,1,16e3,4096,2,16,s,s,!1);case"audio-16khz-128kbitrate-mono-mp3":return new n(r.AudioFormatTag.MP3,1,16e3,16384,2,16,s,s,!1);case"audio-16khz-64kbitrate-mono-mp3":return new n(r.AudioFormatTag.MP3,1,16e3,8192,2,16,s,s,!1);case"audio-24khz-48kbitrate-mono-mp3":return new n(r.AudioFormatTag.MP3,1,24e3,6144,2,16,s,s,!1);case"audio-24khz-96kbitrate-mono-mp3":return new n(r.AudioFormatTag.MP3,1,24e3,12288,2,16,s,s,!1);case"audio-24khz-160kbitrate-mono-mp3":return new n(r.AudioFormatTag.MP3,1,24e3,20480,2,16,s,s,!1);case"raw-16khz-16bit-mono-truesilk":return new n(r.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,s,s,!1);case"riff-8khz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,8e3,16e3,2,16,s,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,24e3,48e3,2,16,s,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new n(r.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,s,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,16e3,32e3,2,16,s,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,24e3,48e3,2,16,s,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,8e3,16e3,2,16,s,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new n(r.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,s,s,!1);case"ogg-24khz-16bit-mono-opus":return new n(r.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,s,s,!1);case"raw-48khz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,48e3,96e3,2,16,s,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,48e3,96e3,2,16,s,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new n(r.AudioFormatTag.MP3,1,48e3,12288,2,16,s,s,!1);case"audio-48khz-192kbitrate-mono-mp3":return new n(r.AudioFormatTag.MP3,1,48e3,24576,2,16,s,s,!1);case"ogg-48khz-16bit-mono-opus":return new n(r.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,s,s,!1);case"webm-16khz-16bit-mono-opus":return new n(r.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,s,s,!1);case"webm-24khz-16bit-mono-opus":return new n(r.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,s,s,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new n(r.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,s,s,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new n(r.AudioFormatTag.OPUS,1,16e3,4e3,2,16,s,s,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new n(r.AudioFormatTag.OPUS,1,24e3,6e3,2,16,s,s,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new n(r.AudioFormatTag.OPUS,1,24e3,3e3,2,16,s,s,!1);case"audio-24khz-16bit-mono-flac":return new n(r.AudioFormatTag.FLAC,1,24e3,24e3,2,16,s,s,!1);case"audio-48khz-16bit-mono-flac":return new n(r.AudioFormatTag.FLAC,1,48e3,3e4,2,16,s,s,!1);case"raw-24khz-16bit-mono-truesilk":return new n(r.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,s,s,!1);case"raw-8khz-8bit-mono-alaw":return new n(r.AudioFormatTag.ALaw,1,8e3,8e3,1,8,s,s,!1);case"riff-8khz-8bit-mono-alaw":return new n(r.AudioFormatTag.ALaw,1,8e3,8e3,1,8,s,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,22050,44100,2,16,s,s,!1);case"riff-22050hz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,22050,44100,2,16,s,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,44100,88200,2,16,s,s,!1);case"riff-44100hz-16bit-mono-pcm":return new n(r.AudioFormatTag.PCM,1,44100,88200,2,16,s,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new n(r.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,s,s,!1);case"g722-16khz-64kbps":return new n(r.AudioFormatTag.G722,1,16e3,8e3,2,16,s,s,!1);case"riff-16khz-16bit-mono-pcm":default:return new n(r.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return n.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(s){if(this.priHasHeader){const a=new DataView(this.privHeader);a.setUint32(4,s+this.privHeader.byteLength-8,!0),a.setUint32(40,s,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(s){if(!this.hasHeader)return s;this.updateHeader(s.byteLength);const a=new Uint8Array(s.byteLength+this.header.byteLength);return a.set(new Uint8Array(this.header),0),a.set(new Uint8Array(s),this.header.byteLength),a.buffer}}return gt.AudioOutputFormatImpl=n,n.SpeechSynthesisOutputFormatToString={[e.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[e.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[e.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[e.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[e.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[e.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[e.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[e.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[e.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[e.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[e.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[e.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[e.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[e.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"},gt}var ea;function ke(){if(ea)return x;ea=1,Object.defineProperty(x,"__esModule",{value:!0}),x.PushAudioOutputStreamImpl=x.PushAudioOutputStream=x.PullAudioOutputStreamImpl=x.PullAudioOutputStream=x.AudioOutputStream=void 0;const e=A(),r=_(),n=Wn();let u=class{constructor(){}static createPullStream(){return s.create()}};x.AudioOutputStream=u;class s extends u{static create(){return new a}}x.PullAudioOutputStream=s;class a extends s{constructor(){super(),this.privId=(0,e.createNoDashGuid)(),this.privStream=new e.Stream}set format(c){c==null&&(this.privFormat=n.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=c}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(c){const p=new Int8Array(c);let d=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>c.byteLength)return p.set(this.privLastChunkView.slice(0,c.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(c.byteLength),Promise.resolve(c.byteLength);p.set(this.privLastChunkView),d=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;d<c.byteLength&&!this.privStream.isReadEnded;){const l=await this.privStream.read();if(l!==void 0&&!l.isEnd){let h;l.buffer.byteLength>c.byteLength-d?(h=l.buffer.slice(0,c.byteLength-d),this.privLastChunkView=new Int8Array(l.buffer.slice(c.byteLength-d))):h=l.buffer,p.set(new Int8Array(h),d),d+=h.byteLength}else this.privStream.readEnded()}return d}write(c){r.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:c,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}x.PullAudioOutputStreamImpl=a;class i extends u{constructor(){super()}static create(c){return new t(c)}}x.PushAudioOutputStream=i;class t extends i{constructor(c){super(),this.privId=(0,e.createNoDashGuid)(),this.privCallback=c}set format(c){}write(c){this.privCallback.write&&this.privCallback.write(c)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}return x.PushAudioOutputStreamImpl=t,x}var ta;function od(){if(ta)return Q;ta=1,Object.defineProperty(Q,"__esModule",{value:!0}),Q.AudioOutputConfigImpl=Q.AudioConfigImpl=Q.AudioConfig=void 0;const e=z(),r=_(),n=P(),u=rd(),s=nd(),a=ke();let i=class sd{static fromDefaultMicrophoneInput(){const p=new e.PcmRecorder(!0);return new t(new e.MicAudioSource(p))}static fromMicrophoneInput(p){const d=new e.PcmRecorder(!0);return new t(new e.MicAudioSource(d,p))}static fromWavFileInput(p,d="unnamedBuffer.wav"){return new t(new e.FileAudioSource(p,d))}static fromStreamInput(p){if(p instanceof n.PullAudioInputStreamCallback)return new t(new s.PullAudioInputStreamImpl(p));if(p instanceof n.AudioInputStream)return new t(p);if(typeof MediaStream<"u"&&p instanceof MediaStream){const d=new e.PcmRecorder(!1);return new t(new e.MicAudioSource(d,null,null,p))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new o(new n.SpeakerAudioDestination)}static fromSpeakerOutput(p){if(p===void 0)return sd.fromDefaultSpeakerOutput();if(p instanceof n.SpeakerAudioDestination)return new o(p);throw new Error("Not Supported Type")}static fromAudioFileOutput(p){return new o(new u.AudioFileWriter(p))}static fromStreamOutput(p){if(p instanceof n.PushAudioOutputStreamCallback)return new o(new a.PushAudioOutputStreamImpl(p));if(p instanceof n.PushAudioOutputStream)return new o(p);if(p instanceof n.PullAudioOutputStream)return new o(p);throw new Error("Not Supported Type")}};Q.AudioConfig=i;class t extends i{constructor(p){super(),this.privSource=p}get format(){return this.privSource.format}close(p,d){this.privSource.turnOff().then(()=>{p&&p()},l=>{d&&d(l)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(p){return this.privSource.attach(p)}detach(p){return this.privSource.detach(p)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(p,d){if(r.Contracts.throwIfNull(d,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(p,d);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(p,d){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(p,d);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}Q.AudioConfigImpl=t;class o extends i{constructor(p){super(),this.privDestination=p}set format(p){this.privDestination.format=p}write(p){this.privDestination.write(p)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return Q.AudioOutputConfigImpl=o,Q}var Pi={},ra;function Kl(){return ra||(ra=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationReason=void 0,function(r){r[r.Error=0]="Error",r[r.EndOfStream=1]="EndOfStream"}(e.CancellationReason||(e.CancellationReason={}))}(Pi)),Pi}var St={},na;function Jl(){if(na)return St;na=1,Object.defineProperty(St,"__esModule",{value:!0}),St.PullAudioInputStreamCallback=void 0;let e=class{};return St.PullAudioInputStreamCallback=e,St}var mt={},ia;function Gl(){if(ia)return mt;ia=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.PushAudioOutputStreamCallback=void 0;let e=class{};return mt.PushAudioOutputStreamCallback=e,mt}var Ct={},sa;function Ql(){if(sa)return Ct;sa=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.KeywordRecognitionModel=void 0;const e=_();let r=class{constructor(){this.privDisposed=!1}static fromFile(u){throw e.Contracts.throwIfFileDoesNotExist(u,"fileName"),new Error("Not yet implemented.")}static fromStream(u){throw e.Contracts.throwIfNull(u,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}};return Ct.KeywordRecognitionModel=r,Ct}var yt={},oa;function Xl(){if(oa)return yt;oa=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.SessionEventArgs=void 0;let e=class{constructor(n){this.privSessionId=n}get sessionId(){return this.privSessionId}};return yt.SessionEventArgs=e,yt}var Rt={},aa;function Zl(){if(aa)return Rt;aa=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.RecognitionEventArgs=void 0;const e=P();let r=class extends e.SessionEventArgs{constructor(u,s){super(s),this.privOffset=u}get offset(){return this.privOffset}};return Rt.RecognitionEventArgs=r,Rt}var Ei={},ca;function Yl(){return ca||(ca=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OutputFormat=void 0,function(r){r[r.Simple=0]="Simple",r[r.Detailed=1]="Detailed"}(e.OutputFormat||(e.OutputFormat={}))}(Ei)),Ei}var Pt={},ua;function ev(){if(ua)return Pt;ua=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.IntentRecognitionEventArgs=void 0;const e=P();let r=class extends e.RecognitionEventArgs{constructor(u,s,a){super(s,a),this.privResult=u}get result(){return this.privResult}};return Pt.IntentRecognitionEventArgs=r,Pt}var Et={},pa;function tv(){if(pa)return Et;pa=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.RecognitionResult=void 0;let e=class{constructor(n,u,s,a,i,t,o,c,p,d){this.privResultId=n,this.privReason=u,this.privText=s,this.privDuration=a,this.privOffset=i,this.privLanguage=t,this.privLanguageDetectionConfidence=o,this.privErrorDetails=c,this.privJson=p,this.privProperties=d}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}};return Et.RecognitionResult=e,Et}var It={},da;function rv(){if(da)return It;da=1,Object.defineProperty(It,"__esModule",{value:!0}),It.SpeechRecognitionResult=void 0;const e=P();let r=class extends e.RecognitionResult{constructor(u,s,a,i,t,o,c,p,d,l,h){super(u,s,a,i,t,o,c,d,l,h),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return It.SpeechRecognitionResult=r,It}var Tt={},ha;function nv(){if(ha)return Tt;ha=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.IntentRecognitionResult=void 0;const e=P();let r=class extends e.SpeechRecognitionResult{constructor(u,s,a,i,t,o,c,p,d,l,h){super(s,a,i,t,o,c,p,void 0,d,l,h),this.privIntentId=u}get intentId(){return this.privIntentId}};return Tt.IntentRecognitionResult=r,Tt}var ue={},la;function iv(){if(la)return ue;la=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.LanguageUnderstandingModelImpl=ue.LanguageUnderstandingModel=void 0;const e=_();let r=class{constructor(){}static fromEndpoint(s){e.Contracts.throwIfNull(s,"uri"),e.Contracts.throwIfNullOrWhitespace(s.hostname,"uri");const a=new n,i=s.host.indexOf(".");if(i===-1)throw new Error("Could not determine region from endpoint");a.region=s.host.substr(0,i);const t=s.pathname.lastIndexOf("/")+1;if(t===-1)throw new Error("Could not determine appId from endpoint");if(a.appId=s.pathname.substr(t),a.subscriptionKey=s.searchParams.get("subscription-key"),a.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return a}static fromAppId(s){e.Contracts.throwIfNullOrWhitespace(s,"appId");const a=new n;return a.appId=s,a}static fromSubscription(s,a,i){e.Contracts.throwIfNullOrWhitespace(s,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(a,"appId"),e.Contracts.throwIfNullOrWhitespace(i,"region");const t=new n;return t.appId=a,t.region=i,t.subscriptionKey=s,t}};ue.LanguageUnderstandingModel=r;class n extends r{}return ue.LanguageUnderstandingModelImpl=n,ue}var X={},va;function sv(){if(va)return X;va=1,Object.defineProperty(X,"__esModule",{value:!0}),X.MeetingTranscriptionEventArgs=X.ConversationTranscriptionEventArgs=X.SpeechRecognitionEventArgs=void 0;const e=P();let r=class extends e.RecognitionEventArgs{constructor(a,i,t){super(i,t),this.privResult=a}get result(){return this.privResult}};X.SpeechRecognitionEventArgs=r;class n extends e.RecognitionEventArgs{constructor(a,i,t){super(i,t),this.privResult=a}get result(){return this.privResult}}X.ConversationTranscriptionEventArgs=n;class u extends r{}return X.MeetingTranscriptionEventArgs=u,X}var At={},wt={},fa;function Vn(){if(fa)return wt;fa=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.CancellationEventArgsBase=void 0;const e=P();let r=class extends e.RecognitionEventArgs{constructor(u,s,a,i,t){super(i,t),this.privReason=u,this.privErrorDetails=s,this.privErrorCode=a}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return wt.CancellationEventArgsBase=r,wt}var ga;function ov(){if(ga)return At;ga=1,Object.defineProperty(At,"__esModule",{value:!0}),At.SpeechRecognitionCanceledEventArgs=void 0;const e=Vn();let r=class extends e.CancellationEventArgsBase{};return At.SpeechRecognitionCanceledEventArgs=r,At}var _t={},Sa;function av(){if(Sa)return _t;Sa=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.TranslationRecognitionEventArgs=void 0;const e=P();let r=class extends e.RecognitionEventArgs{constructor(u,s,a){super(s,a),this.privResult=u}get result(){return this.privResult}};return _t.TranslationRecognitionEventArgs=r,_t}var bt={},ma;function cv(){if(ma)return bt;ma=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.TranslationSynthesisEventArgs=void 0;const e=P();let r=class extends e.SessionEventArgs{constructor(u,s){super(s),this.privResult=u}get result(){return this.privResult}};return bt.TranslationSynthesisEventArgs=r,bt}var Mt={},Ca;function cd(){if(Ca)return Mt;Ca=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.TranslationRecognitionResult=void 0;const e=P();let r=class ad extends e.SpeechRecognitionResult{constructor(u,s,a,i,t,o,c,p,d,l,h){super(s,a,i,t,o,c,p,void 0,d,l,h),this.privTranslations=u}static fromSpeechRecognitionResult(u){return new ad(void 0,u.resultId,u.reason,u.text,u.duration,u.offset,u.language,u.languageDetectionConfidence,u.errorDetails,u.json,u.properties)}get translations(){return this.privTranslations}};return Mt.TranslationRecognitionResult=r,Mt}var Ot={},ya;function uv(){if(ya)return Ot;ya=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.TranslationSynthesisResult=void 0;let e=class{constructor(n,u){this.privReason=n,this.privAudio=u}get audio(){return this.privAudio}get reason(){return this.privReason}};return Ot.TranslationSynthesisResult=e,Ot}var Ii={},Ra;function pv(){return Ra||(Ra=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ResultReason=void 0,function(r){r[r.NoMatch=0]="NoMatch",r[r.Canceled=1]="Canceled",r[r.RecognizingSpeech=2]="RecognizingSpeech",r[r.RecognizedSpeech=3]="RecognizedSpeech",r[r.RecognizedKeyword=4]="RecognizedKeyword",r[r.RecognizingIntent=5]="RecognizingIntent",r[r.RecognizedIntent=6]="RecognizedIntent",r[r.TranslatingSpeech=7]="TranslatingSpeech",r[r.TranslatedSpeech=8]="TranslatedSpeech",r[r.SynthesizingAudio=9]="SynthesizingAudio",r[r.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",r[r.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",r[r.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",r[r.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",r[r.RecognizedSpeakers=14]="RecognizedSpeakers",r[r.RecognizedSpeaker=15]="RecognizedSpeaker",r[r.ResetVoiceProfile=16]="ResetVoiceProfile",r[r.DeletedVoiceProfile=17]="DeletedVoiceProfile",r[r.VoicesListRetrieved=18]="VoicesListRetrieved",r[r.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",r[r.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",r[r.TranslatedInstantMessage=21]="TranslatedInstantMessage",r[r.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"}(e.ResultReason||(e.ResultReason={}))}(Ii)),Ii}var pe={},Pa;function dv(){if(Pa)return pe;Pa=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.SpeechConfigImpl=pe.SpeechConfig=void 0;const e=T(),r=_(),n=P();let u=class{constructor(){}static fromSubscription(i,t){r.Contracts.throwIfNullOrWhitespace(i,"subscriptionKey"),r.Contracts.throwIfNullOrWhitespace(t,"region");const o=new s;return o.setProperty(n.PropertyId.SpeechServiceConnection_Region,t),o.setProperty(n.PropertyId.SpeechServiceConnection_IntentRegion,t),o.setProperty(n.PropertyId.SpeechServiceConnection_Key,i),o}static fromEndpoint(i,t){r.Contracts.throwIfNull(i,"endpoint");const o=typeof t=="string"&&t.trim().length>0,c=typeof t=="object"&&t!==null&&typeof t.getToken=="function";if(t!==void 0&&!o&&!c)throw new Error("Invalid 'auth' parameter: must be a non-empty key string or a valid TokenCredential object.");const p=typeof t=="object"?new s(t):new s;return p.setProperty(n.PropertyId.SpeechServiceConnection_Endpoint,i.href),typeof t=="string"&&t.trim().length>0&&p.setProperty(n.PropertyId.SpeechServiceConnection_Key,t),p}static fromHost(i,t){r.Contracts.throwIfNull(i,"hostName");const o=new s;return o.setProperty(n.PropertyId.SpeechServiceConnection_Host,i.protocol+"//"+i.hostname+(i.port===""?"":":"+i.port)),o.setProperty(n.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),t!==void 0&&o.setProperty(n.PropertyId.SpeechServiceConnection_Key,t),o}static fromAuthorizationToken(i,t){r.Contracts.throwIfNull(i,"authorizationToken"),r.Contracts.throwIfNullOrWhitespace(t,"region");const o=new s;return o.setProperty(n.PropertyId.SpeechServiceConnection_Region,t),o.setProperty(n.PropertyId.SpeechServiceConnection_IntentRegion,t),o.authorizationToken=i,o}close(){}};pe.SpeechConfig=u;class s extends u{constructor(i){super(),this.privProperties=new n.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=n.OutputFormat.Simple,this.privTokenCredential=i}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(i){this.privProperties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,i)}get speechRecognitionLanguage(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(i){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,i)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(i){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,i)}get outputFormat(){return n.OutputFormat[this.privProperties.getProperty(e.OutputFormatPropertyName,void 0)]}set outputFormat(i){this.privProperties.setProperty(e.OutputFormatPropertyName,n.OutputFormat[i])}get endpointId(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(i){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_EndpointId,i)}get tokenCredential(){return this.privTokenCredential}setProperty(i,t){r.Contracts.throwIfNull(t,"value"),this.privProperties.setProperty(i,t)}getProperty(i,t){return this.privProperties.getProperty(i,t)}setProxy(i,t,o,c){this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyHostName],i),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyUserName],o),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyPassword],c)}setServiceProperty(i,t){const o=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));o[i]=t,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(o))}setProfanity(i){this.privProperties.setProperty(n.PropertyId.SpeechServiceResponse_ProfanityOption,n.ProfanityOption[i])}enableAudioLogging(){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(e.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(e.ForceDictationPropertyName,"true")}clone(){const i=new s(this.tokenCredential);return i.privProperties=this.privProperties.clone(),i}get speechSynthesisLanguage(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(i){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage,i)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(i){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthVoice,i)}get speechSynthesisOutputFormat(){return n.SpeechSynthesisOutputFormat[this.privProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(i){this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,n.SpeechSynthesisOutputFormat[i])}}return pe.SpeechConfigImpl=s,pe}var de={},Ea;function hv(){if(Ea)return de;Ea=1,Object.defineProperty(de,"__esModule",{value:!0}),de.SpeechTranslationConfigImpl=de.SpeechTranslationConfig=void 0;const e=T(),r=_(),n=P();let u=class extends n.SpeechConfig{constructor(){super()}static fromSubscription(i,t){r.Contracts.throwIfNullOrWhitespace(i,"subscriptionKey"),r.Contracts.throwIfNullOrWhitespace(t,"region");const o=new s;return o.properties.setProperty(n.PropertyId.SpeechServiceConnection_Key,i),o.properties.setProperty(n.PropertyId.SpeechServiceConnection_Region,t),o}static fromAuthorizationToken(i,t){r.Contracts.throwIfNullOrWhitespace(i,"authorizationToken"),r.Contracts.throwIfNullOrWhitespace(t,"region");const o=new s;return o.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,i),o.properties.setProperty(n.PropertyId.SpeechServiceConnection_Region,t),o}static fromHost(i,t){r.Contracts.throwIfNull(i,"hostName");const o=new s;return o.setProperty(n.PropertyId.SpeechServiceConnection_Host,i.protocol+"//"+i.hostname+(i.port===""?"":":"+i.port)),t!==void 0&&o.setProperty(n.PropertyId.SpeechServiceConnection_Key,t),o}static fromEndpoint(i,t){r.Contracts.throwIfNull(i,"endpoint");const o=typeof t=="string"&&t.trim().length>0,c=typeof t=="object"&&t!==null&&typeof t.getToken=="function";if(t!==void 0&&!o&&!c)throw new Error("Invalid 'auth' parameter: must be a non-empty key string or a valid TokenCredential object.");const p=typeof t=="object"?new s(t):new s;return p.setProperty(n.PropertyId.SpeechServiceConnection_Endpoint,i.href),typeof t=="string"&&t.trim().length>0&&p.setProperty(n.PropertyId.SpeechServiceConnection_Key,t),p}};de.SpeechTranslationConfig=u;class s extends u{constructor(i){super(),this.privSpeechProperties=new n.PropertyCollection,this.outputFormat=n.OutputFormat.Simple,this.privTokenCredential=i}set authorizationToken(i){r.Contracts.throwIfNullOrWhitespace(i,"value"),this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,i)}set speechRecognitionLanguage(i){r.Contracts.throwIfNullOrWhitespace(i,"value"),this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,i)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return n.OutputFormat[this.privSpeechProperties.getProperty(e.OutputFormatPropertyName,void 0)]}set outputFormat(i){this.privSpeechProperties.setProperty(e.OutputFormatPropertyName,n.OutputFormat[i])}get endpointId(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(i){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_EndpointId,i)}addTargetLanguage(i){r.Contracts.throwIfNullOrWhitespace(i,"value");const t=this.targetLanguages;t.includes(i)||(t.push(i),this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages,t.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(i){r.Contracts.throwIfNullOrWhitespace(i,"value"),this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_TranslationVoice,i)}get region(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_Region)}get tokenCredential(){return this.privTokenCredential}setProxy(i,t,o,c){this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyHostName],i),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyPort],t),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyUserName],o),this.setProperty(n.PropertyId[n.PropertyId.SpeechServiceConnection_ProxyPassword],c)}getProperty(i,t){return this.privSpeechProperties.getProperty(i,t)}setProperty(i,t){this.privSpeechProperties.setProperty(i,t)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(i,t){const o=JSON.parse(this.privSpeechProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));o[i]=t,this.privSpeechProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(o))}setProfanity(i){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceResponse_ProfanityOption,n.ProfanityOption[i])}enableAudioLogging(){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(e.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(i){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthLanguage,i)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(i){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthVoice,i)}get speechSynthesisOutputFormat(){return n.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(i){this.privSpeechProperties.setProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,n.SpeechSynthesisOutputFormat[i])}}return de.SpeechTranslationConfigImpl=s,de}var Dt={},Ia;function pd(){if(Ia)return Dt;Ia=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.PropertyCollection=void 0;const e=P();let r=class ud{constructor(){this.privKeys=[],this.privValues=[]}getProperty(u,s){let a;typeof u=="string"?a=u:a=e.PropertyId[u];for(let i=0;i<this.privKeys.length;i++)if(this.privKeys[i]===a)return this.privValues[i];if(s!==void 0)return String(s)}setProperty(u,s){let a;typeof u=="string"?a=u:a=e.PropertyId[u];for(let i=0;i<this.privKeys.length;i++)if(this.privKeys[i]===a){this.privValues[i]=s;return}this.privKeys.push(a),this.privValues.push(s)}clone(){const u=new ud;for(let s=0;s<this.privKeys.length;s++)u.privKeys.push(this.privKeys[s]),u.privValues.push(this.privValues[s]);return u}mergeTo(u){this.privKeys.forEach(s=>{if(u.getProperty(s,void 0)===void 0){const a=this.getProperty(s);u.setProperty(s,a)}})}get keys(){return this.privKeys}};return Dt.PropertyCollection=r,Dt}var Ti={},Ta;function As(){return Ta||(Ta=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PropertyId=void 0,function(r){r[r.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",r[r.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",r[r.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",r[r.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",r[r.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",r[r.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",r[r.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",r[r.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",r[r.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",r[r.SpeechServiceConnection_TranslationCategoryId=9]="SpeechServiceConnection_TranslationCategoryId",r[r.SpeechServiceConnection_IntentRegion=10]="SpeechServiceConnection_IntentRegion",r[r.SpeechServiceConnection_ProxyHostName=11]="SpeechServiceConnection_ProxyHostName",r[r.SpeechServiceConnection_ProxyPort=12]="SpeechServiceConnection_ProxyPort",r[r.SpeechServiceConnection_ProxyUserName=13]="SpeechServiceConnection_ProxyUserName",r[r.SpeechServiceConnection_ProxyPassword=14]="SpeechServiceConnection_ProxyPassword",r[r.SpeechServiceConnection_RecoMode=15]="SpeechServiceConnection_RecoMode",r[r.SpeechServiceConnection_RecoLanguage=16]="SpeechServiceConnection_RecoLanguage",r[r.Speech_SessionId=17]="Speech_SessionId",r[r.SpeechServiceConnection_SynthLanguage=18]="SpeechServiceConnection_SynthLanguage",r[r.SpeechServiceConnection_SynthVoice=19]="SpeechServiceConnection_SynthVoice",r[r.SpeechServiceConnection_SynthOutputFormat=20]="SpeechServiceConnection_SynthOutputFormat",r[r.SpeechServiceConnection_AutoDetectSourceLanguages=21]="SpeechServiceConnection_AutoDetectSourceLanguages",r[r.SpeechServiceResponse_RequestDetailedResultTrueFalse=22]="SpeechServiceResponse_RequestDetailedResultTrueFalse",r[r.SpeechServiceResponse_RequestProfanityFilterTrueFalse=23]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",r[r.SpeechServiceResponse_JsonResult=24]="SpeechServiceResponse_JsonResult",r[r.SpeechServiceResponse_JsonErrorDetails=25]="SpeechServiceResponse_JsonErrorDetails",r[r.CancellationDetails_Reason=26]="CancellationDetails_Reason",r[r.CancellationDetails_ReasonText=27]="CancellationDetails_ReasonText",r[r.CancellationDetails_ReasonDetailedText=28]="CancellationDetails_ReasonDetailedText",r[r.LanguageUnderstandingServiceResponse_JsonResult=29]="LanguageUnderstandingServiceResponse_JsonResult",r[r.SpeechServiceConnection_Url=30]="SpeechServiceConnection_Url",r[r.SpeechServiceConnection_InitialSilenceTimeoutMs=31]="SpeechServiceConnection_InitialSilenceTimeoutMs",r[r.SpeechServiceConnection_EndSilenceTimeoutMs=32]="SpeechServiceConnection_EndSilenceTimeoutMs",r[r.Speech_SegmentationSilenceTimeoutMs=33]="Speech_SegmentationSilenceTimeoutMs",r[r.Speech_SegmentationMaximumTimeMs=34]="Speech_SegmentationMaximumTimeMs",r[r.Speech_SegmentationStrategy=35]="Speech_SegmentationStrategy",r[r.SpeechServiceConnection_EnableAudioLogging=36]="SpeechServiceConnection_EnableAudioLogging",r[r.SpeechServiceConnection_LanguageIdMode=37]="SpeechServiceConnection_LanguageIdMode",r[r.SpeechServiceConnection_RecognitionEndpointVersion=38]="SpeechServiceConnection_RecognitionEndpointVersion",r[r.SpeechServiceConnection_SpeakerIdMode=39]="SpeechServiceConnection_SpeakerIdMode",r[r.SpeechServiceResponse_ProfanityOption=40]="SpeechServiceResponse_ProfanityOption",r[r.SpeechServiceResponse_PostProcessingOption=41]="SpeechServiceResponse_PostProcessingOption",r[r.SpeechServiceResponse_RequestWordLevelTimestamps=42]="SpeechServiceResponse_RequestWordLevelTimestamps",r[r.SpeechServiceResponse_StablePartialResultThreshold=43]="SpeechServiceResponse_StablePartialResultThreshold",r[r.SpeechServiceResponse_OutputFormatOption=44]="SpeechServiceResponse_OutputFormatOption",r[r.SpeechServiceResponse_TranslationRequestStablePartialResult=45]="SpeechServiceResponse_TranslationRequestStablePartialResult",r[r.SpeechServiceResponse_RequestWordBoundary=46]="SpeechServiceResponse_RequestWordBoundary",r[r.SpeechServiceResponse_RequestPunctuationBoundary=47]="SpeechServiceResponse_RequestPunctuationBoundary",r[r.SpeechServiceResponse_RequestSentenceBoundary=48]="SpeechServiceResponse_RequestSentenceBoundary",r[r.SpeechServiceResponse_DiarizeIntermediateResults=49]="SpeechServiceResponse_DiarizeIntermediateResults",r[r.Conversation_ApplicationId=50]="Conversation_ApplicationId",r[r.Conversation_DialogType=51]="Conversation_DialogType",r[r.Conversation_Initial_Silence_Timeout=52]="Conversation_Initial_Silence_Timeout",r[r.Conversation_From_Id=53]="Conversation_From_Id",r[r.Conversation_Conversation_Id=54]="Conversation_Conversation_Id",r[r.Conversation_Custom_Voice_Deployment_Ids=55]="Conversation_Custom_Voice_Deployment_Ids",r[r.Conversation_Speech_Activity_Template=56]="Conversation_Speech_Activity_Template",r[r.Conversation_Request_Bot_Status_Messages=57]="Conversation_Request_Bot_Status_Messages",r[r.Conversation_Agent_Connection_Id=58]="Conversation_Agent_Connection_Id",r[r.SpeechServiceConnection_Host=59]="SpeechServiceConnection_Host",r[r.ConversationTranslator_Host=60]="ConversationTranslator_Host",r[r.ConversationTranslator_Name=61]="ConversationTranslator_Name",r[r.ConversationTranslator_CorrelationId=62]="ConversationTranslator_CorrelationId",r[r.ConversationTranslator_Token=63]="ConversationTranslator_Token",r[r.PronunciationAssessment_ReferenceText=64]="PronunciationAssessment_ReferenceText",r[r.PronunciationAssessment_GradingSystem=65]="PronunciationAssessment_GradingSystem",r[r.PronunciationAssessment_Granularity=66]="PronunciationAssessment_Granularity",r[r.PronunciationAssessment_EnableMiscue=67]="PronunciationAssessment_EnableMiscue",r[r.PronunciationAssessment_Json=68]="PronunciationAssessment_Json",r[r.PronunciationAssessment_Params=69]="PronunciationAssessment_Params",r[r.SpeakerRecognition_Api_Version=70]="SpeakerRecognition_Api_Version",r[r.WebWorkerLoadType=71]="WebWorkerLoadType",r[r.TalkingAvatarService_WebRTC_SDP=72]="TalkingAvatarService_WebRTC_SDP"}(e.PropertyId||(e.PropertyId={}))}(Ti)),Ti}var kt={},Aa;function lv(){if(Aa)return kt;Aa=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.Recognizer=void 0;const e=T(),r=A(),n=_(),u=P();let s=class dd{constructor(i,t,o,c){this.audioConfig=i!==void 0?i:u.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=o,this.tokenCredential=c,this.implCommonRecognizerSetup()}close(i,t){n.Contracts.throwIfDisposed(this.privDisposed),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),i,t)}get internalData(){return this.privReco}async dispose(i){this.privDisposed||(this.privDisposed=!0,i&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return e.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(i){e.ServiceRecognizerBase.telemetryDataEnabled=i}implCommonRecognizerSetup(){let i=typeof window<"u"?"Browser":"Node",t="unknown",o="unknown";typeof navigator<"u"&&(i=i+"/"+navigator.platform,t=navigator.userAgent,o=navigator.appVersion);const c=this.createRecognizerConfig(new e.SpeechServiceConfig(new e.Context(new e.OS(i,t,o))));this.privReco=this.createServiceRecognizer(dd.getAuth(this.privProperties,this.tokenCredential),this.privConnectionFactory,this.audioConfig,c)}async recognizeOnceAsyncImpl(i){n.Contracts.throwIfDisposed(this.privDisposed);const t=new r.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(i,t.resolve,t.reject);const o=await t.promise;return await this.implRecognizerStop(),o}async startContinuousRecognitionAsyncImpl(i){n.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(i,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){n.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuth(i,t){const o=i.getProperty(u.PropertyId.SpeechServiceConnection_Key,void 0);return o&&o!==""?new e.CognitiveSubscriptionKeyAuthentication(o):t?new e.CognitiveTokenAuthentication(async()=>{try{return(await t.getToken("https://cognitiveservices.azure.com/.default"))?.token??""}catch(c){throw c}},async()=>{try{return(await t.getToken("https://cognitiveservices.azure.com/.default"))?.token??""}catch(c){throw c}}):new e.CognitiveTokenAuthentication(()=>{const c=i.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)},()=>{const c=i.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)})}};return kt.Recognizer=s,kt}var zt={},Ai={},wa;function W(){return wa||(wa=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionMode=void 0,function(r){r.Interactive="Interactive",r.Dictation="Dictation",r.Conversation="Conversation",r.None="None"}(e.RecognitionMode||(e.RecognitionMode={}))}(Ai)),Ai}var _a;function vv(){if(_a)return zt;_a=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.SpeechRecognizer=void 0;const e=T(),r=W(),n=A(),u=_(),s=P();let a=class hd extends s.Recognizer{constructor(t,o){const c=t;u.Contracts.throwIfNull(c,"speechConfig"),u.Contracts.throwIfNullOrWhitespace(c.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage]),super(o,c.properties,new e.SpeechConnectionFactory,t.tokenCredential),this.privDisposedRecognizer=!1}static FromConfig(t,o,c){const p=t;return o.properties.mergeTo(p.properties),new hd(t,c)}get endpointId(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(t){u.Contracts.throwIfNullOrWhitespace(t,"token"),this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,t)}get speechRecognitionLanguage(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(e.OutputFormatPropertyName,s.OutputFormat[s.OutputFormat.Simple])===s.OutputFormat[s.OutputFormat.Simple]?s.OutputFormat.Simple:s.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(t,o){(0,n.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(r.RecognitionMode.Interactive),t,o)}startContinuousRecognitionAsync(t,o){(0,n.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(this.properties.getProperty(e.ForceDictationPropertyName,void 0)===void 0?r.RecognitionMode.Conversation:r.RecognitionMode.Dictation),t,o)}stopContinuousRecognitionAsync(t,o){(0,n.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),t,o)}startKeywordRecognitionAsync(t,o,c){u.Contracts.throwIfNull(t,"model"),c&&c("Not yet implemented.")}stopKeywordRecognitionAsync(t){t&&t()}close(t,o){u.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,n.marshalPromiseToCallbacks)(this.dispose(!0),t,o)}async dispose(t){this.privDisposedRecognizer||(t&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(t))}createRecognizerConfig(t){return new e.RecognizerConfig(t,this.privProperties)}createServiceRecognizer(t,o,c,p){const d=c;return new e.SpeechServiceRecognizer(t,o,d,p,this)}};return zt.SpeechRecognizer=a,zt}var Nt={},ba;function fv(){if(ba)return Nt;ba=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.IntentRecognizer=void 0;const e=T(),r=W(),n=A(),u=_(),s=P();let a=class extends s.Recognizer{constructor(t,o){u.Contracts.throwIfNullOrUndefined(t,"speechConfig");const c=t;u.Contracts.throwIfNullOrUndefined(c,"speechConfig"),super(o,c.properties,new e.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=c.properties,u.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return u.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(t){this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,t)}get properties(){return this.privProperties}recognizeOnceAsync(t,o){if(u.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const c=this.buildSpeechContext();this.privReco.speechContext.getContext().intent=c.Intent,this.privReco.dynamicGrammar.addReferenceGrammar(c.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,n.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(r.RecognitionMode.Interactive),t,o)}startContinuousRecognitionAsync(t,o){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const c=this.buildSpeechContext();this.privReco.speechContext.getContext().intent=c.Intent,this.privReco.dynamicGrammar.addReferenceGrammar(c.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,n.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(r.RecognitionMode.Conversation),t,o)}stopContinuousRecognitionAsync(t,o){(0,n.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),t,o)}startKeywordRecognitionAsync(t,o,c){u.Contracts.throwIfNull(t,"model"),c&&c("Not yet implemented.")}stopKeywordRecognitionAsync(t,o){if(t)try{t()}catch(c){o&&o(c)}}addIntent(t,o){u.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),u.Contracts.throwIfNullOrWhitespace(o,"intentId"),u.Contracts.throwIfNullOrWhitespace(t,"simplePhrase"),this.privAddedIntents.push([o,t])}addIntentWithLanguageModel(t,o,c){u.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),u.Contracts.throwIfNullOrWhitespace(t,"intentId"),u.Contracts.throwIfNull(o,"model");const p=o;u.Contracts.throwIfNullOrWhitespace(p.appId,"model.appId"),this.privAddedLmIntents[t]=new e.AddedLmIntent(p,c)}addAllIntents(t,o){u.Contracts.throwIfNull(t,"model");const c=t;u.Contracts.throwIfNullOrWhitespace(c.appId,"model.appId"),this.privUmbrellaIntent=new e.AddedLmIntent(c,o)}close(t,o){u.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),(0,n.marshalPromiseToCallbacks)(this.dispose(!0),t,o)}createRecognizerConfig(t){return new e.RecognizerConfig(t,this.privProperties)}createServiceRecognizer(t,o,c,p){const d=c;return new e.IntentServiceRecognizer(t,o,d,p,this)}async dispose(t){this.privDisposedIntentRecognizer||t&&(this.privDisposedIntentRecognizer=!0,await super.dispose(t))}buildSpeechContext(){let t,o,c;const p=[];this.privUmbrellaIntent!==void 0&&(t=this.privUmbrellaIntent.modelImpl.appId,o=this.privUmbrellaIntent.modelImpl.region,c=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const d of Object.keys(this.privAddedLmIntents)){const l=this.privAddedLmIntents[d];if(t===void 0)t=l.modelImpl.appId;else if(t!==l.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(o===void 0)o=l.modelImpl.region;else if(o!==l.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(c===void 0)c=l.modelImpl.subscriptionKey;else if(c!==l.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const h="luis/"+t+"-PRODUCTION#"+d;p.push(h)}return{Intent:{id:t,key:c===void 0?this.privProperties.getProperty(s.PropertyId[s.PropertyId.SpeechServiceConnection_Key]):c,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?p:["luis/"+t+"-PRODUCTION"]}}};return Nt.IntentRecognizer=a,Nt}var wi={},Ma;function gv(){return Ma||(Ma=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceProfileType=void 0,function(r){r[r.TextIndependentIdentification=0]="TextIndependentIdentification",r[r.TextDependentVerification=1]="TextDependentVerification",r[r.TextIndependentVerification=2]="TextIndependentVerification"}(e.VoiceProfileType||(e.VoiceProfileType={}))}(wi)),wi}var jt={},qt={},he={},Oa;function ld(){if(Oa)return he;Oa=1,Object.defineProperty(he,"__esModule",{value:!0}),he.ConnectionMessageImpl=he.ConnectionMessage=void 0;const e=q(),r=A(),n=pd(),u=As();let s=class{};he.ConnectionMessage=s;class a{constructor(t){this.privConnectionMessage=t,this.privProperties=new n.PropertyCollection,this.privConnectionMessage.headers[e.HeaderNames.ConnectionId]&&this.privProperties.setProperty(u.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[e.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(o=>{this.privProperties.setProperty(o,this.privConnectionMessage.headers[o])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(t=>t.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===r.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===r.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return he.ConnectionMessageImpl=a,he}var Da;function vd(){if(Da)return qt;Da=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.Connection=void 0;const e=T(),r=A(),n=ld(),u=_(),s=P();let a=class ms{static fromRecognizer(t){const o=t.internalData,c=new ms;return c.privInternalData=o,c.setupEvents(),c}static fromSynthesizer(t){const o=t.internalData,c=new ms;return c.privInternalData=o,c.setupEvents(),c}openConnection(t,o){(0,r.marshalPromiseToCallbacks)(this.privInternalData.connect(),t,o)}closeConnection(t,o){if(this.privInternalData instanceof e.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,r.marshalPromiseToCallbacks)(this.privInternalData.disconnect(),t,o)}setMessageProperty(t,o,c){if(u.Contracts.throwIfNullOrWhitespace(o,"propertyName"),this.privInternalData instanceof e.ServiceRecognizerBase){if(t.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");{const p=this.privInternalData.speechContext.getContext();p[o]=c}}else if(this.privInternalData instanceof e.SynthesisAdapterBase){if(t.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(o,c)}}sendMessageAsync(t,o,c,p){(0,r.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(t,o),c,p)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(t=>{t.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new s.ConnectionEventArgs(t.connectionId)):t.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new s.ConnectionEventArgs(t.connectionId)):t.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new s.ConnectionMessageEventArgs(new n.ConnectionMessageImpl(t.message))):t.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new s.ConnectionMessageEventArgs(new n.ConnectionMessageImpl(t.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(t=>{this.receivedServiceMessage&&this.receivedServiceMessage(new s.ServiceEventArgs(t.jsonString,t.name))})}};return qt.Connection=a,qt}var ka;function Sv(){if(ka)return jt;ka=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.TranslationRecognizer=void 0;const e=T(),r=W(),n=A(),u=vd(),s=_(),a=P();let i=class fd extends a.Recognizer{constructor(o,c,p){const d=o;s.Contracts.throwIfNull(d,"speechConfig"),super(c,d.properties,p||new e.TranslationConnectionFactory,o.tokenCredential),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&s.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice),a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationVoice]),s.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages),a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationToLanguages]),s.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(o,c,p){const d=o;return c.properties.mergeTo(d.properties),c.properties.getProperty(a.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===e.AutoDetectSourceLanguagesOpenRangeOptionName&&d.properties.setProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new fd(o,p)}get speechRecognitionLanguage(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(o){this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,o)}recognizeOnceAsync(o,c){s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,n.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(r.RecognitionMode.Interactive),o,c)}startContinuousRecognitionAsync(o,c){(0,n.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(r.RecognitionMode.Conversation),o,c)}stopContinuousRecognitionAsync(o,c){(0,n.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),o,c)}removeTargetLanguage(o){if(s.Contracts.throwIfNullOrUndefined(o,"language to be removed"),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const c=this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),p=c.indexOf(o);p>-1&&(c.splice(p,1),this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,c.join(",")),this.updateLanguages(c))}}addTargetLanguage(o){s.Contracts.throwIfNullOrUndefined(o,"language to be added");let c=[];this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(c=this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),c.includes(o)||(c.push(o),this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,c.join(",")))):(this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,o),c=[o]),this.updateLanguages(c)}close(o,c){s.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,n.marshalPromiseToCallbacks)(this.dispose(!0),o,c)}onConnection(){}async dispose(o){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,o&&(await this.implRecognizerStop(),await super.dispose(o)))}createRecognizerConfig(o){return new e.RecognizerConfig(o,this.privProperties)}createServiceRecognizer(o,c,p,d){const l=p;return new e.TranslationServiceRecognizer(o,c,l,d,this)}updateLanguages(o){const c=u.Connection.fromRecognizer(this);c&&(c.setMessageProperty("speech.context","translationcontext",{to:o}),c.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:o})))}};return jt.TranslationRecognizer=i,jt}var Lt={},za;function mv(){if(za)return Lt;za=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.Translations=void 0;const e=P();let r=class{constructor(){this.privMap=new e.PropertyCollection}get languages(){return this.privMap.keys}get(u,s){return this.privMap.getProperty(u,s)}set(u,s){this.privMap.setProperty(u,s)}};return Lt.Translations=r,Lt}var _i={},Na;function Cv(){return Na||(Na=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NoMatchReason=void 0,function(r){r[r.NotRecognized=0]="NotRecognized",r[r.InitialSilenceTimeout=1]="InitialSilenceTimeout",r[r.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(e.NoMatchReason||(e.NoMatchReason={}))}(_i)),_i}var Bt={},ja;function yv(){if(ja)return Bt;ja=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.NoMatchDetails=void 0;const e=T(),r=P();let n=class gd{constructor(s){this.privReason=s}static fromResult(s){const a=e.SimpleSpeechPhrase.fromJSON(s.json,0);let i=r.NoMatchReason.NotRecognized;switch(a.RecognitionStatus){case e.RecognitionStatus.BabbleTimeout:i=r.NoMatchReason.InitialBabbleTimeout;break;case e.RecognitionStatus.InitialSilenceTimeout:i=r.NoMatchReason.InitialSilenceTimeout;break;default:i=r.NoMatchReason.NotRecognized;break}return new gd(i)}get reason(){return this.privReason}};return Bt.NoMatchDetails=n,Bt}var Ft={},qa;function Rv(){if(qa)return Ft;qa=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.TranslationRecognitionCanceledEventArgs=void 0;let e=class{constructor(n,u,s,a,i){this.privCancelReason=u,this.privErrorDetails=s,this.privResult=i,this.privSessionId=n,this.privErrorCode=a}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return Ft.TranslationRecognitionCanceledEventArgs=e,Ft}var xt={},La;function Pv(){if(La)return xt;La=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.IntentRecognitionCanceledEventArgs=void 0;const e=P();let r=class extends e.IntentRecognitionEventArgs{constructor(u,s,a,i,t,o){super(i,t,o),this.privReason=u,this.privErrorDetails=s,this.privErrorCode=a}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return xt.IntentRecognitionCanceledEventArgs=r,xt}var Ut={},Ba;function Sd(){if(Ba)return Ut;Ba=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.CancellationDetailsBase=void 0;let e=class{constructor(n,u,s){this.privReason=n,this.privErrorDetails=u,this.privErrorCode=s}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}};return Ut.CancellationDetailsBase=e,Ut}var Wt={},Fa;function Ev(){if(Fa)return Wt;Fa=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.CancellationDetails=void 0;const e=T(),r=Sd(),n=P();let u=class md extends r.CancellationDetailsBase{constructor(a,i,t){super(a,i,t)}static fromResult(a){let i=n.CancellationReason.Error,t=n.CancellationErrorCode.NoError;if(a instanceof n.RecognitionResult&&a.json){const o=e.SimpleSpeechPhrase.fromJSON(a.json,0);i=e.EnumTranslation.implTranslateCancelResult(o.RecognitionStatus)}return a.properties&&(t=n.CancellationErrorCode[a.properties.getProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.NoError])]),new md(i,a.errorDetails||e.EnumTranslation.implTranslateErrorDetails(t),t)}};return Wt.CancellationDetails=u,Wt}var bi={},xa;function Iv(){return xa||(xa=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CancellationErrorCode=void 0,function(r){r[r.NoError=0]="NoError",r[r.AuthenticationFailure=1]="AuthenticationFailure",r[r.BadRequestParameters=2]="BadRequestParameters",r[r.TooManyRequests=3]="TooManyRequests",r[r.ConnectionFailure=4]="ConnectionFailure",r[r.ServiceTimeout=5]="ServiceTimeout",r[r.ServiceError=6]="ServiceError",r[r.RuntimeError=7]="RuntimeError",r[r.Forbidden=8]="Forbidden"}(e.CancellationErrorCode||(e.CancellationErrorCode={}))}(bi)),bi}var Vt={},Ua;function Tv(){if(Ua)return Vt;Ua=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.ConnectionEventArgs=void 0;const e=P();let r=class extends e.SessionEventArgs{};return Vt.ConnectionEventArgs=r,Vt}var Ht={},Wa;function Av(){if(Wa)return Ht;Wa=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.ServiceEventArgs=void 0;const e=P();let r=class extends e.SessionEventArgs{constructor(u,s,a){super(a),this.privJsonResult=u,this.privEventName=s}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return Ht.ServiceEventArgs=r,Ht}var $t={},Va;function wv(){if(Va)return $t;Va=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.PhraseListGrammar=void 0;let e=class Cd{constructor(n){this.privGrammerBuilder=n.dynamicGrammar}static fromRecognizer(n){const u=n.internalData;return new Cd(u)}addPhrase(n){this.privGrammerBuilder.addPhrase(n)}addPhrases(n){this.privGrammerBuilder.addPhrase(n)}clear(){this.privGrammerBuilder.clearPhrases()}};return $t.PhraseListGrammar=e,$t}var le={},Ha;function ws(){if(Ha)return le;Ha=1,Object.defineProperty(le,"__esModule",{value:!0}),le.DialogServiceConfigImpl=le.DialogServiceConfig=void 0;const e=_(),r=P();let n=class{constructor(){}set applicationId(a){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};le.DialogServiceConfig=n;class u extends n{constructor(){super(),this.privSpeechConfig=new r.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(a){e.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechConfig.speechRecognitionLanguage=a}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(a){this.privSpeechConfig.outputFormat=a}setProperty(a,i){this.privSpeechConfig.setProperty(a,i)}getProperty(a,i){return this.privSpeechConfig.getProperty(a)}setProxy(a,i,t,o){this.setProperty(r.PropertyId.SpeechServiceConnection_ProxyHostName,a),this.setProperty(r.PropertyId.SpeechServiceConnection_ProxyPort,`${i}`),t&&this.setProperty(r.PropertyId.SpeechServiceConnection_ProxyUserName,t),o&&this.setProperty(r.PropertyId.SpeechServiceConnection_ProxyPassword,o)}setServiceProperty(a,i,t){this.privSpeechConfig.setServiceProperty(a,i)}close(){}}return le.DialogServiceConfigImpl=u,le}var Kt={},$a;function _v(){if($a)return Kt;$a=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.BotFrameworkConfig=void 0;const e=_(),r=ws(),n=P();let u=class extends r.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(a,i,t){e.Contracts.throwIfNullOrWhitespace(a,"subscription"),e.Contracts.throwIfNullOrWhitespace(i,"region");const o=new r.DialogServiceConfigImpl;return o.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.BotFramework),o.setProperty(n.PropertyId.SpeechServiceConnection_Key,a),o.setProperty(n.PropertyId.SpeechServiceConnection_Region,i),t&&o.setProperty(n.PropertyId.Conversation_ApplicationId,t),o}static fromAuthorizationToken(a,i,t){e.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(i,"region");const o=new r.DialogServiceConfigImpl;return o.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.BotFramework),o.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,a),o.setProperty(n.PropertyId.SpeechServiceConnection_Region,i),t&&o.setProperty(n.PropertyId.Conversation_ApplicationId,t),o}static fromHost(a,i,t){e.Contracts.throwIfNullOrUndefined(a,"host");const o=a instanceof URL?a:new URL(`wss://${a}.convai.speech.azure.us`);e.Contracts.throwIfNullOrUndefined(o,"resolvedHost");const c=new r.DialogServiceConfigImpl;return c.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(n.PropertyId.SpeechServiceConnection_Host,o.toString()),i!==void 0&&c.setProperty(n.PropertyId.SpeechServiceConnection_Key,i),c}static fromEndpoint(a,i){e.Contracts.throwIfNull(a,"endpoint");const t=new r.DialogServiceConfigImpl;return t.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.BotFramework),t.setProperty(n.PropertyId.SpeechServiceConnection_Endpoint,a.toString()),i!==void 0&&t.setProperty(n.PropertyId.SpeechServiceConnection_Key,i),t}};return Kt.BotFrameworkConfig=u,Kt}var Jt={},Ka;function bv(){if(Ka)return Jt;Ka=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.CustomCommandsConfig=void 0;const e=_(),r=ws(),n=P();let u=class extends r.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(a,i,t){e.Contracts.throwIfNullOrWhitespace(a,"applicationId"),e.Contracts.throwIfNullOrWhitespace(i,"subscription"),e.Contracts.throwIfNullOrWhitespace(t,"region");const o=new r.DialogServiceConfigImpl;return o.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.CustomCommands),o.setProperty(n.PropertyId.Conversation_ApplicationId,a),o.setProperty(n.PropertyId.SpeechServiceConnection_Key,i),o.setProperty(n.PropertyId.SpeechServiceConnection_Region,t),o}static fromAuthorizationToken(a,i,t){e.Contracts.throwIfNullOrWhitespace(a,"applicationId"),e.Contracts.throwIfNullOrWhitespace(i,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(t,"region");const o=new r.DialogServiceConfigImpl;return o.setProperty(n.PropertyId.Conversation_DialogType,r.DialogServiceConfig.DialogTypes.CustomCommands),o.setProperty(n.PropertyId.Conversation_ApplicationId,a),o.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,i),o.setProperty(n.PropertyId.SpeechServiceConnection_Region,t),o}set applicationId(a){e.Contracts.throwIfNullOrWhitespace(a,"value"),this.setProperty(n.PropertyId.Conversation_ApplicationId,a)}get applicationId(){return this.getProperty(n.PropertyId.Conversation_ApplicationId)}};return Jt.CustomCommandsConfig=u,Jt}var Gt={},Qt={},Xt={},Zt={},Ja;function re(){if(Ja)return Zt;Ja=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.QueryParameterNames=void 0;let e=class{};return Zt.QueryParameterNames=e,e.BotId="botid",e.CustomSpeechDeploymentId="cid",e.CustomVoiceDeploymentId="deploymentId",e.EnableAudioLogging="storeAudio",e.EnableLanguageId="lidEnabled",e.EnableWordLevelTimestamps="wordLevelTimestamps",e.EndSilenceTimeoutMs="endSilenceTimeoutMs",e.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",e.SegmentationMaximumTimeMs="segmentationMaximumTimeMs",e.SegmentationStrategy="segmentationStrategy",e.Format="format",e.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",e.Language="language",e.Profanity="profanity",e.RequestBotStatusMessages="enableBotMessageStatus",e.StableIntermediateThreshold="stableIntermediateThreshold",e.StableTranslation="stableTranslation",e.TestHooks="testhooks",e.Postprocessing="postprocessing",e.CtsMeetingId="meetingId",e.CtsDeviceId="deviceId",e.CtsIsParticipant="isParticipant",e.EnableAvatar="enableTalkingAvatar",Zt}var Ga;function K(){if(Ga)return Xt;Ga=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.ConnectionFactoryBase=void 0;const e=T(),r=A(),n=P(),u=re();let s=class{static getHostSuffix(i){if(i){if(i.toLowerCase().startsWith("china"))return".azure.cn";if(i.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(i,t,o){new Map([[n.PropertyId.Speech_SegmentationSilenceTimeoutMs,u.QueryParameterNames.SegmentationSilenceTimeoutMs],[n.PropertyId.SpeechServiceConnection_EnableAudioLogging,u.QueryParameterNames.EnableAudioLogging],[n.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,u.QueryParameterNames.EndSilenceTimeoutMs],[n.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,u.QueryParameterNames.InitialSilenceTimeoutMs],[n.PropertyId.SpeechServiceResponse_PostProcessingOption,u.QueryParameterNames.Postprocessing],[n.PropertyId.SpeechServiceResponse_ProfanityOption,u.QueryParameterNames.Profanity],[n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,u.QueryParameterNames.EnableWordLevelTimestamps],[n.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,u.QueryParameterNames.StableIntermediateThreshold]]).forEach((d,l)=>{this.setUrlParameter(l,d,i,t,o)});const p=JSON.parse(i.parameters.getProperty(e.ServicePropertiesPropertyName,"{}"));Object.keys(p).forEach(d=>{t[d]=p[d]})}setUrlParameter(i,t,o,c,p){const d=o.parameters.getProperty(i,void 0);d&&(!p||p.search(t)===-1)&&(c[t]=d.toLocaleLowerCase())}static async getRedirectUrlFromEndpoint(i){let t;if(typeof window<"u"&&typeof window.fetch<"u"){const o=new URL(i);o.protocol="https:",o.port="443",o.searchParams.append("GenerateRedirectResponse","true");const p=o.toString();r.Events.instance.onEvent(new r.ConnectionRedirectEvent("",p,void 0,"ConnectionFactoryBase: redirectUrl request"));const d=await fetch(p);if(d.status!==200)return i;t=await d.text()}else t=i;r.Events.instance.onEvent(new r.ConnectionRedirectEvent("",t,i,"ConnectionFactoryBase: redirectUrlString"));try{return new URL(t.trim()).toString()}catch{return i}}};return Xt.ConnectionFactoryBase=s,Xt}var Qa;function Mv(){if(Qa)return Qt;Qa=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.DialogConnectionFactory=void 0;const e=z(),r=T(),n=P(),u=K(),s=T(),a=q(),i=re();class t extends u.ConnectionFactoryBase{create(c,p,d){const l=c.parameters.getProperty(n.PropertyId.Conversation_ApplicationId,""),h=c.parameters.getProperty(n.PropertyId.Conversation_DialogType),g=c.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region),f=c.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),S=c.parameters.getProperty(n.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),v={};v[a.HeaderNames.ConnectionId]=d,v[i.QueryParameterNames.Format]=c.parameters.getProperty(r.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple]).toLowerCase(),v[i.QueryParameterNames.Language]=f,v[i.QueryParameterNames.RequestBotStatusMessages]=S,l&&(v[i.QueryParameterNames.BotId]=l,h===n.DialogServiceConfig.DialogTypes.CustomCommands&&(v[a.HeaderNames.CustomCommandsAppId]=l));const m=h===n.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",C=h===n.DialogServiceConfig.DialogTypes.CustomCommands?"v1":h===n.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",y={};p.token!=null&&p.token!==""&&(y[p.headerName]=p.token);let R=c.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,"");if(!R){const w=u.ConnectionFactoryBase.getHostSuffix(g),E=c.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,`wss://${g}.${t.BaseUrl}${w}`);R=`${E.endsWith("/")?E:E+"/"}${m}${t.ApiKey}/${C}`}this.setCommonUrlParams(c,v,R);const I=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(R,v,y,new s.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),I,d))}}return Qt.DialogConnectionFactory=t,t.ApiKey="api",t.BaseUrl="convai.speech",Qt}var Xa;function Ov(){if(Xa)return Gt;Xa=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.DialogServiceConnector=void 0;const e=Mv(),r=T(),n=W(),u=A(),s=_(),a=P(),i=As();let t=class extends a.Recognizer{constructor(c,p){const d=c;s.Contracts.throwIfNull(c,"dialogConfig"),super(p,d.properties,new e.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=d.properties.clone();const l=this.buildAgentConfig();this.privReco.agentConfig.set(l)}connect(c,p){(0,u.marshalPromiseToCallbacks)(this.privReco.connect(),c,p)}disconnect(c,p){(0,u.marshalPromiseToCallbacks)(this.privReco.disconnect(),c,p)}get authorizationToken(){return this.properties.getProperty(i.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){s.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(i.PropertyId.SpeechServiceAuthorization_Token,c)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(i.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(c){this.properties.setProperty(i.PropertyId.Conversation_Speech_Activity_Template,c)}listenOnceAsync(c,p){if(this.isTurnComplete){s.Contracts.throwIfDisposed(this.privIsDisposed);const l=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const h=new u.Deferred;await this.privReco.recognize(n.RecognitionMode.Conversation,h.resolve,h.reject);const g=await h.promise;return await this.implRecognizerStop(),g})();l.catch(()=>{this.dispose(!0).catch(()=>{})}),(0,u.marshalPromiseToCallbacks)(l.finally(()=>{this.isTurnComplete=!0}),c,p)}}sendActivityAsync(c,p,d){(0,u.marshalPromiseToCallbacks)(this.privReco.sendMessage(c),p,d)}close(c,p){s.Contracts.throwIfDisposed(this.privIsDisposed),(0,u.marshalPromiseToCallbacks)(this.dispose(!0),c,p)}async dispose(c){this.privIsDisposed||c&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(c))}createRecognizerConfig(c){return new r.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,p,d,l){const h=d;return new r.DialogServiceAdapter(c,p,h,l,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(i.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(i.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(i.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return Gt.DialogServiceConnector=t,Gt}var Yt={},Za;function Dv(){if(Za)return Yt;Za=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.ActivityReceivedEventArgs=void 0;let e=class{constructor(n,u){this.privActivity=n,this.privAudioStream=u}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}};return Yt.ActivityReceivedEventArgs=e,Yt}var er={},tr={},Ya;function kv(){if(Ya)return tr;Ya=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.TurnStatusResponsePayload=void 0;class e{constructor(n){this.privMessageStatusResponse=JSON.parse(n)}static fromJSON(n){return new e(n)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}return tr.TurnStatusResponsePayload=e,tr}var ec;function zv(){if(ec)return er;ec=1,Object.defineProperty(er,"__esModule",{value:!0}),er.TurnStatusReceivedEventArgs=void 0;const e=kv();let r=class{constructor(u){this.privTurnStatus=e.TurnStatusResponsePayload.fromJSON(u)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}};return er.TurnStatusReceivedEventArgs=r,er}var Mi={},tc;function Nv(){return tc||(tc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ServicePropertyChannel=void 0,function(r){r[r.UriQueryParameter=0]="UriQueryParameter"}(e.ServicePropertyChannel||(e.ServicePropertyChannel={}))}(Mi)),Mi}var Oi={},rc;function jv(){return rc||(rc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProfanityOption=void 0,function(r){r[r.Masked=0]="Masked",r[r.Removed=1]="Removed",r[r.Raw=2]="Raw"}(e.ProfanityOption||(e.ProfanityOption={}))}(Oi)),Oi}var rr={},nc;function qv(){if(nc)return rr;nc=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.BaseAudioPlayer=void 0;const e=J(),r=P(),n=Me();let u=class{constructor(a){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,a===void 0&&(a=r.AudioStreamFormat.getDefaultInputFormat()),this.init(a)}playAudioSample(a,i,t){try{this.ensureInitializedContext();const o=this.formatAudioData(a),c=new Float32Array(this.samples.length+o.length);c.set(this.samples,0),c.set(o,this.samples.length),this.samples=c,i&&i()}catch(o){t&&t(o)}}stopAudio(a,i){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{a&&a()},t=>{i&&i(t)}),this.audioContext=null)}init(a){this.audioFormat=a,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const a=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},a)}}createAudioContext(){this.audioContext=n.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(a){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(a),128);case 16:return this.formatArrayBuffer(new Int16Array(a),32768);case 32:return this.formatArrayBuffer(new Int32Array(a),2147483648);default:throw new e.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(a,i){const t=new Float32Array(a.length);for(let o=0;o<a.length;o++)t[o]=a[o]/i;return t}updateAudioBuffer(){if(this.samples.length===0)return;const a=this.audioFormat.channels,i=this.audioContext.createBufferSource(),t=this.samples.length/a,o=this.audioContext.createBuffer(a,t,this.audioFormat.samplesPerSec);for(let c=0;c<a;c++){let p=c;const d=o.getChannelData(c);for(let l=0;l<this.samples.length;l++,p+=a)d[l]=this.samples[p]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),i.buffer=o,i.connect(this.gainNode),i.start(this.startTime),this.startTime+=o.duration,this.samples=new Float32Array}async playAudio(a){this.audioContext===null&&this.createAudioContext();const i=this.audioContext.createBufferSource(),t=this.audioContext.destination;await this.audioContext.decodeAudioData(a,o=>{i.buffer=o,i.connect(t),i.start(0)})}};return rr.BaseAudioPlayer=u,rr}var nr={},ic;function Lv(){if(ic)return nr;ic=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.ConnectionMessageEventArgs=void 0;let e=class{constructor(n){this.privConnectionMessage=n}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}};return nr.ConnectionMessageEventArgs=e,nr}var ir={},sc;function Bv(){if(sc)return ir;sc=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.VoiceProfile=void 0;let e=class{constructor(n,u){this.privId=n,this.privProfileType=u}get profileId(){return this.privId}get profileType(){return this.privProfileType}};return ir.VoiceProfile=e,ir}var ve={},oc;function Fv(){if(oc)return ve;oc=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.VoiceProfileEnrollmentCancellationDetails=ve.VoiceProfileEnrollmentResult=void 0;const e=T(),r=P();let n=class Cs{constructor(a,i,t){this.privReason=a,this.privProperties=new r.PropertyCollection,this.privReason!==r.ResultReason.Canceled?i&&(this.privDetails=JSON.parse(i),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=r.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=t,this.privProperties.setProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(a){const i=[];for(const t of a.value){const o=t.enrollmentStatus.toLowerCase()==="enrolling"?r.ResultReason.EnrollingVoiceProfile:t.enrollmentStatus.toLowerCase()==="enrolled"?r.ResultReason.EnrolledVoiceProfile:r.ResultReason.Canceled,c=new Cs(o,null,null);c.privDetails=this.getIdentificationDetails(t),i.push(c)}return i}static FromVerificationProfileList(a){const i=[];for(const t of a.value){const o=t.enrollmentStatus.toLowerCase()==="enrolling"?r.ResultReason.EnrollingVoiceProfile:t.enrollmentStatus.toLowerCase()==="enrolled"?r.ResultReason.EnrolledVoiceProfile:r.ResultReason.Canceled,c=new Cs(o,null,null);c.privDetails=this.getVerificationDetails(t),i.push(c)}return i}static getIdentificationDetails(a){return{audioLength:a.audioLength?parseFloat(a.audioLength):0,audioSpeechLength:a.audioSpeechLength?parseFloat(a.audioSpeechLength):0,enrollmentStatus:a.enrollmentStatus,enrollmentsCount:a.enrollmentsCount||0,enrollmentsLength:a.enrollmentsLength?parseFloat(a.enrollmentsLength):0,enrollmentsSpeechLength:a.enrollmentsSpeechLength?parseFloat(a.enrollmentsSpeechLength):0,profileId:a.profileId||a.identificationProfileId,remainingEnrollmentsSpeechLength:a.remainingEnrollmentsSpeechLength?parseFloat(a.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(a){return{audioLength:a.audioLength?parseFloat(a.audioLength):0,audioSpeechLength:a.audioSpeechLength?parseFloat(a.audioSpeechLength):0,enrollmentStatus:a.enrollmentStatus,enrollmentsCount:a.enrollmentsCount,enrollmentsLength:a.enrollmentsLength?parseFloat(a.enrollmentsLength):0,enrollmentsSpeechLength:a.enrollmentsSpeechLength?parseFloat(a.enrollmentsSpeechLength):0,profileId:a.profileId||a.verificationProfileId,remainingEnrollmentsCount:a.remainingEnrollments||a.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:a.remainingEnrollmentsSpeechLength?parseFloat(a.remainingEnrollmentsSpeechLength):0}}};ve.VoiceProfileEnrollmentResult=n;class u extends r.CancellationDetailsBase{constructor(a,i,t){super(a,i,t)}static fromResult(a){const i=r.CancellationReason.Error;let t=r.CancellationErrorCode.NoError;return a.properties&&(t=r.CancellationErrorCode[a.properties.getProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new u(i,a.errorDetails,t)}}return ve.VoiceProfileEnrollmentCancellationDetails=u,ve}var fe={},ac;function xv(){if(ac)return fe;ac=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.VoiceProfileCancellationDetails=fe.VoiceProfileResult=void 0;const e=T(),r=_(),n=P();let u=class{constructor(i,t){this.privReason=i,this.privProperties=new n.PropertyCollection,i===n.ResultReason.Canceled&&(r.Contracts.throwIfNullOrUndefined(t,"statusText"),this.privErrorDetails=t,this.privProperties.setProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};fe.VoiceProfileResult=u;class s extends n.CancellationDetailsBase{constructor(i,t,o){super(i,t,o)}static fromResult(i){const t=n.CancellationReason.Error;let o=n.CancellationErrorCode.NoError;return i.properties&&(o=n.CancellationErrorCode[i.properties.getProperty(e.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.NoError])]),new s(t,i.errorDetails,o)}}return fe.VoiceProfileCancellationDetails=s,fe}var sr={},cc;function Uv(){if(cc)return sr;cc=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.VoiceProfilePhraseResult=void 0;const e=_(),r=P();let n=class extends r.VoiceProfileResult{constructor(s,a,i,t){super(s,a),this.privPhrases=[],e.Contracts.throwIfNullOrUndefined(t,"phrase array"),this.privType=i,t&&t[0]&&(this.privPhrases=t)}get phrases(){return this.privPhrases}get type(){return this.privType}};return sr.VoiceProfilePhraseResult=n,sr}var or={},uc;function Wv(){if(uc)return or;uc=1,Object.defineProperty(or,"__esModule",{value:!0}),or.VoiceProfileClient=void 0;const e=T(),r=od(),n=_(),u=P();let s=class extends u.Recognizer{constructor(i){n.Contracts.throwIfNullOrUndefined(i,"speechConfig");const t=i;n.Contracts.throwIfNull(t,"speechConfig"),super(r.AudioConfig.fromStreamInput(u.AudioInputStream.createPushStream()),t.properties,new e.VoiceProfileConnectionFactory),this.privProperties=t.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(i){n.Contracts.throwIfNullOrWhitespace(i,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,i)}async createProfileAsync(i,t){const o=await this.privVoiceAdapter.createProfile(i,t);return new u.VoiceProfile(o[0],i)}async retrieveEnrollmentResultAsync(i){return this.privVoiceAdapter.retrieveEnrollmentResult(i)}async getAllProfilesAsync(i){return this.privVoiceAdapter.getAllProfiles(i)}async getActivationPhrasesAsync(i,t){return this.privVoiceAdapter.getActivationPhrases(i,t)}async enrollProfileAsync(i,t){const o=t;return n.Contracts.throwIfNullOrUndefined(o,"audioConfig"),this.audioConfig=t,this.privVoiceAdapter.SpeakerAudioSource=o,this.privVoiceAdapter.enrollProfile(i)}async deleteProfileAsync(i){return this.privVoiceAdapter.deleteProfile(i)}async resetProfileAsync(i){return this.privVoiceAdapter.resetProfile(i)}async close(){await this.dispose(!0)}createServiceRecognizer(i,t,o,c){const p=o;return new e.VoiceServiceRecognizer(i,t,p,c,this)}async dispose(i){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,i&&await super.dispose(i))}createRecognizerConfig(i){return new e.RecognizerConfig(i,this.properties)}getResult(i,t){return new u.VoiceProfileResult(i.ok?t:u.ResultReason.Canceled,i.statusText)}};return or.VoiceProfileClient=s,or}var ar={},pc;function Vv(){if(pc)return ar;pc=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.SpeakerRecognizer=void 0;const e=T(),r=_(),n=P();let u=class extends n.Recognizer{constructor(a,i){r.Contracts.throwIfNullOrUndefined(a,"speechConfig");const t=a;r.Contracts.throwIfNullOrUndefined(t,"speechConfig"),super(i,t.properties,new e.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=i,r.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=t.properties}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){r.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,a)}get properties(){return this.privProperties}async recognizeOnceAsync(a){return r.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(a)}async close(){r.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.dispose(!0)}async recognizeSpeakerOnceAsyncImpl(a){r.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.implRecognizerStop();const i=await this.privReco.recognizeSpeaker(a);return await this.implRecognizerStop(),i}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}createRecognizerConfig(a){return new e.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,i,t,o){const c=t;return new e.SpeakerServiceRecognizer(a,i,c,o,this)}async dispose(a){this.privDisposedSpeakerRecognizer||a&&(this.privDisposedSpeakerRecognizer=!0,await super.dispose(a))}};return ar.SpeakerRecognizer=u,ar}var cr={},dc;function Hv(){if(dc)return cr;dc=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.SpeakerIdentificationModel=void 0;const e=_(),r=P();let n=class yd{constructor(s){if(this.privVoiceProfiles=[],this.privProfileIds=[],e.Contracts.throwIfNullOrUndefined(s,"VoiceProfiles"),s.length===0)throw new Error("Empty Voice Profiles array");for(const a of s){if(a.profileType!==r.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+a.profileId);this.privVoiceProfiles.push(a),this.privProfileIds.push(a.profileId)}}static fromProfiles(s){return new yd(s)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}};return cr.SpeakerIdentificationModel=n,cr}var ur={},hc;function $v(){if(hc)return ur;hc=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.SpeakerVerificationModel=void 0;const e=_(),r=P();let n=class Rd{constructor(s){if(e.Contracts.throwIfNullOrUndefined(s,"VoiceProfile"),s.profileType===r.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=s}static fromProfile(s){return new Rd(s)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===r.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}};return ur.SpeakerVerificationModel=n,ur}var pr={},Di={},lc;function Pd(){return lc||(lc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdMode=void 0,function(r){r[r.AtStart=0]="AtStart",r[r.Continuous=1]="Continuous"}(e.LanguageIdMode||(e.LanguageIdMode={}))}(Di)),Di}var vc;function Kv(){if(vc)return pr;vc=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.AutoDetectSourceLanguageConfig=void 0;const e=T(),r=_(),n=P(),u=Pd();let s=class $n{constructor(){this.privProperties=new n.PropertyCollection,this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=u.LanguageIdMode.AtStart}static fromOpenRange(){const i=new $n;return i.properties.setProperty(n.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,e.AutoDetectSourceLanguagesOpenRangeOptionName),i.properties.setProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),i}static fromLanguages(i){r.Contracts.throwIfArrayEmptyOrWhitespace(i,"languages");const t=new $n;return t.properties.setProperty(n.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,i.join()),t}static fromSourceLanguageConfigs(i){if(i.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const t=new $n,o=[];return i.forEach(c=>{if(o.push(c.language),c.endpointId!==void 0&&c.endpointId!==""){const p=c.language+n.PropertyId.SpeechServiceConnection_EndpointId.toString();t.properties.setProperty(p,c.endpointId)}}),t.properties.setProperty(n.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,o.join()),t}get properties(){return this.privProperties}set mode(i){i===u.LanguageIdMode.Continuous?(this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(n.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=i}};return pr.AutoDetectSourceLanguageConfig=s,pr}var dr={},fc;function Jv(){if(fc)return dr;fc=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.AutoDetectSourceLanguageResult=void 0;const e=_();let r=class ys{constructor(u,s){e.Contracts.throwIfNullOrUndefined(u,"language"),e.Contracts.throwIfNullOrUndefined(s,"languageDetectionConfidence"),this.privLanguage=u,this.privLanguageDetectionConfidence=s}static fromResult(u){return new ys(u.language,u.languageDetectionConfidence)}static fromConversationTranscriptionResult(u){return new ys(u.language,u.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}};return dr.AutoDetectSourceLanguageResult=r,dr}var hr={},gc;function Gv(){if(gc)return hr;gc=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.SourceLanguageConfig=void 0;const e=_();let r=class Ed{constructor(u,s){e.Contracts.throwIfNullOrUndefined(u,"language"),this.privLanguage=u,this.privEndpointId=s}static fromLanguage(u,s){return new Ed(u,s)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}};return hr.SourceLanguageConfig=r,hr}var ki={},Sc;function Qv(){return Sc||(Sc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeakerRecognitionCancellationDetails=e.SpeakerRecognitionResult=e.SpeakerRecognitionResultType=void 0;const r=T(),n=P();var u;(function(i){i[i.Verify=0]="Verify",i[i.Identify=1]="Identify"})(u=e.SpeakerRecognitionResultType||(e.SpeakerRecognitionResultType={}));class s{constructor(t,o=n.ResultReason.RecognizedSpeaker,c=n.CancellationErrorCode.NoError,p=""){this.privProperties=new n.PropertyCollection;const d=t.scenario==="TextIndependentIdentification"?u.Identify:u.Verify;this.privReason=o,this.privReason!==n.ResultReason.Canceled?d===u.Identify?(this.privProfileId=t.identificationResult.identifiedProfile.profileId,this.privScore=t.identificationResult.identifiedProfile.score,this.privReason=n.ResultReason.RecognizedSpeakers):(this.privScore=t.verificationResult.score,t.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=n.ResultReason.NoMatch),t.verificationResult.profileId!==void 0&&t.verificationResult.profileId!==""&&(this.privProfileId=t.verificationResult.profileId)):(this.privErrorDetails=p,this.privProperties.setProperty(r.CancellationErrorCodePropertyName,n.CancellationErrorCode[c])),this.privProperties.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(t))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}e.SpeakerRecognitionResult=s;class a extends n.CancellationDetailsBase{constructor(t,o,c){super(t,o,c)}static fromResult(t){const o=n.CancellationReason.Error;let c=n.CancellationErrorCode.NoError;return t.properties&&(c=n.CancellationErrorCode[t.properties.getProperty(r.CancellationErrorCodePropertyName,n.CancellationErrorCode[n.CancellationErrorCode.NoError])]),new a(o,t.errorDetails,c)}}e.SpeakerRecognitionCancellationDetails=a}(ki)),ki}var zi={},ge={},mc;function Id(){if(mc)return ge;mc=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.ConversationImpl=ge.Conversation=void 0;const e=T(),r=A(),n=_(),u=P();let s=class{constructor(){}static createConversationAsync(t,o,c,p){n.Contracts.throwIfNullOrUndefined(t,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),n.Contracts.throwIfNullOrUndefined(t.region,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!t.subscriptionKey&&!t.getProperty(u.PropertyId[u.PropertyId.SpeechServiceAuthorization_Token])&&n.Contracts.throwIfNullOrUndefined(t.subscriptionKey,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let d,l,h;return typeof o=="string"?(d=new a(t,o),(0,r.marshalPromiseToCallbacks)((async()=>{})(),c,p)):(d=new a(t),l=o,h=c,d.createConversationAsync(()=>{l&&l()},g=>{h&&h(g)})),d}};ge.Conversation=s;class a extends s{constructor(t,o){if(super(),this.privErrors=e.ConversationConnectionConfig.restErrors,this.onConnected=d=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,d)}catch{}},this.onDisconnected=d=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,d)}catch{}finally{this.close(!1)}},this.onCanceled=(d,l)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,l)}catch{}},this.onParticipantUpdateCommandReceived=(d,l)=>{try{const h=this.privParticipants.getParticipant(l.id);if(h!==void 0){switch(l.key){case e.ConversationTranslatorCommandTypes.changeNickname:h.displayName=l.value;break;case e.ConversationTranslatorCommandTypes.setUseTTS:h.isUsingTts=l.value;break;case e.ConversationTranslatorCommandTypes.setProfanityFiltering:h.profanity=l.value;break;case e.ConversationTranslatorCommandTypes.setMute:h.isMuted=l.value;break;case e.ConversationTranslatorCommandTypes.setTranslateToLanguages:h.translateToLanguages=l.value;break}this.privParticipants.addOrUpdateParticipant(h),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,[this.toParticipant(h)],l.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(d,l)=>{try{this.privParticipants.participants.forEach(h=>h.isMuted=h.isHost?!1:l.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,this.toParticipants(!1),l.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(d,l)=>{try{const h=this.privParticipants.addOrUpdateParticipant(l.participant);h!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,[this.toParticipant(h)],l.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(d,l)=>{try{const h=this.privParticipants.getParticipant(l.participant.id);h!==void 0&&(this.privParticipants.deleteParticipant(l.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.LeftConversation,[this.toParticipant(h)],l.sessionId)))}catch{}},this.onTranslationReceived=(d,l)=>{try{switch(l.command){case e.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break;case e.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break;case e.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break}}catch{}},this.onParticipantsListReceived=(d,l)=>{try{if(l.sessionToken!==void 0&&l.sessionToken!==null&&(this.privRoom.token=l.sessionToken),this.privParticipants.participants=[...l.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),l.sessionId)),this.me.isHost){const h=this.privConversationTranslator?.properties.getProperty(u.PropertyId.ConversationTranslator_Name);h!==void 0&&h.length>0&&h!==this.me.displayName&&this.changeNicknameAsync(h)}}catch{}},this.onConversationExpiration=(d,l)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,l)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new u.PropertyCollection,this.privManager=new e.ConversationManager,t.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])||t.setProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage],e.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=t.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),o)this.privConversationId=o;else{t.targetLanguages.length===0&&t.addTargetLanguage(this.privLanguage),t.getProperty(u.PropertyId[u.PropertyId.SpeechServiceResponse_ProfanityOption])||t.setProfanity(u.ProfanityOption.Masked);let l=t.getProperty(u.PropertyId[u.PropertyId.ConversationTranslator_Name]);l==null&&(l="Host"),n.Contracts.throwIfNullOrTooLong(l,"nickname",50),n.Contracts.throwIfNullOrTooShort(l,"nickname",2),t.setProperty(u.PropertyId[u.PropertyId.ConversationTranslator_Name],l)}this.privConfig=t;const p=t;n.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new e.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const t=this.conversationId,o=this.participants.map(d=>({id:d.id,preferredLanguage:d.preferredLanguage,voice:d.voice})),c={};for(const d of e.ConversationConnectionConfig.transcriptionEventKeys){const l=this.properties.getProperty(d,"");l!==""&&(c[d]=l)}return{id:t,participants:o,conversationProperties:c}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(t){n.Contracts.throwIfNullOrWhitespace(t,"authorizationToken"),this.privToken=t}set conversationTranslator(t){this.privConversationTranslator=t}onToken(t){this.privConversationTranslator.onToken(t)}createConversationAsync(t,o){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o),this.privManager.createOrJoin(this.privProperties,void 0,c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),o),this.privRoom=c,this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}startConversationAsync(t,o){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=e.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}addParticipantAsync(t,o,c){n.Contracts.throwIfNullOrUndefined(t,"Participant"),(0,r.marshalPromiseToCallbacks)(this.addParticipantImplAsync(t),o,c)}joinConversationAsync(t,o,c,p,d){try{n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","conversationId")),n.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","nickname")),n.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,t,l=>{n.Contracts.throwIfNullOrUndefined(l,this.privErrors.permissionDeniedConnect),this.privRoom=l,this.privConfig.authorizationToken=l.cognitiveSpeechAuthToken,p&&p(l.cognitiveSpeechAuthToken)},l=>{this.handleError(l,d)})}catch(l){this.handleError(l,d)}}deleteConversationAsync(t,o){(0,r.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(),t,o)}async deleteConversationImplAsync(){n.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),n.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(t,o){(0,r.marshalPromiseToCallbacks)(this.endConversationImplAsync(),t,o)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(t,o){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}muteAllParticipantsAsync(t,o){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}muteParticipantAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","userId")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==t&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(t)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(t,!0),()=>{this.handleCallback(o,c)},d=>{this.handleError(d,c)})}catch(p){this.handleError(p,c)}}removeParticipantAsync(t,o,c){try{if(n.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&t.hasOwnProperty("id"))(0,r.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(t),o,c);else{n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let p="";typeof t=="string"?p=t:t.hasOwnProperty("id")?p=t.id:t.hasOwnProperty("userId")&&(p=t.userId),n.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(l=>l.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),()=>{this.handleCallback(o,c)},l=>{this.handleError(l,c)})}}catch(p){this.handleError(p,c)}}unlockConversationAsync(t,o){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}unmuteAllParticipantsAsync(t,o){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}unmuteParticipantAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","userId")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==t&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(t)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(t,!1),()=>{this.handleCallback(o,c)},d=>{this.handleError(d,c)})}catch(p){this.handleError(p,c)}}sendTextMessageAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","message")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),t.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(t),()=>{this.handleCallback(o,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}setTranslatedLanguagesAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfArrayEmptyOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","languages")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(t),()=>{this.handleCallback(o,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}changeNicknameAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(t),()=>{this.handleCallback(o,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(t){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await t.enforceAudioGating(),this.privTranscriberRecognizer=t,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const t=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:t,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(t){if(this.privParticipants.addOrUpdateParticipant(t)!==void 0&&this.privTranscriberRecognizer){const c=this.conversationInfo;return c.participants=[t],this.privTranscriberRecognizer.pushConversationEvent(c,"join")}}removeParticipantImplAsync(t){this.privParticipants.deleteParticipant(t.id);const o=this.conversationInfo;return o.participants=[t],this.privTranscriberRecognizer.pushConversationEvent(o,"leave")}async close(t){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(o){throw o}t&&this.dispose()}handleCallback(t,o){if(t){try{t()}catch(c){o&&o(c)}t=void 0}}handleError(t,o){if(o)if(t instanceof Error){const c=t;o(c.name+": "+c.message)}else o(t)}toParticipants(t){const o=this.privParticipants.participants.map(c=>this.toParticipant(c));return t?o:o.filter(c=>c.isHost===!1)}toParticipant(t){return new u.Participant(t.id,t.avatar,t.displayName,t.isHost,t.isMuted,t.isUsingTts,t.preferredLanguage,t.voice)}getMuteAllCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:t})}getMuteCommand(t,o){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),n.Contracts.throwIfNullOrWhitespace(t,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMute,participantId:t,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getLockCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:t})}getEjectCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),n.Contracts.throwIfNullOrWhitespace(t,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.ejectParticipant,participantId:t,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:t})}getChangeNicknameCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),n.Contracts.throwIfNullOrWhitespace(t,"nickname"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.changeNickname,nickname:t,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:t})}getMessageCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),n.Contracts.throwIfNullOrWhitespace(t,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:t,type:e.ConversationTranslatorMessageTypes.instantMessage})}}return ge.ConversationImpl=a,ge}var lr={},Cc;function Xv(){if(Cc)return lr;Cc=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.ConversationCommon=void 0;let e=class{constructor(n){this.privAudioConfig=n}handleCallback(n,u){if(n){try{n()}catch(s){u&&u(s)}n=void 0}}handleError(n,u){if(u)if(n instanceof Error){const s=n;u(s.name+": "+s.message)}else u(n)}};return lr.ConversationCommon=e,lr}var vr={},yc;function Zv(){if(yc)return vr;yc=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.ConversationExpirationEventArgs=void 0;const e=P();let r=class extends e.SessionEventArgs{constructor(u,s){super(s),this.privExpirationTime=u}get expirationTime(){return this.privExpirationTime}};return vr.ConversationExpirationEventArgs=r,vr}var fr={},Rc;function Yv(){if(Rc)return fr;Rc=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.ConversationParticipantsChangedEventArgs=void 0;const e=P();let r=class extends e.SessionEventArgs{constructor(u,s,a){super(a),this.privReason=u,this.privParticipant=s}get reason(){return this.privReason}get participants(){return this.privParticipant}};return fr.ConversationParticipantsChangedEventArgs=r,fr}var gr={},Pc;function ef(){if(Pc)return gr;Pc=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.ConversationTranslationCanceledEventArgs=void 0;const e=Vn();let r=class extends e.CancellationEventArgsBase{};return gr.ConversationTranslationCanceledEventArgs=r,gr}var Sr={},Ec;function tf(){if(Ec)return Sr;Ec=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.ConversationTranslationEventArgs=void 0;const e=P();let r=class extends e.RecognitionEventArgs{constructor(u,s,a){super(s,a),this.privResult=u}get result(){return this.privResult}};return Sr.ConversationTranslationEventArgs=r,Sr}var mr={},Ic;function rf(){if(Ic)return mr;Ic=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.ConversationTranslationResult=void 0;const e=cd();let r=class extends e.TranslationRecognitionResult{constructor(u,s,a,i,t,o,c,p,d,l,h){super(s,i,t,o,c,p,void 0,void 0,d,l,h),this.privId=u,this.privOrigLang=a}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return mr.ConversationTranslationResult=r,mr}var Ni={},Cr={},yr={},Tc;function Td(){if(Tc)return yr;Tc=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.StringUtils=void 0;let e=class{static formatString(n,u){if(!n)return"";if(!u)return n;let s="",a="";const i=c=>{s+=c},t=c=>{a+=c};let o=i;for(let c=0;c<n.length;c++){const p=n[c],d=c+1<n.length?n[c+1]:"";switch(p){case"{":d==="{"?(o("{"),c++):o=t;break;case"}":d==="}"?(o("}"),c++):(u.hasOwnProperty(a)&&(s+=u[a]),o=i,a="");break;default:o(p);break}}return s}};return yr.StringUtils=e,yr}var Ac;function nf(){if(Ac)return Cr;Ac=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.ConversationTranslatorConnectionFactory=void 0;const e=z(),r=Td(),n=_(),u=P(),s=q(),a=re(),i=K(),t=T();let o=class Ad extends i.ConnectionFactoryBase{constructor(p){super(),n.Contracts.throwIfNullOrUndefined(p,"convGetter"),this.privConvGetter=p}create(p,d,l){const h=p.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",g=this.privConvGetter().room,f=g.cognitiveSpeechRegion||p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Region,""),S={hostSuffix:i.ConnectionFactoryBase.getHostSuffix(f),path:Ad.CTS_VIRT_MIC_PATH,region:encodeURIComponent(f)};S[a.QueryParameterNames.Language]=encodeURIComponent(p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage,"")),S[a.QueryParameterNames.CtsMeetingId]=encodeURIComponent(g.roomId),S[a.QueryParameterNames.CtsDeviceId]=encodeURIComponent(g.participantId),S[a.QueryParameterNames.CtsIsParticipant]=g.isHost?"":"&"+a.QueryParameterNames.CtsIsParticipant;let v="";const m={},C={};if(h){v=p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Endpoint),v||(v="wss://"+p.parameters.getProperty(u.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),v=r.StringUtils.formatString(v,S);const R=new URL(v);R.searchParams.forEach((w,E)=>{m[E]=w}),new t.TranscriberConnectionFactory().setQueryParams(m,p,v),m[a.QueryParameterNames.CtsMeetingId]=S[a.QueryParameterNames.CtsMeetingId],m[a.QueryParameterNames.CtsDeviceId]=S[a.QueryParameterNames.CtsDeviceId],g.isHost||(m[a.QueryParameterNames.CtsIsParticipant]=""),a.QueryParameterNames.Format in m||(m[a.QueryParameterNames.Format]="simple"),R.searchParams.forEach((w,E)=>{R.searchParams.set(E,m[E]),delete m[E]}),v=R.toString()}else{const R=new t.TranslationConnectionFactory;v=R.getEndpointUrl(p,!0),v=r.StringUtils.formatString(v,S),R.setQueryParams(m,p,v)}C[s.HeaderNames.ConnectionId]=l,C[e.RestConfigBase.configParams.token]=g.token,d.token&&(C[d.headerName]=d.token);const y=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return Promise.resolve(new e.WebsocketConnection(v,m,C,new t.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),y,l))}};return Cr.ConversationTranslatorConnectionFactory=o,o.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",Cr}var wc;function sf(){return wc||(wc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranslator=e.SpeechState=void 0;const r=T(),n=nf(),u=A(),s=_(),a=P(),i=Id(),t=_s();var o;(function(d){d[d.Inactive=0]="Inactive",d[d.Connecting=1]="Connecting",d[d.Connected=2]="Connected"})(o=e.SpeechState||(e.SpeechState={}));class c extends a.TranslationRecognizer{constructor(l,h,g,f){super(l,h,new n.ConversationTranslatorConnectionFactory(f)),this.privSpeechState=o.Inactive,g&&(this.privTranslator=g,this.sessionStarted=()=>{this.privSpeechState=o.Connected},this.sessionStopped=()=>{this.privSpeechState=o.Inactive},this.recognizing=(S,v)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,v)},this.recognized=async(S,v)=>{v.result?.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(v.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,v)},this.canceled=async()=>{if(this.privSpeechState!==o.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=o.Inactive}})}get state(){return this.privSpeechState}set state(l){this.privSpeechState=l}set authentication(l){this.privReco.authentication=l}onConnection(){this.privSpeechState=o.Connected}async onCancelSpeech(){this.privSpeechState=o.Inactive,await this.cancelSpeech()}fireCancelEvent(l){try{if(this.privTranslator.canceled){const h=new t.ConversationTranslationCanceledEventArgs(a.CancellationReason.Error,l,a.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,h)}}catch{}}async cancelSpeech(){try{this.stopContinuousRecognitionAsync(),await this.privReco?.disconnect(),this.privSpeechState=o.Inactive}catch{}}}class p extends t.ConversationCommon{constructor(l){super(l),this.privErrors=r.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new a.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){return this.privConversation?.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===o.Connected||this.privCTRecognizer.state===o.Connecting||this.privConversation.isMutedByHost)}onToken(l){this.privCTRecognizer.authentication=l}setServiceProperty(l,h){const g=JSON.parse(this.privProperties.getProperty(r.ServicePropertiesPropertyName,"{}"));g[l]=h,this.privProperties.setProperty(r.ServicePropertiesPropertyName,JSON.stringify(g))}joinConversationAsync(l,h,g,f,S){try{if(typeof l=="string"){s.Contracts.throwIfNullOrUndefined(l,this.privErrors.invalidArgs.replace("{arg}","conversation id")),s.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),S);let v=g;(v==null||v==="")&&(v=r.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=a.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(a.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(v),this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage],v),this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.ConversationTranslator_Name],h);const m=[a.PropertyId.SpeechServiceConnection_Host,a.PropertyId.ConversationTranslator_Host,a.PropertyId.SpeechServiceConnection_Endpoint,a.PropertyId.SpeechServiceConnection_ProxyHostName,a.PropertyId.SpeechServiceConnection_ProxyPassword,a.PropertyId.SpeechServiceConnection_ProxyPort,a.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const y of m){const R=this.privProperties.getProperty(y);if(R){const I=typeof y=="string"?y:a.PropertyId[y];this.privSpeechTranslationConfig.setProperty(I,R)}}const C=JSON.parse(this.privProperties.getProperty(r.ServicePropertiesPropertyName,"{}"));for(const y of Object.keys(C))this.privSpeechTranslationConfig.setServiceProperty(y,C[y],a.ServicePropertyChannel.UriQueryParameter);this.privConversation=new i.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(l,h,v,y=>{y||this.handleError(new Error(this.privErrors.permissionDeniedConnect),S),this.privSpeechTranslationConfig.authorizationToken=y,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(f,S)},R=>{this.handleError(R,S)})},y=>{this.handleError(y,S)})}else typeof l=="object"?(s.Contracts.throwIfNullOrUndefined(l,this.privErrors.invalidArgs.replace("{arg}","conversation id")),s.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(a.PropertyId.ConversationTranslator_Name,h),this.privConversation=l,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,s.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),s.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=l.config,this.handleCallback(g,f)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),f)}catch(v){this.handleError(v,typeof g=="string"?S:f)}}leaveConversationAsync(l,h){(0,u.marshalPromiseToCallbacks)((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),l,h)}sendTextMessageAsync(l,h,g){try{s.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),s.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}",l)),this.privConversation.sendTextMessageAsync(l,h,g)}catch(f){this.handleError(f,g)}}startTranscribingAsync(l,h){(0,u.marshalPromiseToCallbacks)((async()=>{try{s.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),s.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),s.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),h),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(g){throw this.privIsSpeaking=!1,await this.cancelSpeech(),g}})(),l,h)}stopTranscribingAsync(l,h){(0,u.marshalPromiseToCallbacks)((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((g,f)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(g,f)})}catch{await this.cancelSpeech()}})(),l,h)}isDisposed(){return this.privIsDisposed}dispose(l,h,g){(0,u.marshalPromiseToCallbacks)((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),h,g)}async cancelSpeech(){try{this.privIsSpeaking=!1,await this.privCTRecognizer?.onCancelSpeech(),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=a.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key],"");const l=()=>this.privConversation;this.privCTRecognizer=new c(this.privSpeechTranslationConfig,this.privAudioConfig,this,l)}catch(l){throw await this.cancelSpeech(),l}}startContinuousRecognition(){return new Promise((l,h)=>{this.privCTRecognizer.startContinuousRecognitionAsync(l,h)})}}e.ConversationTranslator=p}(Ni)),Ni}var Rr={},_c;function of(){if(_c)return Rr;_c=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.ConversationTranscriber=void 0;const e=T(),r=W(),n=A(),u=_(),s=P();let a=class wd extends s.Recognizer{constructor(t,o){const c=t;u.Contracts.throwIfNull(c,"speechConfig"),u.Contracts.throwIfNullOrWhitespace(c.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage),s.PropertyId[s.PropertyId.SpeechServiceConnection_RecoLanguage]),super(o,c.properties,new e.ConversationTranscriberConnectionFactory,t.tokenCredential),this.privProperties.setProperty(s.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(t,o,c){const p=t;return o.properties.mergeTo(p.properties),new wd(t,c)}get endpointId(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(s.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(t){u.Contracts.throwIfNullOrWhitespace(t,"token"),this.properties.setProperty(s.PropertyId.SpeechServiceAuthorization_Token,t)}get speechRecognitionLanguage(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return u.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(e.OutputFormatPropertyName,s.OutputFormat[s.OutputFormat.Simple])===s.OutputFormat[s.OutputFormat.Simple]?s.OutputFormat.Simple:s.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(t,o){(0,n.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(r.RecognitionMode.Conversation),t,o)}stopTranscribingAsync(t,o){(0,n.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),t,o)}close(t,o){u.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,n.marshalPromiseToCallbacks)(this.dispose(!0),t,o)}async dispose(t){this.privDisposedRecognizer||(t&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(t))}createRecognizerConfig(t){return new e.RecognizerConfig(t,this.privProperties)}createServiceRecognizer(t,o,c,p){const d=c;return p.isSpeakerDiarizationEnabled=!0,new e.ConversationTranscriptionServiceRecognizer(t,o,d,p,this)}};return Rr.ConversationTranscriber=a,Rr}var Se={},bc;function af(){if(bc)return Se;bc=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.Participant=Se.User=void 0;const e=P();class r{constructor(s){this.privUserId=s}get userId(){return this.privUserId}}Se.User=r;class n{constructor(s,a,i,t,o,c,p,d){this.privId=s,this.privAvatar=a,this.privDisplayName=i,this.privIsHost=t,this.privIsMuted=o,this.privIsUsingTts=c,this.privPreferredLanguage=p,this.privVoice=d,this.privProperties=new e.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(s,a,i){return new n(s,"",s,!1,!1,!1,a,i)}}return Se.Participant=n,Se}var ji={},Mc;function cf(){return Mc||(Mc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ParticipantChangedReason=void 0,function(r){r[r.JoinedConversation=0]="JoinedConversation",r[r.LeftConversation=1]="LeftConversation",r[r.Updated=2]="Updated"}(e.ParticipantChangedReason||(e.ParticipantChangedReason={}))}(ji)),ji}var me={},Oc;function uf(){if(Oc)return me;Oc=1,Object.defineProperty(me,"__esModule",{value:!0}),me.MeetingImpl=me.Meeting=void 0;const e=T(),r=A(),n=_(),u=P();let s=class{constructor(){}static createMeetingAsync(t,o,c,p){if(n.Contracts.throwIfNullOrUndefined(t,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),n.Contracts.throwIfNullOrUndefined(t.region,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),n.Contracts.throwIfNull(o,"meetingId"),o.length===0)throw new Error("meetingId cannot be empty");!t.subscriptionKey&&!t.getProperty(u.PropertyId[u.PropertyId.SpeechServiceAuthorization_Token])&&n.Contracts.throwIfNullOrUndefined(t.subscriptionKey,e.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const d=new a(t,o);return(0,r.marshalPromiseToCallbacks)((async()=>{})(),c,p),d}};me.Meeting=s;class a extends s{constructor(t,o){super(),this.privErrors=e.ConversationConnectionConfig.restErrors,this.onConnected=d=>{this.privIsConnected=!0;try{this.privConversationTranslator?.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,d)}catch{}},this.onDisconnected=d=>{try{this.privConversationTranslator?.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,d)}catch{}finally{this.close(!1)}},this.onCanceled=(d,l)=>{try{this.privConversationTranslator?.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,l)}catch{}},this.onParticipantUpdateCommandReceived=(d,l)=>{try{const h=this.privParticipants.getParticipant(l.id);if(h!==void 0){switch(l.key){case e.ConversationTranslatorCommandTypes.changeNickname:h.displayName=l.value;break;case e.ConversationTranslatorCommandTypes.setUseTTS:h.isUsingTts=l.value;break;case e.ConversationTranslatorCommandTypes.setProfanityFiltering:h.profanity=l.value;break;case e.ConversationTranslatorCommandTypes.setMute:h.isMuted=l.value;break;case e.ConversationTranslatorCommandTypes.setTranslateToLanguages:h.translateToLanguages=l.value;break}this.privParticipants.addOrUpdateParticipant(h),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,[this.toParticipant(h)],l.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(d,l)=>{try{this.privParticipants.participants.forEach(h=>h.isMuted=h.isHost?!1:l.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.Updated,this.toParticipants(!1),l.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(d,l)=>{try{const h=this.privParticipants.addOrUpdateParticipant(l.participant);h!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,[this.toParticipant(h)],l.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(d,l)=>{try{const h=this.privParticipants.getParticipant(l.participant.id);h!==void 0&&(this.privParticipants.deleteParticipant(l.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.LeftConversation,[this.toParticipant(h)],l.sessionId)))}catch{}},this.onTranslationReceived=(d,l)=>{try{switch(l.command){case e.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break;case e.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break;case e.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new u.ConversationTranslationEventArgs(l.payload,void 0,l.sessionId));break}}catch{}},this.onParticipantsListReceived=(d,l)=>{try{if(l.sessionToken!==void 0&&l.sessionToken!==null&&(this.privRoom.token=l.sessionToken),this.privParticipants.participants=[...l.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new u.ConversationParticipantsChangedEventArgs(u.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),l.sessionId)),this.me.isHost){const h=this.privConversationTranslator?.properties.getProperty(u.PropertyId.ConversationTranslator_Name);h!==void 0&&h.length>0&&h!==this.me.displayName&&this.changeNicknameAsync(h)}}catch{}},this.onConversationExpiration=(d,l)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,l)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new u.PropertyCollection,this.privManager=new e.ConversationManager,t.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage])||t.setProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage],e.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=t.getProperty(u.PropertyId[u.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=o,this.privConfig=t;const p=t;n.Contracts.throwIfNull(p,"speechConfig"),this.privProperties=p.properties.clone(),this.privIsConnected=!1,this.privParticipants=new e.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){return this.privParticipants.me?.isHost?!1:this.privParticipants.me?.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const t=this.meetingId,o=this.participants.map(d=>({id:d.id,preferredLanguage:d.preferredLanguage,voice:d.voice})),c={};for(const d of e.ConversationConnectionConfig.transcriptionEventKeys){const l=this.properties.getProperty(d,"");l!==""&&(c[d]=l)}return{id:t,participants:o,meetingProperties:c}}get canSend(){return this.privIsConnected&&!this.privParticipants.me?.isMuted}get canSendAsHost(){return this.privIsConnected&&this.privParticipants.me?.isHost}get authorizationToken(){return this.privToken}set authorizationToken(t){n.Contracts.throwIfNullOrWhitespace(t,"authorizationToken"),this.privToken=t}createMeetingAsync(t,o){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o),this.privManager.createOrJoin(this.privProperties,void 0,c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),o),this.privRoom=c,this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}startMeetingAsync(t,o){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),o),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}addParticipantAsync(t,o,c){n.Contracts.throwIfNullOrUndefined(t,"Participant"),(0,r.marshalPromiseToCallbacks)(this.addParticipantImplAsync(t),o,c)}joinMeetingAsync(t,o,c,p,d){try{n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","conversationId")),n.Contracts.throwIfNullOrWhitespace(o,this.privErrors.invalidArgs.replace("{arg}","nickname")),n.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,t,l=>{n.Contracts.throwIfNullOrUndefined(l,this.privErrors.permissionDeniedConnect),this.privRoom=l,this.privConfig.authorizationToken=l.cognitiveSpeechAuthToken,p&&p(l.cognitiveSpeechAuthToken)},l=>{this.handleError(l,d)})}catch(l){this.handleError(l,d)}}deleteMeetingAsync(t,o){(0,r.marshalPromiseToCallbacks)(this.deleteMeetingImplAsync(),t,o)}async deleteMeetingImplAsync(){n.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),n.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(t,o){(0,r.marshalPromiseToCallbacks)(this.endMeetingImplAsync(),t,o)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(t,o){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}muteAllParticipantsAsync(t,o){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}muteParticipantAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","userId")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==t&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(t)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(t,!0),()=>{this.handleCallback(o,c)},d=>{this.handleError(d,c)})}catch(p){this.handleError(p,c)}}removeParticipantAsync(t,o,c){try{if(n.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&t.hasOwnProperty("id"))(0,r.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(t),o,c);else{n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let p="";typeof t=="string"?p=t:t.hasOwnProperty("id")?p=t.id:t.hasOwnProperty("userId")&&(p=t.userId),n.Contracts.throwIfNullOrWhitespace(p,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(l=>l.id===p)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(p),()=>{this.handleCallback(o,c)},l=>{this.handleError(l,c)})}}catch(p){this.handleError(p,c)}}unlockMeetingAsync(t,o){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}unmuteAllParticipantsAsync(t,o){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),o),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(t,o)},c=>{this.handleError(c,o)})}catch(c){this.handleError(c,o)}}unmuteParticipantAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","userId")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==t&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(t)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(t,!1),()=>{this.handleCallback(o,c)},d=>{this.handleError(d,c)})}catch(p){this.handleError(p,c)}}sendTextMessageAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","message")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),t.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(t),()=>{this.handleCallback(o,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}setTranslatedLanguagesAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfArrayEmptyOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","languages")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(t),()=>{this.handleCallback(o,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}changeNicknameAsync(t,o,c){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),n.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","nickname")),n.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(t),()=>{this.handleCallback(o,c)},p=>{this.handleError(p,c)})}catch(p){this.handleError(p,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(t){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await t.enforceAudioGating(),this.privTranscriberRecognizer=t,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const t=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:t,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(t){if(this.privParticipants.addOrUpdateParticipant(t)!==void 0&&this.privTranscriberRecognizer){const c=this.meetingInfo;return c.participants=[t],this.privTranscriberRecognizer.pushMeetingEvent(c,"join")}}removeParticipantImplAsync(t){this.privParticipants.deleteParticipant(t.id);const o=this.meetingInfo;return o.participants=[t],this.privTranscriberRecognizer.pushMeetingEvent(o,"leave")}async close(t){try{this.privIsConnected=!1,await this.privConversationRecognizer?.close(),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(o){throw o}t&&this.dispose()}handleCallback(t,o){if(t){try{t()}catch(c){o&&o(c)}t=void 0}}handleError(t,o){if(o)if(t instanceof Error){const c=t;o(c.name+": "+c.message)}else o(t)}toParticipants(t){const o=this.privParticipants.participants.map(c=>this.toParticipant(c));return t?o:o.filter(c=>c.isHost===!1)}toParticipant(t){return new u.Participant(t.id,t.avatar,t.displayName,t.isHost,t.isMuted,t.isUsingTts,t.preferredLanguage,t.voice)}getMuteAllCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:t})}getMuteCommand(t,o){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),n.Contracts.throwIfNullOrWhitespace(t,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setMute,participantId:t,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:o})}getLockCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:t})}getEjectCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),n.Contracts.throwIfNullOrWhitespace(t,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.ejectParticipant,participantId:t,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:t})}getChangeNicknameCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),n.Contracts.throwIfNullOrWhitespace(t,"nickname"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:e.ConversationTranslatorCommandTypes.changeNickname,nickname:t,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:e.ConversationTranslatorMessageTypes.participantCommand,value:t})}getMessageCommand(t){return n.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),n.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),n.Contracts.throwIfNullOrWhitespace(t,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:t,type:e.ConversationTranslatorMessageTypes.instantMessage})}}return me.MeetingImpl=a,me}var Pr={},Dc;function pf(){if(Dc)return Pr;Dc=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.MeetingTranscriptionCanceledEventArgs=void 0;const e=Vn();class r extends e.CancellationEventArgsBase{}return Pr.MeetingTranscriptionCanceledEventArgs=r,Pr}var Er={},kc;function df(){if(kc)return Er;kc=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.MeetingTranscriber=void 0;const e=T(),r=A(),n=_(),u=P(),s=_s();let a=class{constructor(t){this.privAudioConfig=t,this.privProperties=new u.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return n.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(u.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return u.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(t){n.Contracts.throwIfNullOrWhitespace(t,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,t)}joinMeetingAsync(t,o,c){const p=t;n.Contracts.throwIfNullOrUndefined(s.MeetingImpl,"Meeting"),this.privRecognizer=new e.TranscriberRecognizer(t.config,this.privAudioConfig),n.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),(0,r.marshalPromiseToCallbacks)(p.connectTranscriberRecognizer(this.privRecognizer),o,c)}startTranscribingAsync(t,o){this.privRecognizer.startContinuousRecognitionAsync(t,o)}stopTranscribingAsync(t,o){this.privRecognizer.stopContinuousRecognitionAsync(t,o)}leaveMeetingAsync(t,o){this.privRecognizer.disconnectCallbacks(),(0,r.marshalPromiseToCallbacks)((async()=>{})(),t,o)}close(t,o){n.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),t,o)}async dispose(t){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),t&&(this.privDisposedRecognizer=!0))}};return Er.MeetingTranscriber=a,Er}var Ir={},zc;function hf(){if(zc)return Ir;zc=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.ConversationTranscriptionResult=void 0;const e=P();let r=class extends e.RecognitionResult{constructor(u,s,a,i,t,o,c,p,d,l,h){super(u,s,a,i,t,o,c,d,l,h),this.privSpeakerId=p}get speakerId(){return this.privSpeakerId}};return Ir.ConversationTranscriptionResult=r,Ir}var Nc;function _s(){return Nc||(Nc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConversationTranscriptionResult=e.MeetingTranscriber=e.MeetingTranscriptionCanceledEventArgs=e.MeetingImpl=e.Meeting=e.ParticipantChangedReason=e.User=e.Participant=e.ConversationTranscriber=e.ConversationTranslator=e.ConversationTranslationResult=e.ConversationTranslationEventArgs=e.ConversationTranslationCanceledEventArgs=e.ConversationParticipantsChangedEventArgs=e.ConversationExpirationEventArgs=e.ConversationCommon=e.ConversationImpl=e.Conversation=void 0;var r=Id();Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return r.Conversation}}),Object.defineProperty(e,"ConversationImpl",{enumerable:!0,get:function(){return r.ConversationImpl}});var n=Xv();Object.defineProperty(e,"ConversationCommon",{enumerable:!0,get:function(){return n.ConversationCommon}});var u=Zv();Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return u.ConversationExpirationEventArgs}});var s=Yv();Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return s.ConversationParticipantsChangedEventArgs}});var a=ef();Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return a.ConversationTranslationCanceledEventArgs}});var i=tf();Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return i.ConversationTranslationEventArgs}});var t=rf();Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return t.ConversationTranslationResult}});var o=sf();Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return o.ConversationTranslator}});var c=of();Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return c.ConversationTranscriber}});var p=af();Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return p.Participant}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return p.User}});var d=cf();Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return d.ParticipantChangedReason}});var l=uf();Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return l.Meeting}}),Object.defineProperty(e,"MeetingImpl",{enumerable:!0,get:function(){return l.MeetingImpl}});var h=pf();Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return h.MeetingTranscriptionCanceledEventArgs}});var g=df();Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return g.MeetingTranscriber}});var f=hf();Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return f.ConversationTranscriptionResult}})}(zi)),zi}var Ce={},jc;function bs(){if(jc)return Ce;jc=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.SynthesisRequest=Ce.Synthesizer=void 0;const e=T(),r=A(),n=_(),u=P();let s=class _d{constructor(t){const o=t;n.Contracts.throwIfNull(o,"speechConfig"),this.privProperties=o.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new r.Queue,this.tokenCredential=t.tokenCredential}get authorizationToken(){return this.properties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(t){n.Contracts.throwIfNullOrWhitespace(t,"token"),this.properties.setProperty(u.PropertyId.SpeechServiceAuthorization_Token,t)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(u.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===e.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(t){const o={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let c=this.properties.getProperty(u.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),p=this.properties.getProperty(u.PropertyId.SpeechServiceConnection_SynthVoice,""),d=_d.XMLEncode(t);return this.autoDetectSourceLanguage?c="en-US":p=p||o[c],p&&(d=`<voice name='${p}'>${d}</voice>`),d=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${c}'>${d}</speak>`,d}async dispose(t){this.privDisposed||(t&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const t=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(t.text,t.isSSML,t.requestId,t.cb,t.err,t.dataStream)}}createSynthesizerConfig(t){return new e.SynthesizerConfig(t,this.privProperties)}implCommonSynthesizeSetup(){let t=typeof window<"u"?"Browser":"Node",o="unknown",c="unknown";typeof navigator<"u"&&(t=t+"/"+navigator.platform,o=navigator.userAgent,c=navigator.appVersion);const p=this.createSynthesizerConfig(new e.SpeechServiceConfig(new e.Context(new e.OS(t,o,c)))),d=this.privProperties.getProperty(u.PropertyId.SpeechServiceConnection_Key,void 0),l=d&&d!==""?new e.CognitiveSubscriptionKeyAuthentication(d):this.tokenCredential?new e.CognitiveTokenAuthentication(async()=>{try{return(await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default"))?.token??""}catch(h){throw h}},async()=>{try{return(await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default"))?.token??""}catch(h){throw h}}):new e.CognitiveTokenAuthentication(()=>{const h=this.privProperties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(h)},()=>{const h=this.privProperties.getProperty(u.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(h)});this.privAdapter=this.createSynthesisAdapter(l,this.privConnectionFactory,p),this.privRestAdapter=this.createRestSynthesisAdapter(l,p)}static XMLEncode(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};Ce.Synthesizer=s;class a{constructor(t,o,c,p,d,l){this.requestId=t,this.text=o,this.isSSML=c,this.cb=p,this.err=d,this.dataStream=l}}return Ce.SynthesisRequest=a,Ce}var Tr={},qc;function lf(){if(qc)return Tr;qc=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.SpeechSynthesizer=void 0;const e=T(),r=A(),n=rd(),u=Wn(),s=ke(),a=_(),i=P(),t=bs();let o=class bd extends i.Synthesizer{constructor(p,d){super(p),d!==null&&(d===void 0?this.audioConfig=typeof window>"u"?void 0:i.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=d),this.privConnectionFactory=new e.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(p,d,l){const h=p;return d.properties.mergeTo(h.properties),new bd(p,l)}speakTextAsync(p,d,l,h){this.speakImpl(p,!1,d,l,h)}speakSsmlAsync(p,d,l,h){this.speakImpl(p,!0,d,l,h)}async getVoicesAsync(p=""){return this.getVoices(p)}close(p,d){a.Contracts.throwIfDisposed(this.privDisposed),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),p,d)}get internalData(){return this.privAdapter}createSynthesisAdapter(p,d,l){return new e.SpeechSynthesisAdapter(p,d,l,this,this.audioConfig)}createRestSynthesisAdapter(p,d){return new e.SynthesisRestAdapter(d,p)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(i.SpeechSynthesisOutputFormat[this.properties.getProperty(i.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(p,d,l,h,g){try{a.Contracts.throwIfDisposed(this.privDisposed);const f=(0,r.createNoDashGuid)();let S;g instanceof i.PushAudioOutputStreamCallback?S=new s.PushAudioOutputStreamImpl(g):g instanceof i.PullAudioOutputStream?S=g:g!==void 0?S=new n.AudioFileWriter(g):S=void 0,this.synthesisRequestQueue.enqueue(new t.SynthesisRequest(f,p,d,v=>{if(this.privSynthesizing=!1,l)try{l(v)}catch(m){h&&h(m)}l=void 0,this.adapterSpeak().catch(()=>{})},v=>{h&&h(v)},S)),this.adapterSpeak().catch(()=>{})}catch(f){if(h)if(f instanceof Error){const S=f;h(S.name+": "+S.message)}else h(f);this.dispose(!0).catch(()=>{})}}async getVoices(p){const d=(0,r.createNoDashGuid)(),l=await this.privRestAdapter.getVoicesList(d);if(l.ok&&Array.isArray(l.json)){let h=l.json;return p&&p.length>0&&(h=h.filter(g=>!!g.Locale&&g.Locale.toLowerCase()===p.toLowerCase())),new i.SynthesisVoicesResult(d,h,void 0)}else return new i.SynthesisVoicesResult(d,void 0,`Error: ${l.status}: ${l.statusText}`)}};return Tr.SpeechSynthesizer=o,Tr}var Ar={},Lc;function vf(){if(Lc)return Ar;Lc=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.SynthesisResult=void 0;let e=class{constructor(n,u,s,a){this.privResultId=n,this.privReason=u,this.privErrorDetails=s,this.privProperties=a}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}};return Ar.SynthesisResult=e,Ar}var wr={},Bc;function ff(){if(Bc)return wr;Bc=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.SpeechSynthesisResult=void 0;const e=P();let r=class extends e.SynthesisResult{constructor(u,s,a,i,t,o){super(u,s,i,t),this.privAudioData=a,this.privAudioDuration=o}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return wr.SpeechSynthesisResult=r,wr}var _r={},Fc;function gf(){if(Fc)return _r;Fc=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.SpeechSynthesisEventArgs=void 0;let e=class{constructor(n){this.privResult=n}get result(){return this.privResult}};return _r.SpeechSynthesisEventArgs=e,_r}var br={},xc;function Sf(){if(xc)return br;xc=1,Object.defineProperty(br,"__esModule",{value:!0}),br.SpeechSynthesisWordBoundaryEventArgs=void 0;let e=class{constructor(n,u,s,a,i,t){this.privAudioOffset=n,this.privDuration=u,this.privText=s,this.privWordLength=a,this.privTextOffset=i,this.privBoundaryType=t}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}};return br.SpeechSynthesisWordBoundaryEventArgs=e,br}var Mr={},Uc;function mf(){if(Uc)return Mr;Uc=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.SpeechSynthesisBookmarkEventArgs=void 0;let e=class{constructor(n,u){this.privAudioOffset=n,this.privText=u}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}};return Mr.SpeechSynthesisBookmarkEventArgs=e,Mr}var Or={},Wc;function Cf(){if(Wc)return Or;Wc=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.SpeechSynthesisVisemeEventArgs=void 0;let e=class{constructor(n,u,s){this.privAudioOffset=n,this.privVisemeId=u,this.privAnimation=s}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}};return Or.SpeechSynthesisVisemeEventArgs=e,Or}var qi={},Vc;function yf(){return Vc||(Vc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SpeechSynthesisBoundaryType=void 0,function(r){r.Word="WordBoundary",r.Punctuation="PunctuationBoundary",r.Sentence="SentenceBoundary"}(e.SpeechSynthesisBoundaryType||(e.SpeechSynthesisBoundaryType={}))}(qi)),qi}var Dr={},Hc;function Rf(){if(Hc)return Dr;Hc=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.SynthesisVoicesResult=void 0;const e=P();let r=class extends e.SynthesisResult{constructor(u,s,a){if(Array.isArray(s)){super(u,e.ResultReason.VoicesListRetrieved,void 0,new e.PropertyCollection),this.privVoices=[];for(const i of s)this.privVoices.push(new e.VoiceInfo(i))}else super(u,e.ResultReason.Canceled,a||"Error information unavailable",new e.PropertyCollection)}get voices(){return this.privVoices}};return Dr.SynthesisVoicesResult=r,Dr}var Li={},$c;function Pf(){return $c||($c=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=void 0;var r;(function(i){i[i.Unknown=0]="Unknown",i[i.Female=1]="Female",i[i.Male=2]="Male",i[i.Neutral=3]="Neutral"})(r=e.SynthesisVoiceGender||(e.SynthesisVoiceGender={}));var n;(function(i){i[i.Unknown=0]="Unknown",i[i.OnlineNeural=1]="OnlineNeural",i[i.OnlineStandard=2]="OnlineStandard",i[i.OfflineNeural=3]="OfflineNeural",i[i.OfflineStandard=4]="OfflineStandard",i[i.OnlineNeuralHD=5]="OnlineNeuralHD"})(n=e.SynthesisVoiceType||(e.SynthesisVoiceType={}));const u={[r[r.Neutral]]:r.Neutral,[r[r.Male]]:r.Male,[r[r.Female]]:r.Female},s={Neural:n.OnlineNeural,NeuralHD:n.OnlineNeuralHD};class a{constructor(t){if(this.privStyleList=[],t){if(this.privName=t.Name,this.privLocale=t.Locale,this.privShortName=t.ShortName,this.privLocaleName=t.LocaleName,this.privDisplayName=t.DisplayName,this.privLocalName=t.LocalName,this.privVoiceType=s[t.VoiceType]||n.Unknown,this.privGender=u[t.Gender]||r.Unknown,t.StyleList&&Array.isArray(t.StyleList))for(const o of t.StyleList)this.privStyleList.push(o);this.privSampleRateHertz=t.SampleRateHertz,this.privStatus=t.Status,t.ExtendedPropertyMap&&(this.privExtendedPropertyMap=t.ExtendedPropertyMap),this.privWordsPerMinute=t.WordsPerMinute,Array.isArray(t.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...t.SecondaryLocaleList]),Array.isArray(t.RolePlayList)&&(this.privRolePlayList=[...t.RolePlayList]),t.VoiceTag&&(this.privVoiceTag=t.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}e.VoiceInfo=a}(Li)),Li}var kr={},Kc;function Ef(){if(Kc)return kr;Kc=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.SpeakerAudioDestination=void 0;const e=A(),r=ke(),n=Me(),u=60*30,s={[n.AudioFormatTag.PCM]:"audio/wav",[n.AudioFormatTag.MuLaw]:"audio/x-wav",[n.AudioFormatTag.MP3]:"audio/mpeg",[n.AudioFormatTag.OGG_OPUS]:"audio/ogg",[n.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[n.AudioFormatTag.ALaw]:"audio/x-wav",[n.AudioFormatTag.FLAC]:"audio/flac",[n.AudioFormatTag.AMR_WB]:"audio/amr-wb",[n.AudioFormatTag.G722]:"audio/G722"};let a=class{constructor(t){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=t||(0,e.createNoDashGuid)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(t,o,c){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(t),this.updateSourceBuffer().then(()=>{o&&o()},p=>{c&&c(p)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(t),this.privBytesReceived+=t.byteLength)}close(t,o){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{t&&t()},c=>{o&&o(c)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===n.AudioFormatTag.PCM||this.privFormat.formatTag===n.AudioFormatTag.MuLaw||this.privFormat.formatTag===n.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let c=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(c).then(()=>{c=this.privFormat.addHeader(c);const p=new Blob([c],{type:s[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(p),this.notifyPlayback().then(()=>{t&&t()},d=>{o&&o(d)})},p=>{o&&o(p)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(t){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=t;const o=s[this.privFormat.formatTag];o===void 0?console.warn(`Unknown mimeType for format ${n.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(o)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=u,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(o),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(c=>{e.Events.instance.onEvent(new e.BackgroundEvent(c))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(c=>{e.Events.instance.onEvent(new e.BackgroundEvent(c))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(c=>{e.Events.instance.onEvent(new e.BackgroundEvent(c))})):(console.warn(`Format ${n.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new r.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){return this.privAudio?.volume??-1}set volume(t){this.privAudio&&(this.privAudio.volume=t)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(t,o){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{t&&t()},c=>{o&&o(c)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const t=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(t)}catch{this.privAudioBuffer.unshift(t),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}};return kr.SpeakerAudioDestination=a,kr}var zr={},Jc;function If(){if(Jc)return zr;Jc=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.ConversationTranscriptionCanceledEventArgs=void 0;const e=Vn();let r=class extends e.CancellationEventArgsBase{};return zr.ConversationTranscriptionCanceledEventArgs=r,zr}var Nr={},Gc;function Tf(){if(Gc)return Nr;Gc=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.MeetingTranscriptionCanceledEventArgs=void 0;const e=Vn();let r=class extends e.CancellationEventArgsBase{};return Nr.MeetingTranscriptionCanceledEventArgs=r,Nr}var Bi={},Qc;function Af(){return Qc||(Qc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGradingSystem=void 0,function(r){r[r.FivePoint=1]="FivePoint",r[r.HundredMark=2]="HundredMark"}(e.PronunciationAssessmentGradingSystem||(e.PronunciationAssessmentGradingSystem={}))}(Bi)),Bi}var Fi={},Xc;function wf(){return Xc||(Xc=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PronunciationAssessmentGranularity=void 0,function(r){r[r.Phoneme=1]="Phoneme",r[r.Word=2]="Word",r[r.FullText=3]="FullText"}(e.PronunciationAssessmentGranularity||(e.PronunciationAssessmentGranularity={}))}(Fi)),Fi}var jr={},Zc;function _f(){if(Zc)return jr;Zc=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.PronunciationAssessmentConfig=void 0;const e=_(),r=P();let n=class Md{constructor(s,a=r.PronunciationAssessmentGradingSystem.FivePoint,i=r.PronunciationAssessmentGranularity.Phoneme,t=!1){e.Contracts.throwIfNullOrUndefined(s,"referenceText"),this.privProperties=new r.PropertyCollection,this.privProperties.setProperty(r.PropertyId.PronunciationAssessment_ReferenceText,s),this.privProperties.setProperty(r.PropertyId.PronunciationAssessment_GradingSystem,r.PronunciationAssessmentGradingSystem[a]),this.privProperties.setProperty(r.PropertyId.PronunciationAssessment_Granularity,r.PronunciationAssessmentGranularity[i]),this.privProperties.setProperty(r.PropertyId.PronunciationAssessment_EnableMiscue,String(t))}static fromJSON(s){e.Contracts.throwIfNullOrUndefined(s,"json");const a=new Md("");return a.privProperties=new r.PropertyCollection,a.properties.setProperty(r.PropertyId.PronunciationAssessment_Json,s),a}toJSON(){return this.updateJson(),this.privProperties.getProperty(r.PropertyId.PronunciationAssessment_Params)}applyTo(s){this.updateJson();const a=s.internalData;a.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,a.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(r.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,a.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(r.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(s){e.Contracts.throwIfNullOrWhitespace(s,"referenceText"),this.properties.setProperty(r.PropertyId.PronunciationAssessment_ReferenceText,s)}set phonemeAlphabet(s){e.Contracts.throwIfNullOrWhitespace(s,"phonemeAlphabet"),this.privPhonemeAlphabet=s}set enableMiscue(s){const a=s?"true":"false";this.properties.setProperty(r.PropertyId.PronunciationAssessment_EnableMiscue,a)}get enableMiscue(){return this.properties.getProperty(r.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(s){this.privNBestPhonemeCount=s}set enableProsodyAssessment(s){this.privEnableProsodyAssessment=s}enableContentAssessmentWithTopic(s){this.privContentAssessmentTopic=s}get properties(){return this.privProperties}updateJson(){const s=this.privProperties.getProperty(r.PropertyId.PronunciationAssessment_Json,"{}"),a=JSON.parse(s),i=this.privProperties.getProperty(r.PropertyId.PronunciationAssessment_ReferenceText);i&&(a.referenceText=i);const t=this.privProperties.getProperty(r.PropertyId.PronunciationAssessment_GradingSystem);t&&(a.gradingSystem=t);const o=this.privProperties.getProperty(r.PropertyId.PronunciationAssessment_Granularity);o&&(a.granularity=o),this.privPhonemeAlphabet&&(a.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(a.nbestPhonemeCount=this.privNBestPhonemeCount),a.enableProsodyAssessment=this.privEnableProsodyAssessment,a.dimension="Comprehensive",this.privProperties.getProperty(r.PropertyId.PronunciationAssessment_EnableMiscue)&&(a.enableMiscue=this.enableMiscue),this.privProperties.setProperty(r.PropertyId.PronunciationAssessment_Params,JSON.stringify(a))}};return jr.PronunciationAssessmentConfig=n,jr}var ye={},Yc;function bf(){if(Yc)return ye;Yc=1,Object.defineProperty(ye,"__esModule",{value:!0}),ye.PronunciationAssessmentResult=ye.ContentAssessmentResult=void 0;const e=_(),r=P();class n{constructor(a){this.privPronJson=a}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}}ye.ContentAssessmentResult=n;let u=class Od{constructor(a){const i=JSON.parse(a);e.Contracts.throwIfNullOrUndefined(i.NBest[0],"NBest"),this.privPronJson=i.NBest[0]}static fromResult(a){e.Contracts.throwIfNullOrUndefined(a,"result");const i=a.properties.getProperty(r.PropertyId.SpeechServiceResponse_JsonResult);return e.Contracts.throwIfNullOrUndefined(i,"json"),new Od(i)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment?.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment?.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment?.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment?.FluencyScore}get prosodyScore(){return this.detailResult.PronunciationAssessment?.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new n(this.detailResult)}};return ye.PronunciationAssessmentResult=u,ye}var qr={},eu;function Mf(){if(eu)return qr;eu=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.AvatarConfig=void 0;const e=_(),r=P();let n=class{constructor(s,a,i){this.privCustomized=!1,this.privUseBuiltInVoice=!1,e.Contracts.throwIfNullOrWhitespace(s,"character"),this.character=s,this.style=a,i===void 0&&(i=new r.AvatarVideoFormat),this.videoFormat=i}get customized(){return this.privCustomized}set customized(s){this.privCustomized=s}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(s){this.privUseBuiltInVoice=s}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(s){this.privBackgroundColor=s}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(s){this.privBackgroundImage=s}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(s){this.privRemoteIceServers=s}};return qr.AvatarConfig=n,qr}var xi={},tu;function Of(){return tu||(tu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.AvatarEventArgs=e.AvatarEventTypes=void 0,function(n){n.SwitchedToSpeaking="SwitchedToSpeaking",n.SwitchedToIdle="SwitchedToIdle",n.SessionClosed="SessionClosed"}(e.AvatarEventTypes||(e.AvatarEventTypes={}));class r{constructor(u,s){this.privOffset=u,this.privDescription=s}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}e.AvatarEventArgs=r}(xi)),xi}var Lr={},Br={},ru;function Dd(){if(ru)return Br;ru=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.SpeechSynthesisConnectionFactory=void 0;const e=z(),r=P(),n=K(),u=T(),s=q(),a=re();let i=class{constructor(){this.synthesisUri="/tts/cognitiveservices/websocket/v1"}async create(o,c,p){let d=o.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=o.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,void 0),h=n.ConnectionFactoryBase.getHostSuffix(l),g=o.parameters.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId,void 0),f=g===void 0?"tts":"voice",S=o.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+l+"."+f+".speech"+h),v={},m={};if(c.token!==void 0&&c.token!==""&&(m[c.headerName]=c.token),m[s.HeaderNames.ConnectionId]=p,g!==void 0&&g!==""&&(!d||d.search(a.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(v[a.QueryParameterNames.CustomVoiceDeploymentId]=g),o.avatarEnabled&&(!d||d.search(a.QueryParameterNames.EnableAvatar)===-1)&&(v[a.QueryParameterNames.EnableAvatar]="true"),d){const y=new URL(d),R=y.pathname;(R===""||R==="/")&&(y.pathname=this.synthesisUri,d=await n.ConnectionFactoryBase.getRedirectUrlFromEndpoint(y.toString()))}d||(d=S+this.synthesisUri),o.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,d);const C=o.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(d,v,m,new u.WebsocketMessageFormatter,e.ProxyInfo.fromParameters(o.parameters),C,p)}};return Br.SpeechSynthesisConnectionFactory=i,Br}var nu;function Df(){if(nu)return Lr;nu=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.AvatarSynthesizer=void 0;const e=Dd(),r=T(),n=A(),u=Wn(),s=P(),a=_(),i=bs();let t=class extends s.Synthesizer{constructor(c,p){super(c),a.Contracts.throwIfNullOrUndefined(p,"avatarConfig"),this.privConnectionFactory=new e.SpeechSynthesisConnectionFactory,this.privAvatarConfig=p,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(s.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(c){a.Contracts.throwIfNullOrUndefined(c,"peerConnection"),this.privIceServers=c.getConfiguration().iceServers,a.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const p=new n.Deferred;c.onicegatheringstatechange=()=>{n.Events.instance.onEvent(new n.PlatformEvent("peer connection: ice gathering state: "+c.iceGatheringState,n.EventType.Debug)),c.iceGatheringState==="complete"&&(n.Events.instance.onEvent(new n.PlatformEvent("peer connection: ice gathering complete.",n.EventType.Info)),p.resolve())},c.onicecandidate=f=>{f.candidate?n.Events.instance.onEvent(new n.PlatformEvent("peer connection: ice candidate: "+f.candidate.candidate,n.EventType.Debug)):(n.Events.instance.onEvent(new n.PlatformEvent("peer connection: ice candidate: complete",n.EventType.Debug)),p.resolve())},setTimeout(()=>{c.iceGatheringState!=="complete"&&(n.Events.instance.onEvent(new n.PlatformEvent("peer connection: ice gathering timeout.",n.EventType.Warning)),p.resolve())},2e3);const d=await c.createOffer();await c.setLocalDescription(d),await p.promise,n.Events.instance.onEvent(new n.PlatformEvent("peer connection: got local SDP.",n.EventType.Info)),this.privProperties.setProperty(s.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(c.localDescription));const l=await this.speak("",!1);if(l.reason!==s.ResultReason.SynthesizingAudioCompleted)return new s.SynthesisResult(l.resultId,l.reason,l.errorDetails,l.properties);const h=atob(l.properties.getProperty(s.PropertyId.TalkingAvatarService_WebRTC_SDP)),g=new RTCSessionDescription(JSON.parse(h));return await c.setRemoteDescription(g),new s.SynthesisResult(l.resultId,l.reason,void 0,l.properties)}async speakTextAsync(c){const p=await this.speak(c,!1);return new s.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async speakSsmlAsync(c){const p=await this.speak(c,!0);return new s.SynthesisResult(p.resultId,p.reason,p.errorDetails,p.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return a.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(c,p,d){return new r.AvatarSynthesisAdapter(c,p,d,this,this.privAvatarConfig)}createRestSynthesisAdapter(c,p){}createSynthesizerConfig(c){const p=super.createSynthesizerConfig(c);return p.avatarEnabled=!0,p}async speak(c,p){const d=(0,n.createNoDashGuid)(),l=new n.Deferred;return this.synthesisRequestQueue.enqueue(new i.SynthesisRequest(d,c,p,h=>{l.resolve(h),this.privSynthesizing=!1,this.adapterSpeak()},h=>{l.reject(h),this.privSynthesizing=!1})),this.adapterSpeak(),l.promise}};return Lr.AvatarSynthesizer=t,Lr}var Re={},iu;function kf(){if(iu)return Re;iu=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.AvatarVideoFormat=Re.Coordinate=void 0;class e{constructor(u,s){this.x=u,this.y=s}}Re.Coordinate=e;let r=class{constructor(u="H264",s=2e6,a=1920,i=1080){this.codec=u,this.bitrate=s,this.width=a,this.height=i}setCropRange(u,s){this.cropRange={bottomRight:s,topLeft:u}}};return Re.AvatarVideoFormat=r,Re}var Fr={},su;function zf(){if(su)return Fr;su=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.AvatarWebRTCConnectionResult=void 0;const e=P();let r=class extends e.SynthesisResult{constructor(u,s,a,i,t){super(s,a,i,t),this.privSDPAnswer=u}get SDPAnswer(){return this.privSDPAnswer}};return Fr.AvatarWebRTCConnectionResult=r,Fr}var xr={},ou;function Nf(){if(ou)return xr;ou=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.Diagnostics=void 0;const e=z(),r=A();let n=class{static SetLoggingLevel(s){this.privListener=new e.ConsoleLoggingListener(s),r.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(s){if(typeof window>"u")this.privListener&&(this.privListener.logPath=s);else throw new Error("File system logging not available in browser.")}static set onLogOutput(s){this.privListener&&(this.privListener.logCallback=s)}};return xr.Diagnostics=n,n.privListener=void 0,xr}var au;function P(){return au||(au=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ConnectionEventArgs=e.CancellationErrorCode=e.CancellationDetails=e.CancellationDetailsBase=e.IntentRecognitionCanceledEventArgs=e.TranslationRecognitionCanceledEventArgs=e.NoMatchDetails=e.NoMatchReason=e.Translations=e.TranslationRecognizer=e.VoiceProfileType=e.IntentRecognizer=e.SpeechRecognizer=e.Recognizer=e.PropertyId=e.PropertyCollection=e.SpeechTranslationConfigImpl=e.SpeechTranslationConfig=e.SpeechConfigImpl=e.SpeechConfig=e.ResultReason=e.TranslationSynthesisResult=e.TranslationRecognitionResult=e.TranslationSynthesisEventArgs=e.TranslationRecognitionEventArgs=e.SpeechRecognitionCanceledEventArgs=e.MeetingTranscriptionEventArgs=e.ConversationTranscriptionEventArgs=e.SpeechRecognitionEventArgs=e.LanguageUnderstandingModel=e.IntentRecognitionResult=e.SpeechRecognitionResult=e.RecognitionResult=e.IntentRecognitionEventArgs=e.OutputFormat=e.RecognitionEventArgs=e.SessionEventArgs=e.KeywordRecognitionModel=e.PushAudioOutputStreamCallback=e.PullAudioInputStreamCallback=e.CancellationReason=e.PushAudioOutputStream=e.PullAudioOutputStream=e.AudioOutputStream=e.PushAudioInputStream=e.PullAudioInputStream=e.AudioInputStream=e.AudioFormatTag=e.AudioStreamFormat=e.AudioConfig=void 0,e.SpeechSynthesisEventArgs=e.SpeechSynthesisResult=e.SynthesisResult=e.SpeechSynthesizer=e.SpeechSynthesisOutputFormat=e.Synthesizer=e.User=e.ParticipantChangedReason=e.Participant=e.MeetingTranscriber=e.Meeting=e.ConversationTranscriptionResult=e.ConversationTranscriber=e.ConversationTranslator=e.ConversationTranslationResult=e.ConversationTranslationEventArgs=e.ConversationTranslationCanceledEventArgs=e.ConversationParticipantsChangedEventArgs=e.ConversationExpirationEventArgs=e.Conversation=e.SpeakerRecognitionCancellationDetails=e.SpeakerRecognitionResultType=e.SpeakerRecognitionResult=e.SourceLanguageConfig=e.AutoDetectSourceLanguageResult=e.AutoDetectSourceLanguageConfig=e.SpeakerVerificationModel=e.SpeakerIdentificationModel=e.SpeakerRecognizer=e.VoiceProfileClient=e.VoiceProfilePhraseResult=e.VoiceProfileCancellationDetails=e.VoiceProfileResult=e.VoiceProfileEnrollmentCancellationDetails=e.VoiceProfileEnrollmentResult=e.VoiceProfile=e.ConnectionMessage=e.ConnectionMessageEventArgs=e.BaseAudioPlayer=e.ProfanityOption=e.ServicePropertyChannel=e.TurnStatusReceivedEventArgs=e.ActivityReceivedEventArgs=e.DialogServiceConnector=e.CustomCommandsConfig=e.BotFrameworkConfig=e.DialogServiceConfig=e.PhraseListGrammar=e.Connection=e.ServiceEventArgs=void 0,e.LogLevel=e.Diagnostics=e.AvatarWebRTCConnectionResult=e.Coordinate=e.AvatarVideoFormat=e.AvatarSynthesizer=e.AvatarEventArgs=e.AvatarConfig=e.LanguageIdMode=e.PronunciationAssessmentResult=e.PronunciationAssessmentConfig=e.PronunciationAssessmentGranularity=e.PronunciationAssessmentGradingSystem=e.MeetingTranscriptionCanceledEventArgs=e.ConversationTranscriptionCanceledEventArgs=e.SpeakerAudioDestination=e.VoiceInfo=e.SynthesisVoiceType=e.SynthesisVoiceGender=e.SynthesisVoicesResult=e.SpeechSynthesisBoundaryType=e.SpeechSynthesisVisemeEventArgs=e.SpeechSynthesisBookmarkEventArgs=e.SpeechSynthesisWordBoundaryEventArgs=void 0;var r=od();Object.defineProperty(e,"AudioConfig",{enumerable:!0,get:function(){return r.AudioConfig}});var n=Me();Object.defineProperty(e,"AudioStreamFormat",{enumerable:!0,get:function(){return n.AudioStreamFormat}}),Object.defineProperty(e,"AudioFormatTag",{enumerable:!0,get:function(){return n.AudioFormatTag}});var u=nd();Object.defineProperty(e,"AudioInputStream",{enumerable:!0,get:function(){return u.AudioInputStream}}),Object.defineProperty(e,"PullAudioInputStream",{enumerable:!0,get:function(){return u.PullAudioInputStream}}),Object.defineProperty(e,"PushAudioInputStream",{enumerable:!0,get:function(){return u.PushAudioInputStream}});var s=ke();Object.defineProperty(e,"AudioOutputStream",{enumerable:!0,get:function(){return s.AudioOutputStream}}),Object.defineProperty(e,"PullAudioOutputStream",{enumerable:!0,get:function(){return s.PullAudioOutputStream}}),Object.defineProperty(e,"PushAudioOutputStream",{enumerable:!0,get:function(){return s.PushAudioOutputStream}});var a=Kl();Object.defineProperty(e,"CancellationReason",{enumerable:!0,get:function(){return a.CancellationReason}});var i=Jl();Object.defineProperty(e,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return i.PullAudioInputStreamCallback}});var t=Gl();Object.defineProperty(e,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return t.PushAudioOutputStreamCallback}});var o=Ql();Object.defineProperty(e,"KeywordRecognitionModel",{enumerable:!0,get:function(){return o.KeywordRecognitionModel}});var c=Xl();Object.defineProperty(e,"SessionEventArgs",{enumerable:!0,get:function(){return c.SessionEventArgs}});var p=Zl();Object.defineProperty(e,"RecognitionEventArgs",{enumerable:!0,get:function(){return p.RecognitionEventArgs}});var d=Yl();Object.defineProperty(e,"OutputFormat",{enumerable:!0,get:function(){return d.OutputFormat}});var l=ev();Object.defineProperty(e,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return l.IntentRecognitionEventArgs}});var h=tv();Object.defineProperty(e,"RecognitionResult",{enumerable:!0,get:function(){return h.RecognitionResult}});var g=rv();Object.defineProperty(e,"SpeechRecognitionResult",{enumerable:!0,get:function(){return g.SpeechRecognitionResult}});var f=nv();Object.defineProperty(e,"IntentRecognitionResult",{enumerable:!0,get:function(){return f.IntentRecognitionResult}});var S=iv();Object.defineProperty(e,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return S.LanguageUnderstandingModel}});var v=sv();Object.defineProperty(e,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return v.SpeechRecognitionEventArgs}}),Object.defineProperty(e,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return v.ConversationTranscriptionEventArgs}}),Object.defineProperty(e,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return v.MeetingTranscriptionEventArgs}});var m=ov();Object.defineProperty(e,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return m.SpeechRecognitionCanceledEventArgs}});var C=av();Object.defineProperty(e,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return C.TranslationRecognitionEventArgs}});var y=cv();Object.defineProperty(e,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return y.TranslationSynthesisEventArgs}});var R=cd();Object.defineProperty(e,"TranslationRecognitionResult",{enumerable:!0,get:function(){return R.TranslationRecognitionResult}});var I=uv();Object.defineProperty(e,"TranslationSynthesisResult",{enumerable:!0,get:function(){return I.TranslationSynthesisResult}});var w=pv();Object.defineProperty(e,"ResultReason",{enumerable:!0,get:function(){return w.ResultReason}});var E=dv();Object.defineProperty(e,"SpeechConfig",{enumerable:!0,get:function(){return E.SpeechConfig}}),Object.defineProperty(e,"SpeechConfigImpl",{enumerable:!0,get:function(){return E.SpeechConfigImpl}});var M=hv();Object.defineProperty(e,"SpeechTranslationConfig",{enumerable:!0,get:function(){return M.SpeechTranslationConfig}}),Object.defineProperty(e,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return M.SpeechTranslationConfigImpl}});var O=pd();Object.defineProperty(e,"PropertyCollection",{enumerable:!0,get:function(){return O.PropertyCollection}});var U=As();Object.defineProperty(e,"PropertyId",{enumerable:!0,get:function(){return U.PropertyId}});var Oe=lv();Object.defineProperty(e,"Recognizer",{enumerable:!0,get:function(){return Oe.Recognizer}});var N=vv();Object.defineProperty(e,"SpeechRecognizer",{enumerable:!0,get:function(){return N.SpeechRecognizer}});var Ds=fv();Object.defineProperty(e,"IntentRecognizer",{enumerable:!0,get:function(){return Ds.IntentRecognizer}});var Jd=gv();Object.defineProperty(e,"VoiceProfileType",{enumerable:!0,get:function(){return Jd.VoiceProfileType}});var Gd=Sv();Object.defineProperty(e,"TranslationRecognizer",{enumerable:!0,get:function(){return Gd.TranslationRecognizer}});var Qd=mv();Object.defineProperty(e,"Translations",{enumerable:!0,get:function(){return Qd.Translations}});var Xd=Cv();Object.defineProperty(e,"NoMatchReason",{enumerable:!0,get:function(){return Xd.NoMatchReason}});var Zd=yv();Object.defineProperty(e,"NoMatchDetails",{enumerable:!0,get:function(){return Zd.NoMatchDetails}});var Yd=Rv();Object.defineProperty(e,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return Yd.TranslationRecognitionCanceledEventArgs}});var eh=Pv();Object.defineProperty(e,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return eh.IntentRecognitionCanceledEventArgs}});var th=Sd();Object.defineProperty(e,"CancellationDetailsBase",{enumerable:!0,get:function(){return th.CancellationDetailsBase}});var rh=Ev();Object.defineProperty(e,"CancellationDetails",{enumerable:!0,get:function(){return rh.CancellationDetails}});var nh=Iv();Object.defineProperty(e,"CancellationErrorCode",{enumerable:!0,get:function(){return nh.CancellationErrorCode}});var ih=Tv();Object.defineProperty(e,"ConnectionEventArgs",{enumerable:!0,get:function(){return ih.ConnectionEventArgs}});var sh=Av();Object.defineProperty(e,"ServiceEventArgs",{enumerable:!0,get:function(){return sh.ServiceEventArgs}});var oh=vd();Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return oh.Connection}});var ah=wv();Object.defineProperty(e,"PhraseListGrammar",{enumerable:!0,get:function(){return ah.PhraseListGrammar}});var ch=ws();Object.defineProperty(e,"DialogServiceConfig",{enumerable:!0,get:function(){return ch.DialogServiceConfig}});var uh=_v();Object.defineProperty(e,"BotFrameworkConfig",{enumerable:!0,get:function(){return uh.BotFrameworkConfig}});var ph=bv();Object.defineProperty(e,"CustomCommandsConfig",{enumerable:!0,get:function(){return ph.CustomCommandsConfig}});var dh=Ov();Object.defineProperty(e,"DialogServiceConnector",{enumerable:!0,get:function(){return dh.DialogServiceConnector}});var hh=Dv();Object.defineProperty(e,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return hh.ActivityReceivedEventArgs}});var lh=zv();Object.defineProperty(e,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return lh.TurnStatusReceivedEventArgs}});var vh=Nv();Object.defineProperty(e,"ServicePropertyChannel",{enumerable:!0,get:function(){return vh.ServicePropertyChannel}});var fh=jv();Object.defineProperty(e,"ProfanityOption",{enumerable:!0,get:function(){return fh.ProfanityOption}});var gh=qv();Object.defineProperty(e,"BaseAudioPlayer",{enumerable:!0,get:function(){return gh.BaseAudioPlayer}});var Sh=Lv();Object.defineProperty(e,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return Sh.ConnectionMessageEventArgs}});var mh=ld();Object.defineProperty(e,"ConnectionMessage",{enumerable:!0,get:function(){return mh.ConnectionMessage}});var Ch=Bv();Object.defineProperty(e,"VoiceProfile",{enumerable:!0,get:function(){return Ch.VoiceProfile}});var ks=Fv();Object.defineProperty(e,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return ks.VoiceProfileEnrollmentResult}}),Object.defineProperty(e,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return ks.VoiceProfileEnrollmentCancellationDetails}});var zs=xv();Object.defineProperty(e,"VoiceProfileResult",{enumerable:!0,get:function(){return zs.VoiceProfileResult}}),Object.defineProperty(e,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return zs.VoiceProfileCancellationDetails}});var yh=Uv();Object.defineProperty(e,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return yh.VoiceProfilePhraseResult}});var Rh=Wv();Object.defineProperty(e,"VoiceProfileClient",{enumerable:!0,get:function(){return Rh.VoiceProfileClient}});var Ph=Vv();Object.defineProperty(e,"SpeakerRecognizer",{enumerable:!0,get:function(){return Ph.SpeakerRecognizer}});var Eh=Hv();Object.defineProperty(e,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return Eh.SpeakerIdentificationModel}});var Ih=$v();Object.defineProperty(e,"SpeakerVerificationModel",{enumerable:!0,get:function(){return Ih.SpeakerVerificationModel}});var Th=Kv();Object.defineProperty(e,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return Th.AutoDetectSourceLanguageConfig}});var Ah=Jv();Object.defineProperty(e,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Ah.AutoDetectSourceLanguageResult}});var wh=Gv();Object.defineProperty(e,"SourceLanguageConfig",{enumerable:!0,get:function(){return wh.SourceLanguageConfig}});var Qn=Qv();Object.defineProperty(e,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return Qn.SpeakerRecognitionResult}}),Object.defineProperty(e,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return Qn.SpeakerRecognitionResultType}}),Object.defineProperty(e,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return Qn.SpeakerRecognitionCancellationDetails}});var L=_s();Object.defineProperty(e,"Conversation",{enumerable:!0,get:function(){return L.Conversation}}),Object.defineProperty(e,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return L.ConversationExpirationEventArgs}}),Object.defineProperty(e,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return L.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(e,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return L.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(e,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return L.ConversationTranslationEventArgs}}),Object.defineProperty(e,"ConversationTranslationResult",{enumerable:!0,get:function(){return L.ConversationTranslationResult}}),Object.defineProperty(e,"ConversationTranslator",{enumerable:!0,get:function(){return L.ConversationTranslator}}),Object.defineProperty(e,"ConversationTranscriber",{enumerable:!0,get:function(){return L.ConversationTranscriber}}),Object.defineProperty(e,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return L.ConversationTranscriptionResult}}),Object.defineProperty(e,"Meeting",{enumerable:!0,get:function(){return L.Meeting}}),Object.defineProperty(e,"MeetingTranscriber",{enumerable:!0,get:function(){return L.MeetingTranscriber}}),Object.defineProperty(e,"Participant",{enumerable:!0,get:function(){return L.Participant}}),Object.defineProperty(e,"ParticipantChangedReason",{enumerable:!0,get:function(){return L.ParticipantChangedReason}}),Object.defineProperty(e,"User",{enumerable:!0,get:function(){return L.User}});var _h=bs();Object.defineProperty(e,"Synthesizer",{enumerable:!0,get:function(){return _h.Synthesizer}});var bh=id();Object.defineProperty(e,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return bh.SpeechSynthesisOutputFormat}});var Mh=lf();Object.defineProperty(e,"SpeechSynthesizer",{enumerable:!0,get:function(){return Mh.SpeechSynthesizer}});var Oh=vf();Object.defineProperty(e,"SynthesisResult",{enumerable:!0,get:function(){return Oh.SynthesisResult}});var Dh=ff();Object.defineProperty(e,"SpeechSynthesisResult",{enumerable:!0,get:function(){return Dh.SpeechSynthesisResult}});var kh=gf();Object.defineProperty(e,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return kh.SpeechSynthesisEventArgs}});var zh=Sf();Object.defineProperty(e,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return zh.SpeechSynthesisWordBoundaryEventArgs}});var Nh=mf();Object.defineProperty(e,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return Nh.SpeechSynthesisBookmarkEventArgs}});var jh=Cf();Object.defineProperty(e,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return jh.SpeechSynthesisVisemeEventArgs}});var qh=yf();Object.defineProperty(e,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return qh.SpeechSynthesisBoundaryType}});var Lh=Rf();Object.defineProperty(e,"SynthesisVoicesResult",{enumerable:!0,get:function(){return Lh.SynthesisVoicesResult}});var Xn=Pf();Object.defineProperty(e,"SynthesisVoiceGender",{enumerable:!0,get:function(){return Xn.SynthesisVoiceGender}}),Object.defineProperty(e,"SynthesisVoiceType",{enumerable:!0,get:function(){return Xn.SynthesisVoiceType}}),Object.defineProperty(e,"VoiceInfo",{enumerable:!0,get:function(){return Xn.VoiceInfo}});var Bh=Ef();Object.defineProperty(e,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Bh.SpeakerAudioDestination}});var Fh=If();Object.defineProperty(e,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Fh.ConversationTranscriptionCanceledEventArgs}});var xh=Tf();Object.defineProperty(e,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return xh.MeetingTranscriptionCanceledEventArgs}});var Uh=Af();Object.defineProperty(e,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return Uh.PronunciationAssessmentGradingSystem}});var Wh=wf();Object.defineProperty(e,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return Wh.PronunciationAssessmentGranularity}});var Vh=_f();Object.defineProperty(e,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return Vh.PronunciationAssessmentConfig}});var Hh=bf();Object.defineProperty(e,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return Hh.PronunciationAssessmentResult}});var $h=Pd();Object.defineProperty(e,"LanguageIdMode",{enumerable:!0,get:function(){return $h.LanguageIdMode}});var Kh=Mf();Object.defineProperty(e,"AvatarConfig",{enumerable:!0,get:function(){return Kh.AvatarConfig}});var Jh=Of();Object.defineProperty(e,"AvatarEventArgs",{enumerable:!0,get:function(){return Jh.AvatarEventArgs}});var Gh=Df();Object.defineProperty(e,"AvatarSynthesizer",{enumerable:!0,get:function(){return Gh.AvatarSynthesizer}});var Ns=kf();Object.defineProperty(e,"AvatarVideoFormat",{enumerable:!0,get:function(){return Ns.AvatarVideoFormat}}),Object.defineProperty(e,"Coordinate",{enumerable:!0,get:function(){return Ns.Coordinate}});var Qh=zf();Object.defineProperty(e,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return Qh.AvatarWebRTCConnectionResult}});var Xh=Nf();Object.defineProperty(e,"Diagnostics",{enumerable:!0,get:function(){return Xh.Diagnostics}});var Zh=ed();Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return Zh.LogLevel}})}(yi)),yi}var cu;function jf(){if(cu)return ft;cu=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.ProxyInfo=void 0;const e=P();let r=class kd{constructor(u,s,a,i){this.privProxyHostName=u,this.privProxyPort=s,this.privProxyUserName=a,this.privProxyPassword=i}static fromParameters(u){return new kd(u.getProperty(e.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(u.getProperty(e.PropertyId.SpeechServiceConnection_ProxyPort),10),u.getProperty(e.PropertyId.SpeechServiceConnection_ProxyUserName),u.getProperty(e.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(u){return this.fromParameters(u.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return ft.ProxyInfo=r,ft}var Ur={},Ui,uu;function qf(){if(uu)return Ui;uu=1;const e=new Set(["json","buffer","string"]);return Ui=r=>(...n)=>{const u=new Set;let s,a,i,t="";return n.forEach(o=>{if(typeof o=="string")if(o.toUpperCase()===o)if(s){const c=`Can't set method to ${o}, already set to ${s}.`;throw new Error(c)}else s=o;else if(o.startsWith("http:")||o.startsWith("https:"))t=o;else if(e.has(o))a=o;else throw new Error(`Unknown encoding, ${o}`);else if(typeof o=="number")u.add(o);else if(typeof o=="object")if(Array.isArray(o)||o instanceof Set)o.forEach(c=>u.add(c));else{if(i)throw new Error("Cannot set headers twice.");i=o}else throw new Error(`Unknown type: ${typeof o}`)}),s||(s="GET"),u.size===0&&u.add(200),r(u,s,a,i,t)},Ui}var Wi,pu;function Lf(){if(pu)return Wi;pu=1;const e=qf();class r extends Error{constructor(s,...a){super(...a),Error.captureStackTrace&&Error.captureStackTrace(this,r),this.name="StatusError",this.message=s.statusMessage,this.statusCode=s.status,this.res=s,this.json=s.json.bind(s),this.text=s.text.bind(s),this.arrayBuffer=s.arrayBuffer.bind(s);let i;Object.defineProperty(this,"responseBody",{get:()=>(i||(i=this.arrayBuffer()),i)}),this.headers={};for(const[o,c]of s.headers.entries())this.headers[o.toLowerCase()]=c}}return Wi=e((u,s,a,i,t)=>async(o,c,p={})=>{o=t+(o||"");let d=new URL(o);if(i||(i={}),d.username&&(i.Authorization="Basic "+btoa(d.username+":"+d.password),d=new URL(d.protocol+"//"+d.host+d.pathname+d.search)),d.protocol!=="https:"&&d.protocol!=="http:")throw new Error(`Unknown protocol, ${d.protocol}`);if(c&&!(c instanceof ArrayBuffer||ArrayBuffer.isView(c)||typeof c=="string"))if(typeof c=="object")c=JSON.stringify(c),i["Content-Type"]="application/json";else throw new Error("Unknown body type.");p=new Headers({...i||{},...p});const l=await fetch(d,{method:s,headers:p,body:c});if(l.statusCode=l.status,!u.has(l.status))throw new r(l);return a==="json"?l.json():a==="buffer"?l.arrayBuffer():a==="string"?l.text():l}),Wi}var du;function Bf(){return du||(du=1,function(e){var r=Ur&&Ur.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(e,"__esModule",{value:!0}),e.RestMessageAdapter=e.RestRequestType=void 0;const n=r(Lf()),u=A();var s;(function(i){i.Get="GET",i.Post="POST",i.Delete="DELETE",i.File="file"})(s=e.RestRequestType||(e.RestRequestType={}));let a=class{constructor(t){if(!t)throw new u.ArgumentNullError("configParams");this.privHeaders=t.headers,this.privIgnoreCache=t.ignoreCache}static extractHeaderValue(t,o){let c="";try{const p=o.trim().split(/[\r\n]+/),d={};p.forEach(l=>{const h=l.split(": "),g=h.shift().toLowerCase(),f=h.join(": ");d[g]=f}),c=d[t.toLowerCase()]}catch{}return c}set options(t){this.privHeaders=t.headers,this.privIgnoreCache=t.ignoreCache}setHeaders(t,o){this.privHeaders[t]=o}request(t,o,c={},p=null){const d=new u.Deferred,l=t===s.File?"POST":t,h=(f,S={})=>{const v=f;return{data:JSON.stringify(S),headers:JSON.stringify(f.headers),json:S,ok:f.statusCode>=200&&f.statusCode<300,status:f.statusCode,statusText:S.error?S.error.message:v.statusText?v.statusText:v.statusMessage}},g=f=>{const S=(0,n.default)(o,l,this.privHeaders,200,201,202,204,400,401,402,403,404),v=this.queryParams(c)===""?"":`?${this.queryParams(c)}`;S(v,f).then(async m=>{if(t===s.Delete||m.statusCode===204)d.resolve(h(m));else try{const C=await m.json();d.resolve(h(m,C))}catch{d.resolve(h(m))}}).catch(m=>{d.reject(m)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),t===s.Post&&p&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),g(p),d.promise}queryParams(t={}){return Object.keys(t).map(o=>encodeURIComponent(o)+"="+encodeURIComponent(t[o])).join("&")}};e.RestMessageAdapter=a}(Ur)),Ur}var Wr={},hu;function zd(){if(hu)return Wr;hu=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.RestConfigBase=void 0;let e=class Kn{static get requestOptions(){return Kn.privDefaultRequestOptions}static get configParams(){return Kn.privDefaultParams}static get restErrors(){return Kn.privRestErrors}};return Wr.RestConfigBase=e,e.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4},e.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."},e.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"},Wr}var lu;function z(){return lu||(lu=1,function(e){var r=ce&&ce.__createBinding||(Object.create?function(u,s,a,i){i===void 0&&(i=a),Object.defineProperty(u,i,{enumerable:!0,get:function(){return s[a]}})}:function(u,s,a,i){i===void 0&&(i=a),u[i]=s[a]}),n=ce&&ce.__exportStar||function(u,s){for(var a in u)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&r(s,u,a)};Object.defineProperty(e,"__esModule",{value:!0}),n(Fl(),e),n(xl(),e),n(Ul(),e),n(Wl(),e),n(Vl(),e),n(Hl(),e),n(td(),e),n($l(),e),n(jf(),e),n(Bf(),e),n(zd(),e)}(ce)),ce}var vu;function Ff(){if(vu)return ut;vu=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.IntentConnectionFactory=void 0;const e=z(),r=P(),n=K(),u=T(),s=q();let a=class extends n.ConnectionFactoryBase{create(t,o,c){let p=t.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint);if(!p){const g=t.parameters.getProperty(r.PropertyId.SpeechServiceConnection_IntentRegion),f=n.ConnectionFactoryBase.getHostSuffix(g);p=t.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+g+".sr.speech"+f)+"/speech/recognition/interactive/cognitiveservices/v1"}const d={format:"simple",language:t.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(t,d,p);const l={};o.token!==void 0&&o.token!==""&&(l[o.headerName]=o.token),l[s.HeaderNames.ConnectionId]=c,t.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,p);const h=t.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(p,d,l,new u.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(t),h,c))}getSpeechRegionFromIntentRegion(t){switch(t){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return t}}};return ut.IntentConnectionFactory=a,ut}var Pe={},fu;function xf(){if(fu)return Pe;fu=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.VoiceProfileConnectionFactory=Pe.SpeakerRecognitionConnectionFactory=void 0;const e=z(),r=P(),n=K(),u=T(),s=q();class a extends n.ConnectionFactoryBase{create(c,p,d,l){let h=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint);if(!h){const v=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),m=n.ConnectionFactoryBase.getHostSuffix(v),C=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,`wss://${v}.spr-frontend.speech${m}`),y=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");h=`${C}/speaker/ws/${this.scenarioToPath(y)}/${d}`}const g={format:"simple",language:c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(c,g,h);const f={};p.token!==void 0&&p.token!==""&&(f[p.headerName]=p.token),f[s.HeaderNames.ConnectionId]=l,f[s.HeaderNames.SpIDAuthKey]=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Key),c.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,h);const S=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(h,g,f,new u.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),S,l))}scenarioToPath(c){switch(c){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}let i=class extends a{create(c,p,d){return super.create(c,p,"recognition",d)}};Pe.SpeakerRecognitionConnectionFactory=i;class t extends a{create(c,p,d){return super.create(c,p,"profile",d)}}return Pe.VoiceProfileConnectionFactory=t,Pe}var Vi={},gu;function Ms(){return gu||(gu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionEndedEvent=e.RecognitionCompletionStatus=e.RecognitionStartedEvent=e.ConnectingToServiceEvent=e.ListeningStartedEvent=e.RecognitionTriggeredEvent=e.SpeechRecognitionEvent=void 0;const r=A();class n extends r.PlatformEvent{constructor(p,d,l,h=r.EventType.Info){super(p,h),this.privRequestId=d,this.privSessionId=l}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}e.SpeechRecognitionEvent=n;class u extends n{constructor(p,d,l,h){super("RecognitionTriggeredEvent",p,d),this.privAudioSourceId=l,this.privAudioNodeId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}e.RecognitionTriggeredEvent=u;class s extends n{constructor(p,d,l,h){super("ListeningStartedEvent",p,d),this.privAudioSourceId=l,this.privAudioNodeId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}e.ListeningStartedEvent=s;class a extends n{constructor(p,d,l){super("ConnectingToServiceEvent",p,l),this.privAuthFetchEventid=d}get authFetchEventid(){return this.privAuthFetchEventid}}e.ConnectingToServiceEvent=a;class i extends n{constructor(p,d,l,h,g){super("RecognitionStartedEvent",p,g),this.privAudioSourceId=d,this.privAudioNodeId=l,this.privAuthFetchEventId=h}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}e.RecognitionStartedEvent=i;var t;(function(c){c[c.Success=0]="Success",c[c.AudioSourceError=1]="AudioSourceError",c[c.AudioSourceTimeout=2]="AudioSourceTimeout",c[c.AuthTokenFetchError=3]="AuthTokenFetchError",c[c.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",c[c.UnAuthorized=5]="UnAuthorized",c[c.ConnectTimeout=6]="ConnectTimeout",c[c.ConnectError=7]="ConnectError",c[c.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",c[c.UnknownError=9]="UnknownError"})(t=e.RecognitionCompletionStatus||(e.RecognitionCompletionStatus={}));class o extends n{constructor(p,d,l,h,g,f,S,v){super("RecognitionEndedEvent",p,g,S===t.Success?r.EventType.Info:r.EventType.Error),this.privAudioSourceId=d,this.privAudioNodeId=l,this.privAuthFetchEventId=h,this.privStatus=S,this.privError=v,this.privServiceTag=f}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}e.RecognitionEndedEvent=o}(Vi)),Vi}var Vr={},Hr={},Su;function ze(){if(Su)return Hr;Su=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.SpeechConnectionMessage=void 0;const e=A(),r=q();class n extends e.ConnectionMessage{constructor(s,a,i,t,o,c,p,d){if(!a)throw new e.ArgumentNullError("path");if(!i)throw new e.ArgumentNullError("requestId");const l={};if(l[r.HeaderNames.Path]=a,l[r.HeaderNames.RequestId]=i,l[r.HeaderNames.RequestTimestamp]=new Date().toISOString(),t&&(l[r.HeaderNames.ContentType]=t),c&&(l[r.HeaderNames.RequestStreamId]=c),p)for(const h in p)h&&(l[h]=p[h]);d?super(s,o,l,d):super(s,o,l),this.privPath=a,this.privRequestId=i,this.privContentType=t,this.privStreamId=c,this.privAdditionalHeaders=p}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(s){let a=null,i=null,t=null,o=null;const c={};if(s.headers)for(const p in s.headers)p&&(p.toLowerCase()===r.HeaderNames.Path.toLowerCase()?a=s.headers[p]:p.toLowerCase()===r.HeaderNames.RequestId.toLowerCase()?i=s.headers[p]:p.toLowerCase()===r.HeaderNames.ContentType.toLowerCase()?t=s.headers[p]:p.toLowerCase()===r.HeaderNames.RequestStreamId.toLowerCase()?o=s.headers[p]:c[p]=s.headers[p]);return new n(s.messageType,a,i,t,s.body,o,c,s.id)}}return Hr.SpeechConnectionMessage=n,Hr}var Hi={},mu;function Uf(){return mu||(mu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SegmentationMode=void 0,function(r){r.Normal="Normal",r.Disabled="Disabled",r.Custom="Custom",r.Semantic="Semantic"}(e.SegmentationMode||(e.SegmentationMode={}))}(Hi)),Hi}var $i={},Cu;function Wf(){return Cu||(Cu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,function(r){r.None="None",r.Synthesize="Synthesize"}(e.NextAction||(e.NextAction={}))}($i)),$i}var Ki={},yu;function Vf(){return yu||(yu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Mode=void 0,function(r){r.None="None",r.Always="Always"}(e.Mode||(e.Mode={}))}(Ki)),Ki}var Ji={},Ru;function Hf(){return Ru||(Ru=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LanguageIdDetectionPriority=e.LanguageIdDetectionMode=void 0,function(r){r.DetectAtAudioStart="DetectAtAudioStart",r.DetectContinuous="DetectContinuous",r.DetectSegments="DetectSegments"}(e.LanguageIdDetectionMode||(e.LanguageIdDetectionMode={})),function(r){r.Auto="Auto",r.PrioritizeLatency="PrioritizeLatency",r.PrioritizeAccuracy="PrioritizeAccuracy"}(e.LanguageIdDetectionPriority||(e.LanguageIdDetectionPriority={}))}(Ji)),Ji}var Gi={},Pu;function $f(){return Pu||(Pu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,function(r){r.Recognize="Recognize",r.None="None"}(e.NextAction||(e.NextAction={}))}(Gi)),Gi}var Qi={},Eu;function Kf(){return Eu||(Eu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OnUnknownAction=void 0,function(r){r.RecognizeWithDefaultLanguage="RecognizeWithDefaultLanguage",r.None="None"}(e.OnUnknownAction||(e.OnUnknownAction={}))}(Qi)),Qi}var Xi={},Iu;function Jf(){return Iu||(Iu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ResultType=void 0,function(r){r.Auto="Auto",r.StableFragment="StableFragment",r.Hypothesis="Hypothesis",r.None="None"}(e.ResultType||(e.ResultType={}))}(Xi)),Xi}var Zi={},Tu;function Gf(){return Tu||(Tu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PhraseResultOutputType=void 0,function(r){r.Always="Always",r.None="None"}(e.PhraseResultOutputType||(e.PhraseResultOutputType={}))}(Zi)),Zi}var Yi={},Au;function Qf(){return Au||(Au=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NextAction=void 0,function(r){r.None="None",r.Translate="Translate"}(e.NextAction||(e.NextAction={}))}(Yi)),Yi}var wu;function Xf(){if(wu)return Vr;wu=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.ServiceRecognizerBase=void 0;const e=z(),r=A(),n=P(),u=T(),s=ze(),a=Uf(),i=W(),t=Wf(),o=Vf(),c=Hf(),p=$f(),d=Kf(),l=Jf(),h=Gf(),g=Qf();let f=class xn{constructor(v,m,C,y,R){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!v)throw new r.ArgumentNullError("authentication");if(!m)throw new r.ArgumentNullError("connectionFactory");if(!C)throw new r.ArgumentNullError("audioSource");if(!y)throw new r.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=y.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=v,this.privConnectionFactory=m,this.privAudioSource=C,this.privRecognizerConfig=y,this.privIsDisposed=!1,this.privRecognizer=R,this.privRequestSession=new u.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new r.EventSource,this.privServiceEvents=new r.EventSource,this.privDynamicGrammar=new u.DynamicGrammarBuilder,this.privSpeechContext=new u.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new u.AgentConfig,this.privRecognizerConfig.parameters.getProperty(n.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=r.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(w=>{if(w.name==="ConnectionClosedEvent"){const E=w;(E.statusCode===1003||E.statusCode===1007||E.statusCode===1002||E.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(n.CancellationReason.Error,E.statusCode===1007?n.CancellationErrorCode.BadRequestParameters:n.CancellationErrorCode.ConnectionFailure,`${E.reason} websocket error code: ${E.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=(0,r.createNoDashGuid)())}setTranslationJson(){const v=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(v!==void 0){const m=v.split(","),C=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),y=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_TranslationCategoryId,void 0),R=C!==void 0?t.NextAction.Synthesize:t.NextAction.None;if(this.privSpeechContext.getContext().translation={onPassthrough:{action:R},onSuccess:{action:R},output:{includePassThroughResults:!0,interimResults:{mode:o.Mode.Always}},targetLanguages:m},y!==void 0&&(this.privSpeechContext.getContext().translation.category=y),C!==void 0){const w={};for(const E of m)w[E]=C;this.privSpeechContext.getContext().synthesis={defaultVoices:w}}const I=this.privSpeechContext.getContext().phraseDetection||{};I.onSuccess={action:g.NextAction.Translate},I.onInterim={action:g.NextAction.Translate},this.privSpeechContext.getContext().phraseDetection=I}}setSpeechSegmentationTimeoutJson(){const v=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),m=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),C=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.Speech_SegmentationStrategy,void 0),y={mode:a.SegmentationMode.Normal};let R=!1;if(C!==void 0){R=!0;let I=a.SegmentationMode.Normal;switch(C.toLowerCase()){case"default":break;case"time":I=a.SegmentationMode.Custom;break;case"semantic":I=a.SegmentationMode.Semantic;break}y.mode=I}if(v!==void 0){R=!0;const I=parseInt(v,10);y.mode=a.SegmentationMode.Custom,y.segmentationSilenceTimeoutMs=I}if(m!==void 0){R=!0;const I=parseInt(m,10);y.mode=a.SegmentationMode.Custom,y.segmentationForcedTimeoutMs=I}if(R){const I=this.privSpeechContext.getContext().phraseDetection||{};switch(I.mode=this.recognitionMode,this.recognitionMode){case i.RecognitionMode.Conversation:I.conversation=I.conversation??{segmentation:{}},I.conversation.segmentation=y;break;case i.RecognitionMode.Interactive:I.interactive=I.interactive??{segmentation:{}},I.interactive.segmentation=y;break;case i.RecognitionMode.Dictation:I.dictation=I.dictation??{},I.dictation.segmentation=y;break}this.privSpeechContext.getContext().phraseDetection=I}}setLanguageIdJson(){const v=this.privSpeechContext.getContext().phraseDetection||{};if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const m=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");m.length===1&&m[0]===u.AutoDetectSourceLanguagesOpenRangeOptionName&&(m[0]="UND");let C;this.privRecognizerConfig.languageIdMode==="Continuous"?C=c.LanguageIdDetectionMode.DetectContinuous:C=c.LanguageIdDetectionMode.DetectAtAudioStart,this.privSpeechContext.getContext().languageId={languages:m,mode:C,onSuccess:{action:p.NextAction.Recognize},onUnknown:{action:d.OnUnknownAction.None},priority:c.LanguageIdDetectionPriority.PrioritizeLatency},this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:l.ResultType.Auto},phraseResults:{resultType:h.PhraseResultOutputType.Always}};const y=this.privRecognizerConfig.sourceLanguageModels;y!==void 0&&(v.customModels=y,v.onInterim={action:g.NextAction.None},v.onSuccess={action:g.NextAction.None})}this.privSpeechContext.getContext().phraseDetection=v}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(u.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple]).toLowerCase()===n.OutputFormat[n.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(v){this.privRecognizerConfig.parameters.setProperty(n.PropertyId.ConversationTranslator_Token,v)}set voiceProfileType(v){this.privRecognizerConfig.parameters.setProperty(n.PropertyId.SpeechServiceConnection_SpeakerIdMode,v)}set authentication(v){this.privAuthentication=v}isDisposed(){return this.privIsDisposed}async dispose(v){if(this.privIsDisposed=!0,this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose(v)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(v,m,C){if(this.recognizeOverride!==void 0){await this.recognizeOverride(v,m,C);return}if(this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=v,this.privRecognizerConfig.recognitionEndpointVersion==="2"){const E=this.privSpeechContext.getContext().phraseDetection||{};E.mode=v,this.privSpeechContext.getContext().phraseDetection=E}this.setLanguageIdJson(),this.setTranslationJson(),this.privRecognizerConfig.autoDetectSourceLanguages!==void 0&&this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&this.setupTranslationWithLanguageId(),this.setSpeechSegmentationTimeoutJson(),this.setOutputDetailLevelJson(),this.privSuccessCallback=m,this.privErrorCallback=C,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const y=this.connectImpl();let R;try{const E=await this.audioSource.attach(this.privRequestSession.audioNodeId),M=await this.audioSource.format,O=await this.audioSource.deviceInfo;this.privIsLiveAudio=O.type&&O.type===u.type.Microphones,R=new e.ReplayableAudioNode(E,M.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(R,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:O}}catch(E){throw await this.privRequestSession.onStopRecognizing(),E}try{await y}catch(E){await this.cancelRecognitionLocal(n.CancellationReason.Error,n.CancellationErrorCode.ConnectionFailure,E);return}const I=new n.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,I),this.receiveMessage(),this.sendAudio(R).catch(async E=>{await this.cancelRecognitionLocal(n.CancellationReason.Error,n.CancellationErrorCode.RuntimeError,E)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(v,m){this.connectImpl().then(()=>{try{v&&v()}catch(C){m&&m(C)}},C=>{try{m&&m(C)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(n.CancellationReason.Error,n.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(v){}async sendNetworkMessage(v,m){const C=typeof m=="string"?r.MessageType.Text:r.MessageType.Binary,y=typeof m=="string"?"application/json":"";return(await this.fetchConnection()).send(new s.SpeechConnectionMessage(C,v,this.privRequestSession.requestId,y,m))}set activityTemplate(v){this.privActivityTemplate=v}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(v){this.privExpectContentAssessmentResponse=v}async sendTelemetryData(){const v=this.privRequestSession.getTelemetry();if(xn.telemetryDataEnabled!==!0||this.privIsDisposed||v===null)return;if(xn.telemetryData)try{xn.telemetryData(v)}catch{}await(await this.fetchConnection()).send(new s.SpeechConnectionMessage(r.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",v))}async cancelRecognitionLocal(v,m,C){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,v,m,C))}async receiveMessage(){try{if(this.privIsDisposed)return;let v=await this.fetchConnection();const m=await v.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!m)return this.receiveMessage();this.privServiceHasSentMessage=!0;const C=s.SpeechConnectionMessage.fromConnectionMessage(m);if(C.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(C.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const y=u.SpeechDetected.fromJSON(C.textBody,this.privRequestSession.currentTurnAudioOffset),R=new n.RecognitionEventArgs(y.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,R);break;case"speech.enddetected":let I;C.textBody.length>0?I=C.textBody:I="{ Offset: 0 }";const w=u.SpeechDetected.fromJSON(I,this.privRequestSession.currentTurnAudioOffset),E=new n.RecognitionEventArgs(w.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,E);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(n.CancellationReason.EndOfStream,n.CancellationErrorCode.NoError,void 0));const M=new n.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,M);return}else v=await this.fetchConnection(),await this.sendPrePayloadJSON(v);break;default:await this.processTypeSpecificMessages(C)||this.privServiceEvents&&this.serviceEvents.onEvent(new r.ServiceEvent(C.path.toLowerCase(),C.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const v=this.privRequestSession.recognitionBytesSent,m=this.privAverageBytesPerMs!==0?v/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(m)}sendSpeechContext(v,m){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const C=this.speechContext.toJSON();if(m&&this.privRequestSession.onSpeechContext(),C)return v.send(new s.SpeechConnectionMessage(r.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",C))}setupTranslationWithLanguageId(){const v=this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0),m=this.privRecognizerConfig.autoDetectSourceLanguages!==void 0;if(v!==void 0&&m){this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:l.ResultType.None},phraseResults:{resultType:h.PhraseResultOutputType.None}};const C=this.privSpeechContext.getContext().translation;if(C){const y=this.privRecognizerConfig.sourceLanguageModels;if(y!==void 0&&y.length>0){const I=this.privSpeechContext.getContext().phraseDetection||{};I.customModels=y,this.privSpeechContext.getContext().phraseDetection=I}this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(C.onSuccess={action:t.NextAction.Synthesize},C.onPassthrough={action:t.NextAction.Synthesize})}}}noOp(){}async sendPrePayloadJSON(v,m=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(v);await this.sendSpeechContext(v,m),await this.sendWaveHeader(v)}async sendWaveHeader(v){const m=await this.audioSource.format;return v.send(new s.SpeechConnectionMessage(r.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",m.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(v=>v.state()===r.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(v,m,C){if(m.onSpeechContext(),xn.telemetryDataEnabled!==!0){const R={context:{system:JSON.parse(C).context.system}};C=JSON.stringify(R)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const y=JSON.parse(C);y.context.DisableReferenceChannel="True",y.context.MicSpec="1_0_0",C=JSON.stringify(y)}if(C)return v.send(new s.SpeechConnectionMessage(r.MessageType.Text,"speech.config",m.requestId,"application/json",C))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(v=>v.state()===r.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(v){const m=await this.audioSource.format;this.privAverageBytesPerMs=m.avgBytesPerSec/1e3;let C=Date.now();const y=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),R=m.avgBytesPerSec/1e3*parseInt(y,10),I=this.privRequestSession.recogNumber,w=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===I){const E=await this.fetchConnection(),M=await v.read();if(this.privRequestSession.isSpeechEnded)return;let O,U;if(!M||M.isEnd?(O=null,U=0):(O=M.buffer,this.privRequestSession.onAudioSent(O.byteLength),R>=this.privRequestSession.bytesSent?U=0:U=Math.max(0,C-Date.now())),U!==0&&await this.delay(U),O!==null&&(C=Date.now()+O.byteLength*1e3/(m.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===I)if(E.send(new s.SpeechConnectionMessage(r.MessageType.Binary,"audio",this.privRequestSession.requestId,null,O)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),M?.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return w()}};return w()}async retryableConnect(){let v=!1;this.privAuthFetchEventId=(0,r.createNoDashGuid)();const m=this.privRequestSession.sessionId;this.privConnectionId=m!==void 0?m:(0,r.createNoDashGuid)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let C=0,y="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){this.privRequestSession.onRetryConnection();const I=await(v?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const w=await this.privConnectionFactory.create(this.privRecognizerConfig,I,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(w.events),w.events.attach(M=>{this.connectionEvents.onEvent(M)});const E=await w.open();if(E.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(E.statusCode),Promise.resolve(w);E.statusCode===1006&&(v=!0),C=E.statusCode,y=E.reason}return await this.privRequestSession.onConnectionEstablishCompleted(C,y),Promise.reject(`Unable to contact server. StatusCode: ${C}, ${this.privRecognizerConfig.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${y}`)}delay(v){return new Promise(m=>this.privSetTimeout(m,v))}writeBufferToConsole(v){let m="Buffer Size: ";if(v===null)m+="null";else{const C=new Uint8Array(v);m+=`${v.byteLength}\r
`;for(let y=0;y<v.byteLength;y++)m+=C[y].toString(16).padStart(2,"0")+" ",(y+1)%16===0&&(console.info(m),m="")}console.info(m)}async sendFinalAudio(){await(await this.fetchConnection()).send(new s.SpeechConnectionMessage(r.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const v=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(v):(await this.sendSpeechServiceConfig(v,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(v,!1),v)}};return Vr.ServiceRecognizerBase=f,f.telemetryDataEnabled=!0,Vr}var $r={},_u;function Zf(){if(_u)return $r;_u=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.ConversationServiceRecognizer=void 0;const e=P(),r=T();let n=class extends r.ServiceRecognizerBase{constructor(s,a,i,t,o){super(s,a,i,t,o),this.handleSpeechPhraseMessage=async c=>this.handleSpeechPhrase(c),this.handleSpeechHypothesisMessage=c=>this.handleSpeechHypothesis(c)}processTypeSpecificMessages(s){}handleRecognizedCallback(s,a,i){}handleRecognizingCallback(s,a,i){}async processSpeechMessages(s){let a=!1;switch(s.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(s.textBody),a=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(s.textBody),a=!0;break}return a}cancelRecognition(s,a,i,t,o){}async handleSpeechPhrase(s){const a=r.SimpleSpeechPhrase.fromJSON(s,this.privRequestSession.currentTurnAudioOffset),i=r.EnumTranslation.implTranslateRecognitionResult(a.RecognitionStatus);let t;const o=new e.PropertyCollection;if(o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,s),this.privRequestSession.onPhraseRecognized(a.Offset+a.Duration),e.ResultReason.Canceled===i){const c=r.EnumTranslation.implTranslateCancelResult(a.RecognitionStatus),p=r.EnumTranslation.implTranslateCancelErrorCode(a.RecognitionStatus);await this.cancelRecognitionLocal(c,p,r.EnumTranslation.implTranslateErrorDetails(p))}else if(a.RecognitionStatus!==r.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(r.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])t=new e.SpeechRecognitionResult(this.privRequestSession.requestId,i,a.DisplayText,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,a.SpeakerId,void 0,a.asJson(),o);else{const c=r.DetailedSpeechPhrase.fromJSON(s,this.privRequestSession.currentTurnAudioOffset);t=new e.SpeechRecognitionResult(this.privRequestSession.requestId,i,c.Text,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,c.asJson(),o)}this.handleRecognizedCallback(t,t.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(s){const a=r.SpeechHypothesis.fromJSON(s,this.privRequestSession.currentTurnAudioOffset),i=new e.PropertyCollection;i.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,s);const t=new e.SpeechRecognitionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,a.Text,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,a.SpeakerId,void 0,a.asJson(),i);this.privRequestSession.onHypothesis(a.Offset),this.handleRecognizingCallback(t,a.Duration,this.privRequestSession.sessionId)}};return $r.ConversationServiceRecognizer=n,$r}var es={},bu;function Yf(){return bu||(bu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognizerConfig=e.SpeechResultFormat=void 0;const r=P(),n=T(),u=W();(function(a){a[a.Simple=0]="Simple",a[a.Detailed=1]="Detailed"})(e.SpeechResultFormat||(e.SpeechResultFormat={}));class s{constructor(i,t){this.privSpeechServiceConfig=i||new n.SpeechServiceConfig(new n.Context(null)),this.privParameters=t,this.privMaxRetryCount=parseInt(t.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=t.getProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(i){this.privRecognitionMode=i,this.privRecognitionActivityTimeout=i===u.RecognitionMode.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=u.RecognitionMode[i]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==u.RecognitionMode.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2")}set recognitionEndpointVersion(i){this.parameters.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,i)}get sourceLanguageModels(){const i=[];let t=!1;if(this.autoDetectSourceLanguages!==void 0)for(const o of this.autoDetectSourceLanguages.split(",")){const c=o+r.PropertyId.SpeechServiceConnection_EndpointId.toString(),p=this.parameters.getProperty(c,void 0);p!==void 0?(i.push({language:o,endpoint:p}),t=!0):i.push({language:o,endpoint:""})}return t?i:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(i){this.privEnableSpeakerId=i}}e.RecognizerConfig=s}(es)),es}var ts={},Mu;function eg(){return Mu||(Mu=1,Object.defineProperty(ts,"__esModule",{value:!0})),ts}var Kr={},Ou;function tg(){if(Ou)return Kr;Ou=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.WebsocketMessageFormatter=void 0;const e=A(),r=`\r
`;let n=class{toConnectionMessage(s){const a=new e.Deferred;try{if(s.messageType===e.MessageType.Text){const i=s.textContent;let t={},o=null;if(i){const c=i.split(`\r
\r
`);c&&c.length>0&&(t=this.parseHeaders(c[0]),c.length>1&&(o=c[1]))}a.resolve(new e.ConnectionMessage(s.messageType,o,t,s.id))}else if(s.messageType===e.MessageType.Binary){const i=s.binaryContent;let t={},o=null;if(!i||i.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const c=new DataView(i),p=c.getInt16(0);if(i.byteLength<p+2)throw new Error("Invalid binary message format. Header content missing.");let d="";for(let l=0;l<p;l++)d+=String.fromCharCode(c.getInt8(l+2));t=this.parseHeaders(d),i.byteLength>p+2&&(o=i.slice(2+p)),a.resolve(new e.ConnectionMessage(s.messageType,o,t,s.id))}}catch(i){a.reject(`Error formatting the message. Error: ${i}`)}return a.promise}fromConnectionMessage(s){const a=new e.Deferred;try{if(s.messageType===e.MessageType.Text){const i=`${this.makeHeaders(s)}${r}${s.textBody?s.textBody:""}`;a.resolve(new e.RawWebsocketMessage(e.MessageType.Text,i,s.id))}else if(s.messageType===e.MessageType.Binary){const i=this.makeHeaders(s),t=s.binaryBody,o=this.stringToArrayBuffer(i),c=new Int8Array(o),p=c.byteLength,d=new Int8Array(2+p+(t?t.byteLength:0));if(d[0]=p>>8&255,d[1]=p&255,d.set(c,2),t){const h=new Int8Array(t);d.set(h,2+p)}const l=d.buffer;a.resolve(new e.RawWebsocketMessage(e.MessageType.Binary,l,s.id))}}catch(i){a.reject(`Error formatting the message. ${i}`)}return a.promise}makeHeaders(s){let a="";if(s.headers)for(const i in s.headers)i&&(a+=`${i}: ${s.headers[i]}${r}`);return a}parseHeaders(s){const a={};if(s){const i=s.match(/[^\r\n]+/g);if(a){for(const t of i)if(t){const o=t.indexOf(":"),c=o>0?t.substr(0,o).trim().toLowerCase():t,p=o>0&&t.length>o+1?t.substr(o+1).trim():"";a[c]=p}}}return a}stringToArrayBuffer(s){const a=new ArrayBuffer(s.length),i=new DataView(a);for(let t=0;t<s.length;t++)i.setUint8(t,s.charCodeAt(t));return a}};return Kr.WebsocketMessageFormatter=n,Kr}var Jr={},Du;function rg(){if(Du)return Jr;Du=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.SpeechConnectionFactory=void 0;const e=z(),r=T(),n=P(),u=K(),s=T(),a=q(),i=re(),t=W();let o=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/stt/speech/universal/v"}async create(p,d,l){let h=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,void 0);const g=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region,void 0),f=u.ConnectionFactoryBase.getHostSuffix(g),S=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"wss://"+g+".stt.speech"+f),v={},m=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_EndpointId,void 0),C=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(m?(!h||h.search(i.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(v[i.QueryParameterNames.CustomSpeechDeploymentId]=m):C&&(!h||h.search(i.QueryParameterNames.Language)===-1)&&(v[i.QueryParameterNames.Language]=C),(!h||h.search(i.QueryParameterNames.Format)===-1)&&(v[i.QueryParameterNames.Format]=p.parameters.getProperty(r.OutputFormatPropertyName,n.OutputFormat[n.OutputFormat.Simple]).toLowerCase()),p.autoDetectSourceLanguages!==void 0&&(v[i.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(p,v,h),h){const E=new URL(h),M=E.pathname;(M===""||M==="/")&&(E.pathname=this.universalUri+p.recognitionEndpointVersion,h=await u.ConnectionFactoryBase.getRedirectUrlFromEndpoint(E.toString()))}if(!h)switch(p.recognitionMode){case t.RecognitionMode.Conversation:p.parameters.getProperty(r.ForceDictationPropertyName,"false")==="true"?h=S+this.dictationRelativeUri:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?h=`${S}${this.universalUri}${p.recognitionEndpointVersion}`:h=S+this.conversationRelativeUri;break;case t.RecognitionMode.Dictation:h=S+this.dictationRelativeUri;break;default:p.recognitionEndpointVersion!==void 0&&parseInt(p.recognitionEndpointVersion,10)>1?h=`${S}${this.universalUri}${p.recognitionEndpointVersion}`:h=S+this.interactiveRelativeUri;break}const y={};d.token!==void 0&&d.token!==""&&(y[d.headerName]=d.token),y[a.HeaderNames.ConnectionId]=l,y.connectionId=l;const R=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",I=new e.WebsocketConnection(h,v,y,new s.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),R,l),w=I.uri;return p.parameters.setProperty(n.PropertyId.SpeechServiceConnection_Url,w),I}};return Jr.SpeechConnectionFactory=o,Jr}var Gr={},ku;function ng(){if(ku)return Gr;ku=1,Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.ConversationTranscriberConnectionFactory=void 0;const e=z(),r=P(),n=T(),u=K(),s=T(),a=q(),i=re();let t=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2"}async create(c,p,d){let l=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);const h=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,void 0),g=u.ConnectionFactoryBase.getHostSuffix(h),f=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+h+".stt.speech"+g),S={},v=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId,void 0),m=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(v?(!l||l.search(i.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(S[i.QueryParameterNames.CustomSpeechDeploymentId]=v):m&&(!l||l.search(i.QueryParameterNames.Language)===-1)&&(S[i.QueryParameterNames.Language]=m),c.autoDetectSourceLanguages!==void 0&&(S[i.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(c,S,l),l){const w=new URL(l),E=w.pathname;(E===""||E==="/")&&(w.pathname=this.universalUri,l=await u.ConnectionFactoryBase.getRedirectUrlFromEndpoint(w.toString()))}l||(l=`${f}${this.universalUri}`);const C={};p.token!==void 0&&p.token!==""&&(C[p.headerName]=p.token),C[a.HeaderNames.ConnectionId]=d;const y=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",R=new e.WebsocketConnection(l,S,C,new s.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),y,d),I=R.uri;return c.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,I),R}setV2UrlParams(c,p,d){new Map([[r.PropertyId.Speech_SegmentationSilenceTimeoutMs,i.QueryParameterNames.SegmentationSilenceTimeoutMs],[r.PropertyId.SpeechServiceConnection_EnableAudioLogging,i.QueryParameterNames.EnableAudioLogging],[r.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,i.QueryParameterNames.EndSilenceTimeoutMs],[r.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,i.QueryParameterNames.InitialSilenceTimeoutMs],[r.PropertyId.SpeechServiceResponse_PostProcessingOption,i.QueryParameterNames.Postprocessing],[r.PropertyId.SpeechServiceResponse_ProfanityOption,i.QueryParameterNames.Profanity],[r.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,i.QueryParameterNames.StableIntermediateThreshold]]).forEach((g,f)=>{this.setUrlParameter(f,g,c,p,d)});const h=JSON.parse(c.parameters.getProperty(n.ServicePropertiesPropertyName,"{}"));Object.keys(h).forEach(g=>{p[g]=h[g]})}};return Gr.ConversationTranscriberConnectionFactory=t,Gr}var Qr={},zu;function ig(){if(zu)return Qr;zu=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.TranscriberConnectionFactory=void 0;const e=z(),r=P(),n=K(),u=T(),s=q(),a=re();let i=class extends n.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(o,c,p){let d=o.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=o.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,"centralus"),h=n.ConnectionFactoryBase.getHostSuffix(l),g="wss://transcribe."+l+".cts.speech"+h+this.multiaudioRelativeUri,f=o.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,g),S={};this.setQueryParams(S,o,d),d||(d=f);const v={};c.token!==void 0&&c.token!==""&&(v[c.headerName]=c.token),v[s.HeaderNames.ConnectionId]=p,o.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,d);const m=o.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(d,S,v,new u.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(o),m,p))}setQueryParams(o,c,p){const d=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId,void 0),l=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);d&&!(a.QueryParameterNames.CustomSpeechDeploymentId in o)&&(o[a.QueryParameterNames.CustomSpeechDeploymentId]=d),l&&!(a.QueryParameterNames.Language in o)&&(o[a.QueryParameterNames.Language]=l);const h=c.parameters.getProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",g=c.parameters.getProperty(u.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple])!==r.OutputFormat[r.OutputFormat.Simple];(h||g)&&(o[a.QueryParameterNames.Format]=r.OutputFormat[r.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(c,o,p)}};return Qr.TranscriberConnectionFactory=i,Qr}var Xr={},Nu;function sg(){if(Nu)return Xr;Nu=1,Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.TranslationConnectionFactory=void 0;const e=z(),r=Td(),n=P(),u=K(),s=T(),a=q(),i=re(),t=W();let o=class extends u.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.translationV1Uri="/speech/translation/cognitiveservices/v1"}async create(p,d,l){let h=this.getEndpointUrl(p);const g={};if(this.setQueryParams(g,p,h),h){const m=new URL(h),C=m.pathname;(C===""||C==="/")&&(m.pathname=this.universalUri,h=await u.ConnectionFactoryBase.getRedirectUrlFromEndpoint(m.toString()))}const f={};d.token!==void 0&&d.token!==""&&(f[d.headerName]=d.token),f[a.HeaderNames.ConnectionId]=l,p.parameters.setProperty(n.PropertyId.SpeechServiceConnection_Url,h);const S=p.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new e.WebsocketConnection(h,g,f,new s.WebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(p),S,l)}getEndpointUrl(p,d){const l=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Region),h=u.ConnectionFactoryBase.getHostSuffix(l);let g=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Endpoint,void 0);return g?d===!0?g:r.StringUtils.formatString(g,{region:l}):(p.parameters.getProperty("SPEECH-ForceV1Endpoint","false")==="true"?g=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+h)+this.translationV1Uri:g=p.parameters.getProperty(n.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+h)+this.universalUri,d===!0?g:r.StringUtils.formatString(g,{region:l}))}setQueryParams(p,d,l){p.from=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage),p.to=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_TranslationToLanguages),p.scenario=d.recognitionMode===t.RecognitionMode.Interactive?"interactive":d.recognitionMode===t.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(d,p,l),this.setUrlParameter(n.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,i.QueryParameterNames.StableTranslation,d,p,l);const h=d.parameters.getProperty(n.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);h!==void 0&&(p.voice=h,p.features="requireVoice")}};return Xr.TranslationConnectionFactory=o,Xr}var Zr={},ju;function og(){if(ju)return Zr;ju=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.EnumTranslation=void 0;const e=P(),r=T();let n=class{static implTranslateRecognitionResult(s,a=!1){let i=e.ResultReason.Canceled;switch(s){case r.RecognitionStatus.Success:i=e.ResultReason.RecognizedSpeech;break;case r.RecognitionStatus.EndOfDictation:i=a?e.ResultReason.RecognizedSpeech:e.ResultReason.NoMatch;break;case r.RecognitionStatus.NoMatch:case r.RecognitionStatus.InitialSilenceTimeout:case r.RecognitionStatus.BabbleTimeout:i=e.ResultReason.NoMatch;break;case r.RecognitionStatus.Error:case r.RecognitionStatus.BadRequest:case r.RecognitionStatus.Forbidden:default:i=e.ResultReason.Canceled;break}return i}static implTranslateCancelResult(s){let a=e.CancellationReason.EndOfStream;switch(s){case r.RecognitionStatus.Success:case r.RecognitionStatus.EndOfDictation:case r.RecognitionStatus.NoMatch:a=e.CancellationReason.EndOfStream;break;case r.RecognitionStatus.InitialSilenceTimeout:case r.RecognitionStatus.BabbleTimeout:case r.RecognitionStatus.Error:case r.RecognitionStatus.BadRequest:case r.RecognitionStatus.Forbidden:default:a=e.CancellationReason.Error;break}return a}static implTranslateCancelErrorCode(s){let a=e.CancellationErrorCode.NoError;switch(s){case r.RecognitionStatus.Error:a=e.CancellationErrorCode.ServiceError;break;case r.RecognitionStatus.TooManyRequests:a=e.CancellationErrorCode.TooManyRequests;break;case r.RecognitionStatus.BadRequest:a=e.CancellationErrorCode.BadRequestParameters;break;case r.RecognitionStatus.Forbidden:a=e.CancellationErrorCode.Forbidden;break;default:a=e.CancellationErrorCode.NoError;break}return a}static implTranslateErrorDetails(s){let a="The speech service encountered an internal error and could not continue.";switch(s){case e.CancellationErrorCode.Forbidden:a="The recognizer is using a free subscription that ran out of quota.";break;case e.CancellationErrorCode.BadRequestParameters:a="Invalid parameter or unsupported audio format in the request.";break;case e.CancellationErrorCode.TooManyRequests:a="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return a}};return Zr.EnumTranslation=n,Zr}var rs={},qu;function ag(){return qu||(qu=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RecognitionStatus=e.SynthesisStatus=void 0,function(r){r[r.Success=0]="Success",r[r.SynthesisEnd=1]="SynthesisEnd",r[r.Error=2]="Error"}(e.SynthesisStatus||(e.SynthesisStatus={})),function(r){r[r.Success=0]="Success",r[r.NoMatch=1]="NoMatch",r[r.InitialSilenceTimeout=2]="InitialSilenceTimeout",r[r.BabbleTimeout=3]="BabbleTimeout",r[r.Error=4]="Error",r[r.EndOfDictation=5]="EndOfDictation",r[r.TooManyRequests=6]="TooManyRequests",r[r.BadRequest=7]="BadRequest",r[r.Forbidden=8]="Forbidden"}(e.RecognitionStatus||(e.RecognitionStatus={}))}(rs)),rs}var Yr={},Lu;function cg(){if(Lu)return Yr;Lu=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.TranslationSynthesisEnd=void 0;const e=T();let r=class Nd{constructor(u){this.privSynthesisEnd=JSON.parse(u),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=e.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=e.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(u){return new Nd(u)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return Yr.TranslationSynthesisEnd=r,Yr}var en={},Bu;function ug(){if(Bu)return en;Bu=1,Object.defineProperty(en,"__esModule",{value:!0}),en.TranslationHypothesis=void 0;const e=_(),r=Is();let n=class Rs{constructor(s,a){this.privTranslationHypothesis=s,this.privTranslationHypothesis.Offset+=a,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(s,a){return new Rs(JSON.parse(s),a)}static fromTranslationResponse(s,a){e.Contracts.throwIfNullOrUndefined(s,"translationHypothesis");const i=s.SpeechHypothesis;return s.SpeechHypothesis=void 0,i.Translation=s,new Rs(i,a)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){return this.privTranslationHypothesis.PrimaryLanguage?.Language}asJson(){const s={...this.privTranslationHypothesis};return s.Translation!==void 0?JSON.stringify({...s,TranslationStatus:r.TranslationStatus[s.Translation.TranslationStatus]}):JSON.stringify(s)}mapTranslationStatus(s){if(typeof s=="string")return r.TranslationStatus[s];if(typeof s=="number")return s}};return en.TranslationHypothesis=n,en}var tn={},Fu;function pg(){if(Fu)return tn;Fu=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.TranslationPhrase=void 0;const e=_(),r=T(),n=Is();let u=class Ps{constructor(a,i){this.privTranslationPhrase=a,this.privTranslationPhrase.Offset+=i,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(a,i){return new Ps(JSON.parse(a),i)}static fromTranslationResponse(a,i){e.Contracts.throwIfNullOrUndefined(a,"translationResponse");const t=a.SpeechPhrase;return a.SpeechPhrase=void 0,t.Translation=a,t.Text=t.DisplayText,new Ps(t,i)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){return this.privTranslationPhrase.PrimaryLanguage?.Language}get Confidence(){return this.privTranslationPhrase.PrimaryLanguage?.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const a={...this.privTranslationPhrase},i={...a,RecognitionStatus:r.RecognitionStatus[a.RecognitionStatus]};return a.Translation&&(i.Translation={...a.Translation,TranslationStatus:n.TranslationStatus[a.Translation.TranslationStatus]}),JSON.stringify(i)}mapRecognitionStatus(a){if(typeof a=="string")return r.RecognitionStatus[a];if(typeof a=="number")return a}mapTranslationStatus(a){if(typeof a=="string")return n.TranslationStatus[a];if(typeof a=="number")return a}};return tn.TranslationPhrase=u,tn}var rn={},xu;function dg(){if(xu)return rn;xu=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.TranslationServiceRecognizer=void 0;const e=A(),r=P(),n=T();let u=class extends n.ConversationServiceRecognizer{constructor(a,i,t,o,c){super(a,i,t,o,c),this.privTranslationRecognizer=c,this.connectionEvents.attach(p=>{p.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(a){const i=new r.PropertyCollection;let t=await this.processSpeechMessages(a);if(t)return!0;const o=async p=>{if(i.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,p.asJson()),this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),p.RecognitionStatus===n.RecognitionStatus.Success){const d=this.fireEventForResult(p,i);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,d)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(d.result)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const d=n.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus),l=new r.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,d,p.Text,p.Duration,p.Offset,p.Language,p.Confidence,void 0,p.asJson(),i);if(d===r.ResultReason.Canceled){const h=n.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),g=n.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(h,g,n.EnumTranslation.implTranslateErrorDetails(g))}else if(p.RecognitionStatus!==n.RecognitionStatus.EndOfDictation){const h=new r.TranslationRecognitionEventArgs(l,l.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,h)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(l)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}t=!0}},c=p=>{i.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const d=this.fireEventForResult(p,i);if(this.privRequestSession.onHypothesis(d.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,d)}catch{}t=!0};switch(a.messageType===e.MessageType.Text&&i.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),a.path.toLowerCase()){case"translation.hypothesis":c(n.TranslationHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const p=JSON.parse(a.textBody);if(p.SpeechPhrase)await o(n.TranslationPhrase.fromTranslationResponse(p,this.privRequestSession.currentTurnAudioOffset));else{const l=JSON.parse(a.textBody);l.SpeechHypothesis&&c(n.TranslationHypothesis.fromTranslationResponse(l,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await o(n.TranslationPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":case"audio":this.sendSynthesisAudio(a.binaryBody,this.privRequestSession.sessionId),t=!0;break;case"audio.end":case"translation.synthesis.end":const d=n.TranslationSynthesisEnd.fromJSON(a.textBody);switch(d.SynthesisStatus){case n.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const l=new r.TranslationSynthesisResult(r.ResultReason.Canceled,void 0),h=new r.TranslationSynthesisEventArgs(l,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,h)}catch{}}if(this.privTranslationRecognizer.canceled){const l=new r.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,r.CancellationReason.Error,d.FailureReason,r.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,l)}catch{}}break;case n.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}t=!0;break}return t}cancelRecognition(a,i,t,o,c){const p=new r.PropertyCollection;if(p.setProperty(n.CancellationErrorCodePropertyName,r.CancellationErrorCode[o]),this.privTranslationRecognizer.canceled){const d=new r.TranslationRecognitionCanceledEventArgs(a,t,c,o,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,d)}catch{}}if(this.privSuccessCallback){const d=new r.TranslationRecognitionResult(void 0,i,r.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,c,void 0,p);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(a,i,t){try{const o=new r.TranslationRecognitionEventArgs(r.TranslationRecognitionResult.fromSpeechRecognitionResult(a),i,t);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,o)}catch{}}handleRecognizedCallback(a,i,t){try{const o=new r.TranslationRecognitionEventArgs(r.TranslationRecognitionResult.fromSpeechRecognitionResult(a),i,t);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,o)}catch{}}fireEventForResult(a,i){let t;if(a.Translation.Translations!==void 0){t=new r.Translations;for(const h of a.Translation.Translations)t.set(h.Language,h.Text||h.DisplayText)}let o,c;a instanceof n.TranslationPhrase?(a.Translation&&a.Translation.TranslationStatus===e.TranslationStatus.Success?o=r.ResultReason.TranslatedSpeech:o=r.ResultReason.RecognizedSpeech,c=a.Confidence):o=r.ResultReason.TranslatingSpeech;const p=a.Language,d=new r.TranslationRecognitionResult(t,this.privRequestSession.requestId,o,a.Text,a.Duration,a.Offset,p,c,a.Translation.FailureReason,a.asJson(),i);return new r.TranslationRecognitionEventArgs(d,a.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(a,i){const t=a===void 0?r.ResultReason.SynthesizingAudioCompleted:r.ResultReason.SynthesizingAudio,o=new r.TranslationSynthesisResult(t,a),c=new r.TranslationSynthesisEventArgs(o,i);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,c)}catch{}}};return rn.TranslationServiceRecognizer=u,rn}var nn={},Uu;function hg(){if(Uu)return nn;Uu=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.SpeechDetected=void 0;let e=class jd{constructor(n,u){this.privSpeechStartDetected=JSON.parse(n),this.privSpeechStartDetected.Offset+=u}static fromJSON(n,u){return new jd(n,u)}get Offset(){return this.privSpeechStartDetected.Offset}};return nn.SpeechDetected=e,nn}var sn={},Wu;function lg(){if(Wu)return sn;Wu=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.SpeechHypothesis=void 0;let e=class qd{constructor(n,u){this.privSpeechHypothesis=JSON.parse(n),this.updateOffset(u)}static fromJSON(n,u){return new qd(n,u)}updateOffset(n){this.privSpeechHypothesis.Offset+=n}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}};return sn.SpeechHypothesis=e,sn}var on={},Vu;function vg(){if(Vu)return on;Vu=1,Object.defineProperty(on,"__esModule",{value:!0}),on.SpeechKeyword=void 0;let e=class Ld{constructor(n,u){this.privSpeechKeyword=JSON.parse(n),this.privSpeechKeyword.Offset+=u}static fromJSON(n,u){return new Ld(n,u)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}};return on.SpeechKeyword=e,on}var an={},Hu;function fg(){if(Hu)return an;Hu=1,Object.defineProperty(an,"__esModule",{value:!0}),an.SpeechServiceRecognizer=void 0;const e=P(),r=T();let n=class extends r.ServiceRecognizerBase{constructor(s,a,i,t,o){super(s,a,i,t,o),this.privSpeechRecognizer=o}async processTypeSpecificMessages(s){let a;const i=new e.PropertyCollection;let t=!1;switch(s.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const o=r.SpeechHypothesis.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset);i.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,o.asJson()),a=new e.SpeechRecognitionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,o.Text,o.Duration,o.Offset,o.Language,o.LanguageDetectionConfidence,void 0,void 0,o.asJson(),i),this.privRequestSession.onHypothesis(o.Offset);const c=new e.SpeechRecognitionEventArgs(a,o.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch{}t=!0;break;case"speech.phrase":const p=r.SimpleSpeechPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset);i.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,p.asJson());const d=r.EnumTranslation.implTranslateRecognitionResult(p.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(p.Offset+p.Duration),e.ResultReason.Canceled===d){const l=r.EnumTranslation.implTranslateCancelResult(p.RecognitionStatus),h=r.EnumTranslation.implTranslateCancelErrorCode(p.RecognitionStatus);await this.cancelRecognitionLocal(l,h,r.EnumTranslation.implTranslateErrorDetails(h))}else{if(p.RecognitionStatus===r.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(r.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])a=new e.SpeechRecognitionResult(this.privRequestSession.requestId,d,p.DisplayText,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,void 0,void 0,p.asJson(),i);else{const h=r.DetailedSpeechPhrase.fromJSON(s.textBody,this.privRequestSession.currentTurnAudioOffset);i.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,h.asJson()),a=new e.SpeechRecognitionResult(this.privRequestSession.requestId,d,h.RecognitionStatus===r.RecognitionStatus.Success?h.NBest[0].Display:"",h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),i)}const l=new e.SpeechRecognitionEventArgs(a,a.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,l)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(a)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}t=!0;break}return t}cancelRecognition(s,a,i,t,o){const c=new e.PropertyCollection;if(c.setProperty(r.CancellationErrorCodePropertyName,e.CancellationErrorCode[t]),this.privSpeechRecognizer.canceled){const p=new e.SpeechRecognitionCanceledEventArgs(i,o,t,void 0,s);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,p)}catch{}}if(this.privSuccessCallback){const p=new e.SpeechRecognitionResult(a,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,o,void 0,c);try{this.privSuccessCallback(p),this.privSuccessCallback=void 0}catch{}}}};return an.SpeechServiceRecognizer=n,an}var cn={},ns={},$u;function gg(){return $u||($u=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.IdentityProvider=e.SpeakerDiarizationMode=void 0,function(r){r.None="None",r.Identity="Identity",r.Anonymous="Anonymous"}(e.SpeakerDiarizationMode||(e.SpeakerDiarizationMode={})),function(r){r.CallCenter="CallCenter"}(e.IdentityProvider||(e.IdentityProvider={}))}(ns)),ns}var Ku;function Sg(){if(Ku)return cn;Ku=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.ConversationTranscriptionServiceRecognizer=void 0;const e=P(),r=T(),n=gg(),u=W();let s=class extends r.ServiceRecognizerBase{constructor(i,t,o,c,p){super(i,t,o,c,p),this.privConversationTranscriber=p,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const i=this.privSpeechContext.getContext().phraseDetection||{};i.mode=u.RecognitionMode.Conversation;const t={};t.mode=n.SpeakerDiarizationMode.Anonymous,t.audioSessionId=this.privDiarizationSessionId,t.audioOffsetMs=0,t.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",i.speakerDiarization=t,this.privSpeechContext.getContext().phraseDetection=i}}async processTypeSpecificMessages(i){let t;const o=new e.PropertyCollection;o.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,i.textBody);let c=!1;switch(i.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const p=r.SpeechHypothesis.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);t=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,e.ResultReason.RecognizingSpeech,p.Text,p.Duration,p.Offset,p.Language,p.LanguageDetectionConfidence,p.SpeakerId,void 0,p.asJson(),o),this.privRequestSession.onHypothesis(p.Offset);const d=new e.ConversationTranscriptionEventArgs(t,p.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,d)}catch{}c=!0;break;case"speech.phrase":const l=r.SimpleSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset),h=r.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(l.Offset+l.Duration),e.ResultReason.Canceled===h){const g=r.EnumTranslation.implTranslateCancelResult(l.RecognitionStatus),f=r.EnumTranslation.implTranslateCancelErrorCode(l.RecognitionStatus);await this.cancelRecognitionLocal(g,f,r.EnumTranslation.implTranslateErrorDetails(f))}else if(!(this.privRequestSession.isSpeechEnded&&h===e.ResultReason.NoMatch&&l.RecognitionStatus!==r.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(r.OutputFormatPropertyName)===e.OutputFormat[e.OutputFormat.Simple])t=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,h,l.DisplayText,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,l.SpeakerId,void 0,l.asJson(),o);else{const f=r.DetailedSpeechPhrase.fromJSON(i.textBody,this.privRequestSession.currentTurnAudioOffset);t=new e.ConversationTranscriptionResult(this.privRequestSession.requestId,h,f.RecognitionStatus===r.RecognitionStatus.Success?f.NBest[0].Display:void 0,f.Duration,f.Offset,f.Language,f.LanguageDetectionConfidence,l.SpeakerId,void 0,f.asJson(),o)}const g=new e.ConversationTranscriptionEventArgs(t,t.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,g)}catch{}}c=!0;break}return c}cancelRecognition(i,t,o,c,p){if(new e.PropertyCollection().setProperty(r.CancellationErrorCodePropertyName,e.CancellationErrorCode[c]),this.privConversationTranscriber.canceled){const l=new e.ConversationTranscriptionCanceledEventArgs(o,p,c,void 0,i);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,l)}catch{}}}};return cn.ConversationTranscriptionServiceRecognizer=s,cn}var un={},Ju;function mg(){if(Ju)return un;Ju=1,Object.defineProperty(un,"__esModule",{value:!0}),un.TranscriptionServiceRecognizer=void 0;const e=A(),r=P(),n=T(),u=ze();let s=class extends n.ConversationServiceRecognizer{constructor(i,t,o,c,p){super(i,t,o,c,p),this.privTranscriberRecognizer=p,this.sendPrePayloadJSONOverride=d=>this.sendTranscriptionStartJSON(d),this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(i,t){if(this.privRequestSession.isRecognizing){const o=await this.fetchConnection();await this.sendSpeechEvent(o,this.createSpeechEventPayload(i,t))}}async sendMeetingSpeechEventAsync(i,t){if(this.privRequestSession.isRecognizing){const o=await this.fetchConnection();await this.sendSpeechEvent(o,this.createMeetingSpeechEventPayload(i,t))}}processTypeSpecificMessages(i){return this.processSpeechMessages(i)}handleRecognizedCallback(i,t,o){try{const c=new r.SpeechRecognitionEventArgs(i,t,o);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,c),this.privSuccessCallback){try{this.privSuccessCallback(i)}catch(p){this.privErrorCallback&&this.privErrorCallback(p)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(i,t,o){try{const c=new r.SpeechRecognitionEventArgs(i,t,o);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,c)}catch{}}cancelRecognition(i,t,o,c,p){const d=new r.PropertyCollection;if(d.setProperty(n.CancellationErrorCodePropertyName,r.CancellationErrorCode[c]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const l=new r.MeetingTranscriptionCanceledEventArgs(o,p,c,void 0,i);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,l)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const l=new r.ConversationTranscriptionCanceledEventArgs(o,p,c,void 0,i);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,l)}catch{}}if(this.privSuccessCallback){const l=new r.SpeechRecognitionResult(t,r.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,p,void 0,d);try{this.privSuccessCallback(l),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(i){if(await this.sendSpeechContext(i,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const t=this.privTranscriberRecognizer.getMeetingInfo(),o=this.createMeetingSpeechEventPayload(t,"start");await this.sendSpeechEvent(i,o)}else{const t=this.privTranscriberRecognizer.getConversationInfo(),o=this.createSpeechEventPayload(t,"start");await this.sendSpeechEvent(i,o)}await this.sendWaveHeader(i)}sendSpeechEvent(i,t){const o=JSON.stringify(t);if(o)return i.send(new u.SpeechConnectionMessage(e.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",o))}createSpeechEventPayload(i,t){const o={id:"meeting",name:t,meeting:i.conversationProperties};return o.meeting.id=i.id,o.meeting.attendees=i.participants,o}createMeetingSpeechEventPayload(i,t){const o={id:"meeting",name:t,meeting:i.meetingProperties};return o.meeting.id=i.id,o.meeting.attendees=i.participants,o}};return un.TranscriptionServiceRecognizer=s,un}var pn={},Gu;function Cg(){if(Gu)return pn;Gu=1,Object.defineProperty(pn,"__esModule",{value:!0}),pn.DetailedSpeechPhrase=void 0;const e=T();let r=class Bd{constructor(u,s){this.privDetailedSpeechPhrase=JSON.parse(u),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(s)}static fromJSON(u,s){return new Bd(u,s)}updateOffsets(u){if(this.privDetailedSpeechPhrase.Offset+=u,this.privDetailedSpeechPhrase.NBest)for(const s of this.privDetailedSpeechPhrase.NBest){if(s.Words)for(const a of s.Words)a.Offset+=u;if(s.DisplayWords)for(const a of s.DisplayWords)a.Offset+=u}}asJson(){const u={...this.privDetailedSpeechPhrase};return JSON.stringify({...u,RecognitionStatus:e.RecognitionStatus[u.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(u){if(typeof u=="string")return e.RecognitionStatus[u];if(typeof u=="number")return u}};return pn.DetailedSpeechPhrase=r,pn}var dn={},Qu;function yg(){if(Qu)return dn;Qu=1,Object.defineProperty(dn,"__esModule",{value:!0}),dn.SimpleSpeechPhrase=void 0;const e=T();let r=class Fd{constructor(u,s=0){this.privSimpleSpeechPhrase=JSON.parse(u),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(s)}static fromJSON(u,s){return new Fd(u,s)}updateOffset(u){this.privSimpleSpeechPhrase.Offset+=u}asJson(){const u={...this.privSimpleSpeechPhrase};return JSON.stringify({...u,RecognitionStatus:e.RecognitionStatus[u.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(u){if(typeof u=="string")return e.RecognitionStatus[u];if(typeof u=="number")return u}};return dn.SimpleSpeechPhrase=r,dn}var hn={},Xu;function Rg(){if(Xu)return hn;Xu=1,Object.defineProperty(hn,"__esModule",{value:!0}),hn.AddedLmIntent=void 0;let e=class{constructor(n,u){this.modelImpl=n,this.intentName=u}};return hn.AddedLmIntent=e,hn}var ln={},Zu;function Pg(){if(Zu)return ln;Zu=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.IntentServiceRecognizer=void 0;const e=A(),r=P(),n=T();let u=class extends n.ServiceRecognizerBase{constructor(a,i,t,o,c){super(a,i,t,o,c),this.privIntentRecognizer=c,this.privIntentDataSent=!1,o.recognitionEndpointVersion="1"}setIntents(a,i){this.privAddedLmIntents=a,this.privUmbrellaIntent=i,this.privIntentDataSent=!0}processTypeSpecificMessages(a){let i,t,o=!1;const c=new r.PropertyCollection;switch(a.messageType===e.MessageType.Text&&c.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),a.path.toLowerCase()){case"speech.hypothesis":const d=n.SpeechHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);if(i=new r.IntentRecognitionResult(void 0,this.privRequestSession.requestId,r.ResultReason.RecognizingIntent,d.Text,d.Duration,d.Offset,d.Language,d.LanguageDetectionConfidence,void 0,d.asJson(),c),this.privRequestSession.onHypothesis(i.offset),t=new r.IntentRecognitionEventArgs(i,d.Offset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,t)}catch{}o=!0;break;case"speech.phrase":const l=n.SimpleSpeechPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);i=new r.IntentRecognitionResult(void 0,this.privRequestSession.requestId,n.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus),l.DisplayText,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,l.asJson(),c),t=new r.IntentRecognitionEventArgs(i,i.offset,this.privRequestSession.sessionId);const h=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,t)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(i)}catch(f){this.privErrorCallback&&this.privErrorCallback(f)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||r.ResultReason.NoMatch===t.result.reason?(this.privRequestSession.onPhraseRecognized(t.offset+t.result.duration),h()):this.privPendingIntentArgs=t,o=!0;break;case"response":if(t=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,t===void 0){if(a.textBody==="")return;t=new r.IntentRecognitionEventArgs(new r.IntentRecognitionResult,0,this.privRequestSession.sessionId)}const g=n.IntentResponse.fromJSON(a.textBody);if(g!==null&&g.topScoringIntent&&g.topScoringIntent.intent){let f=this.privAddedLmIntents[g.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(f=this.privUmbrellaIntent),f){const S=f===void 0||f.intentName===void 0?g.topScoringIntent.intent:f.intentName;let v=t.result.reason;S!==void 0&&(v=r.ResultReason.RecognizedIntent);const m=t.result.properties!==void 0?t.result.properties:new r.PropertyCollection;m.setProperty(r.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,a.textBody),t=new r.IntentRecognitionEventArgs(new r.IntentRecognitionResult(S,t.result.resultId,v,t.result.text,t.result.duration,t.result.offset,void 0,void 0,t.result.errorDetails,t.result.json,m),t.offset,t.sessionId)}}if(this.privRequestSession.onPhraseRecognized(t.offset+t.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,t)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(t.result)}catch(f){this.privErrorCallback&&this.privErrorCallback(f)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}o=!0;break}const p=new e.Deferred;return p.resolve(o),p.promise}cancelRecognition(a,i,t,o,c){const p=new r.PropertyCollection;if(p.setProperty(n.CancellationErrorCodePropertyName,r.CancellationErrorCode[o]),this.privIntentRecognizer.canceled){const d=new r.IntentRecognitionCanceledEventArgs(t,c,o,void 0,void 0,a);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,d)}catch{}}if(this.privSuccessCallback){const d=new r.IntentRecognitionResult(void 0,i,r.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,c,void 0,p);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}}};return ln.IntentServiceRecognizer=u,ln}var vn={},Yu;function Eg(){if(Yu)return vn;Yu=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.IntentResponse=void 0;let e=class xd{constructor(n){n===""?this.privIntentResponse={}:this.privIntentResponse=JSON.parse(n)}static fromJSON(n){return new xd(n)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}};return vn.IntentResponse=e,vn}var is={},ep;function Ig(){return ep||(ep=1,Object.defineProperty(is,"__esModule",{value:!0})),is}var fn={},gn={},tp;function Tg(){if(tp)return gn;tp=1,Object.defineProperty(gn,"__esModule",{value:!0}),gn.ServiceTelemetryListener=void 0;const e=A(),r=Ms();class n{constructor(s,a,i){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=s,this.privAudioSourceId=a,this.privAudioNodeId=i,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(s){s>0&&this.privPhraseLatencies.push(Date.now()-s)}hypothesisReceived(s){s>0&&this.privHypothesisLatencies.push(Date.now()-s)}onEvent(s){this.privIsDisposed||(s instanceof r.RecognitionTriggeredEvent&&s.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:s.eventTime,Name:"ListeningTrigger",Start:s.eventTime}),s instanceof e.AudioStreamNodeAttachingEvent&&s.audioSourceId===this.privAudioSourceId&&s.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=s.eventTime),s instanceof e.AudioStreamNodeAttachedEvent&&s.audioSourceId===this.privAudioSourceId&&s.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=s.eventTime),s instanceof e.AudioSourceErrorEvent&&s.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:s.eventTime,Error:s.error,Name:"Microphone",Start:this.privMicStartTime})),s instanceof e.AudioStreamNodeErrorEvent&&s.audioSourceId===this.privAudioSourceId&&s.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:s.eventTime,Error:s.error,Name:"Microphone",Start:this.privMicStartTime})),s instanceof e.AudioStreamNodeDetachedEvent&&s.audioSourceId===this.privAudioSourceId&&s.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:s.eventTime,Name:"Microphone",Start:this.privMicStartTime})),s instanceof r.ConnectingToServiceEvent&&s.requestId===this.privRequestId&&(this.privConnectionId=s.sessionId),s instanceof e.ConnectionStartEvent&&s.connectionId===this.privConnectionId&&(this.privConnectionStartTime=s.eventTime),s instanceof e.ConnectionEstablishedEvent&&s.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:s.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),s instanceof e.ConnectionEstablishErrorEvent&&s.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:s.eventTime,Error:this.getConnectionError(s.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),s instanceof e.ConnectionMessageReceivedEvent&&s.connectionId===this.privConnectionId&&s.message&&s.message.headers&&s.message.headers.path&&(this.privReceivedMessages[s.message.headers.path]||(this.privReceivedMessages[s.message.headers.path]=new Array),this.privReceivedMessages[s.message.headers.path].length<50&&this.privReceivedMessages[s.message.headers.path].push(s.networkReceivedTime)))}getTelemetry(){const s=new Array;this.privListeningTriggerMetric&&s.push(this.privListeningTriggerMetric),this.privMicMetric&&s.push(this.privMicMetric),this.privConnectionEstablishMetric&&s.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&s.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&s.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const a={Metrics:s,ReceivedMessages:this.privReceivedMessages},i=JSON.stringify(a);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],i}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(s){switch(s){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+s.toString()}}}return gn.ServiceTelemetryListener=n,gn}var rp;function Ag(){if(rp)return fn;rp=1,Object.defineProperty(fn,"__esModule",{value:!0}),fn.RequestSession=void 0;const e=A(),r=Ms(),n=Tg();let u=class{constructor(a){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=a,this.privRequestId=(0,e.createNoDashGuid)(),this.privAudioNodeId=(0,e.createNoDashGuid)(),this.privTurnDeferral=new e.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(a){this.privServiceTelemetryListener&&this.privDetachables.push(a.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new n.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new r.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(a,i){this.privAudioNode=a,this.privIsAudioNodeDetached=!1,i?await this.onComplete():this.onEvent(new r.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(a,i){this.privAuthFetchEventId=a,this.privSessionId=i,this.onEvent(new r.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(a){a&&await this.onComplete()}async onConnectionEstablishCompleted(a,i){if(a===200){this.onEvent(new r.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else a===403&&await this.onComplete()}async onServiceTurnEndResponse(a){this.privTurnDeferral.resolve(),!a||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=(0,e.createNoDashGuid)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new e.Deferred}onHypothesis(a){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(a)))}onPhraseRecognized(a){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(a)),this.onServiceRecognized(a)}onServiceRecognized(a){this.privLastRecoOffset=a,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(a),this.privConnectionAttempts=0}onAudioSent(a){this.privBytesSent+=a,this.privRecognitionBytesSent+=a}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const a of this.privDetachables)await a.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(a){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(a),e.Events.instance.onEvent(a)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}};return fn.RequestSession=u,fn}var Sn={},ss={},np;function wg(){return np||(np=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TentativePhraseResultsOption=e.OutputFormat=e.PhraseExtension=e.PhraseOption=void 0,function(r){r.WordTimings="WordTimings",r.SNR="SNR",r.Pronunciation="Pronunciation",r.WordPronunciation="WordPronunciation",r.WordConfidence="WordConfidence",r.Words="Words",r.Sentiment="Sentiment",r.PronunciationAssessment="PronunciationAssessment",r.ContentAssessment="ContentAssessment",r.PhraseAMScore="PhraseAMScore",r.PhraseLMScore="PhraseLMScore",r.WordAMScore="WordAMScore",r.WordLMScore="WordLMScore",r.RuleTree="RuleTree",r.NBestTimings="NBestTimings",r.DecoderDiagnostics="DecoderDiagnostics",r.DisplayWordTimings="DisplayWordTimings",r.DisplayWords="DisplayWords"}(e.PhraseOption||(e.PhraseOption={})),function(r){r.Graph="Graph",r.Corrections="Corrections",r.Sentiment="Sentiment"}(e.PhraseExtension||(e.PhraseExtension={})),function(r){r.Simple="Simple",r.Detailed="Detailed"}(e.OutputFormat||(e.OutputFormat={})),function(r){r.None="None",r.Always="Always"}(e.TentativePhraseResultsOption||(e.TentativePhraseResultsOption={}))}(ss)),ss}var ip;function _g(){if(ip)return Sn;ip=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.SpeechContext=void 0;const e=W(),r=wg();let n=class{constructor(s){this.privContext={},this.privDynamicGrammar=s}getContext(){return this.privContext}setPronunciationAssessmentParams(s,a,i=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(s)||{},i&&(this.privContext.phraseDetection.mode=e.RecognitionMode.Conversation),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push(r.PhraseOption.PronunciationAssessment),this.privContext.phraseOutput.detailed.options.indexOf(r.PhraseOption.SNR)===-1&&this.privContext.phraseOutput.detailed.options.push(r.PhraseOption.SNR),a&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:a},this.privContext.phraseOutput.detailed.options.push(r.PhraseOption.ContentAssessment))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=r.OutputFormat.Detailed}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=r.OutputFormat.Detailed,this.privContext.phraseOutput.detailed.options.indexOf(r.PhraseOption.WordTimings)===-1&&this.privContext.phraseOutput.detailed.options.push(r.PhraseOption.WordTimings)}setSpeakerDiarizationAudioOffsetMs(s){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=s}toJSON(){const s=this.privDynamicGrammar.generateGrammarObject();return this.privContext.dgi=s,JSON.stringify(this.privContext)}};return Sn.SpeechContext=n,Sn}var mn={},os={},sp;function bg(){return sp||(sp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SubstringMatchType=e.GroupType=void 0,function(r){r.IntentText="IntentText",r.IntentEntity="IntentEntity",r.Generic="Generic",r.People="People",r.Place="Place",r.DynamicEntity="DynamicEntity"}(e.GroupType||(e.GroupType={})),function(r){r.None="None",r.LeftRooted="LeftRooted",r.PartialName="PartialName",r.MiddleOfSentence="MiddleOfSentence"}(e.SubstringMatchType||(e.SubstringMatchType={}))}(os)),os}var op;function Mg(){if(op)return mn;op=1,Object.defineProperty(mn,"__esModule",{value:!0}),mn.DynamicGrammarBuilder=void 0;const e=bg();let r=class{addPhrase(u){this.privPhrases||(this.privPhrases=[]),u instanceof Array?this.privPhrases=this.privPhrases.concat(u):this.privPhrases.push(u)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(u){this.privGrammars||(this.privGrammars=[]),u instanceof Array?this.privGrammars=this.privGrammars.concat(u):this.privGrammars.push(u)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const u={};if(u.referenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const s=[];this.privPhrases.forEach(a=>{s.push({text:a})}),u.groups=[{type:e.GroupType.Generic,items:s}]}return u}};return mn.DynamicGrammarBuilder=r,mn}var Cn={},yn={},Rn={},as={},ap;function Ud(){return ap||(ap=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MessageDataStreamType=e.ActivityPayloadResponse=void 0;class r{constructor(u){this.privActivityResponse=JSON.parse(u)}static fromJSON(u){return new r(u)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}e.ActivityPayloadResponse=r,function(n){n[n.None=0]="None",n[n.TextToSpeechAudio=1]="TextToSpeechAudio"}(e.MessageDataStreamType||(e.MessageDataStreamType={}))}(as)),as}var cp;function Og(){if(cp)return Rn;cp=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.DialogServiceTurnState=void 0;const e=Wn(),r=ke(),n=Ud();let u=class{constructor(a,i){this.privRequestId=i,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=a,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(a,i){return a.messageDataStreamType===n.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=r.AudioOutputStream.createPullStream(),this.privAudioStream.format=i!==void 0?i:e.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}};return Rn.DialogServiceTurnState=u,Rn}var up;function Dg(){if(up)return yn;up=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.DialogServiceTurnStateManager=void 0;const e=J(),r=Og();let n=class{constructor(){this.privTurnMap=new Map}StartTurn(s){if(this.privTurnMap.has(s))throw new e.InvalidOperationError("Service error: There is already a turn with id:"+s);const a=new r.DialogServiceTurnState(this,s);return this.privTurnMap.set(s,a),this.privTurnMap.get(s)}GetTurn(s){return this.privTurnMap.get(s)}CompleteTurn(s){if(!this.privTurnMap.has(s))throw new e.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+s);const a=this.privTurnMap.get(s);return a.complete(),this.privTurnMap.delete(s),a}};return yn.DialogServiceTurnStateManager=n,yn}var cs={},pp;function kg(){return pp||(pp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InvocationSource=void 0,function(r){r.None="None",r.VoiceActivationWithKeyword="VoiceActivationWithKeyword"}(e.InvocationSource||(e.InvocationSource={}))}(cs)),cs}var us={},dp;function zg(){return dp||(dp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.OnRejectAction=e.KeywordDetectionType=void 0,function(r){r.StartTrigger="StartTrigger"}(e.KeywordDetectionType||(e.KeywordDetectionType={})),function(r){r.EndOfTurn="EndOfTurn",r.Continue="Continue"}(e.OnRejectAction||(e.OnRejectAction={}))}(us)),us}var hp;function Ng(){if(hp)return Cn;hp=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.DialogServiceAdapter=void 0;const e=z(),r=Gp(),n=A(),u=Wn(),s=P(),a=Dg(),i=T(),t=Ud(),o=kg(),c=zg(),p=ze();let d=class extends i.ServiceRecognizerBase{constructor(h,g,f,S,v){super(h,g,f,S,v),this.privEvents=new n.EventSource,this.privDialogServiceConnector=v,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new a.DialogServiceTurnStateManager,this.recognizeOverride=(m,C,y)=>this.listenOnce(m,C,y),this.postConnectImplOverride=m=>this.dialogConnectImpl(m),this.configConnectionOverride=m=>this.configConnection(m),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=f,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(m=>{m.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(h){const g=(0,n.createGuid)(),f=(0,n.createNoDashGuid)(),S={context:{interactionId:g},messagePayload:JSON.parse(h),version:.5},v=JSON.stringify(S);await(await this.fetchConnection()).send(new p.SpeechConnectionMessage(n.MessageType.Text,"agent",f,"application/json",v))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s.CancellationReason.Error,s.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(h){const g=new s.PropertyCollection;h.messageType===n.MessageType.Text&&g.setProperty(s.PropertyId.SpeechServiceResponse_JsonResult,h.textBody);let f,S;switch(h.path.toLowerCase()){case"speech.phrase":const m=i.SimpleSpeechPhrase.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(m.Offset+m.Duration),m.RecognitionStatus!==i.RecognitionStatus.TooManyRequests&&m.RecognitionStatus!==i.RecognitionStatus.Error){const w=this.fireEventForResult(m,g);if(this.privLastResult=w.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,w)}catch{}}S=!0;break;case"speech.hypothesis":const C=i.SpeechHypothesis.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);f=new s.SpeechRecognitionResult(this.privRequestSession.requestId,s.ResultReason.RecognizingSpeech,C.Text,C.Duration,C.Offset,C.Language,C.LanguageDetectionConfidence,void 0,void 0,C.asJson(),g),this.privRequestSession.onHypothesis(C.Offset);const y=new s.SpeechRecognitionEventArgs(f,C.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,y)}catch{}S=!0;break;case"speech.keyword":const R=i.SpeechKeyword.fromJSON(h.textBody,this.privRequestSession.currentTurnAudioOffset);f=new s.SpeechRecognitionResult(this.privRequestSession.requestId,R.Status==="Accepted"?s.ResultReason.RecognizedKeyword:s.ResultReason.NoMatch,R.Text,R.Duration,R.Offset,void 0,void 0,void 0,void 0,R.asJson(),g),R.Status!=="Accepted"&&(this.privLastResult=f);const I=new s.SpeechRecognitionEventArgs(f,f.duration,f.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,I)}catch{}S=!0;break;case"audio":{const w=h.requestId.toUpperCase(),E=this.privTurnStateManager.GetTurn(w);try{h.binaryBody?E.audioStream.write(h.binaryBody):E.endAudioStream()}catch{}}S=!0;break;case"response":this.handleResponseMessage(h),S=!0;break}const v=new n.Deferred;return v.resolve(S),v.promise}async cancelRecognition(h,g,f,S,v){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const m=new s.PropertyCollection;m.setProperty(i.CancellationErrorCodePropertyName,s.CancellationErrorCode[S]);const C=new s.SpeechRecognitionCanceledEventArgs(f,v,S,void 0,h);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,C)}catch{}if(this.privSuccessCallback){const y=new s.SpeechRecognitionResult(void 0,s.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,v,void 0,m);try{this.privSuccessCallback(y),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(h,g,f){this.privRecognizerConfig.recognitionMode=h,this.privSuccessCallback=g,this.privErrorCallback=f,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(s.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const S=this.connectImpl(),v=this.sendPreAudioMessages(),m=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),C=await this.privDialogAudioSource.format,y=await this.privDialogAudioSource.deviceInfo,R=new e.ReplayableAudioNode(m,C.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(R,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:y};try{await S,await v}catch(E){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s.CancellationReason.Error,s.CancellationErrorCode.ConnectionFailure,E),Promise.resolve()}const I=new s.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,I),this.sendAudio(R).then(()=>{},async E=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s.CancellationReason.Error,s.CancellationErrorCode.RuntimeError,E)})}dialogConnectImpl(h){return this.privConnectionLoop=this.startMessageLoop(),h}receiveDialogMessageOverride(){const h=new n.Deferred,g=async()=>{try{const f=this.isDisposed(),S=!this.isDisposed()&&this.terminateMessageLoop;if(f||S){h.resolve(void 0);return}const m=await(await this.fetchConnection()).read();if(!m)return g();const C=p.SpeechConnectionMessage.fromConnectionMessage(m);switch(C.path.toLowerCase()){case"turn.start":{const O=C.requestId.toUpperCase(),U=this.privRequestSession.requestId.toUpperCase();O!==U?this.privTurnStateManager.StartTurn(O):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const R=i.SpeechDetected.fromJSON(C.textBody,this.privRequestSession.currentTurnAudioOffset),I=new s.RecognitionEventArgs(R.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,I);break;case"speech.enddetected":let w;C.textBody.length>0?w=C.textBody:w="{ Offset: 0 }";const E=i.SpeechDetected.fromJSON(w,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(E.Offset);const M=new s.RecognitionEventArgs(E.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,M);break;case"turn.end":{const O=C.requestId.toUpperCase(),U=this.privRequestSession.requestId.toUpperCase();if(O!==U)this.privTurnStateManager.CompleteTurn(O);else{const Oe=new s.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,Oe),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(N){this.privErrorCallback&&this.privErrorCallback(N)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(C)||this.serviceEvents&&this.serviceEvents.onEvent(new n.ServiceEvent(C.path.toLowerCase(),C.textBody))}catch{}}return g()}catch{this.terminateMessageLoop=!0,h.resolve()}};return g().catch(f=>{n.Events.instance.onEvent(new n.BackgroundEvent(f))}),h.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(h){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,s.CancellationReason.Error,s.CancellationErrorCode.RuntimeError,h)}return Promise.resolve()}async configConnection(h){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(h,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(h),h)}async sendPreAudioMessages(){const h=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(h,!0),await this.sendAgentContext(h),await this.sendWaveHeader(h)}sendAgentConfig(h){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(s.PropertyId.Conversation_DialogType)===s.DialogServiceConfig.DialogTypes.CustomCommands){const f=this.agentConfig.get();f.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(s.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(f)}this.onEvent(new r.SendingAgentContextMessageEvent(this.agentConfig));const g=this.agentConfig.toJsonString();return this.agentConfigSent=!0,h.send(new p.SpeechConnectionMessage(n.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",g))}}sendAgentContext(h){const g=(0,n.createGuid)(),f=this.privDialogServiceConnector.properties.getProperty(s.PropertyId.Conversation_Speech_Activity_Template),v=JSON.stringify({channelData:"",context:{interactionId:g},messagePayload:typeof f===void 0?void 0:f,version:.5});return h.send(new p.SpeechConnectionMessage(n.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",v))}fireEventForResult(h,g){const f=i.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),S=new s.SpeechRecognitionResult(this.privRequestSession.requestId,f,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,void 0,h.asJson(),g);return new s.SpeechRecognitionEventArgs(S,h.Offset,this.privRequestSession.sessionId)}handleResponseMessage(h){const g=JSON.parse(h.textBody);switch(g.messageType.toLowerCase()){case"message":const f=h.requestId.toUpperCase(),S=t.ActivityPayloadResponse.fromJSON(h.textBody),v=this.privTurnStateManager.GetTurn(f);if(S.conversationId){const y=this.agentConfig.get();y.botInfo.conversationId=S.conversationId,this.agentConfig.set(y)}const m=v.processActivityPayload(S,u.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(s.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),C=new s.ActivityReceivedEventArgs(S.messagePayload,m);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,C)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new s.TurnStatusReceivedEventArgs(h.textBody))}catch{}break;default:n.Events.instance.onEvent(new n.BackgroundEvent(`Unexpected response of type ${g.messageType}. Ignoring.`));break}}onEvent(h){this.privEvents.onEvent(h),n.Events.instance.onEvent(h)}addKeywordContextData(){const h=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(h===void 0)return;const g=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),f=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),S=h.split(";"),v=g===void 0?[]:g.split(";"),m=f===void 0?[]:f.split(";"),C=[];for(let y=0;y<S.length;y++){const R={text:S[y]};y<v.length&&(R.startOffset=Number(v[y])),y<m.length&&(R.duration=Number(m[y])),C.push(R)}this.speechContext.getContext().invocationSource=o.InvocationSource.VoiceActivationWithKeyword,this.speechContext.getContext().keywordDetection=[{clientDetectedKeywords:C,onReject:{action:c.OnRejectAction.EndOfTurn},type:c.KeywordDetectionType.StartTrigger}]}};return Cn.DialogServiceAdapter=d,Cn}var Pn={},lp;function jg(){if(lp)return Pn;lp=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.AgentConfig=void 0;let e=class{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(n){this.iPrivConfig=n}};return Pn.AgentConfig=e,Pn}var ps={},En={},In={},vp;function Os(){if(vp)return In;vp=1,Object.defineProperty(In,"__esModule",{value:!0}),In.ConversationConnectionConfig=void 0;const e=zd();let r=class te extends e.RestConfigBase{static get host(){return te.privHost}static get apiVersion(){return te.privApiVersion}static get clientAppId(){return te.privClientAppId}static get defaultLanguageCode(){return te.privDefaultLanguageCode}static get restPath(){return te.privRestPath}static get webSocketPath(){return te.privWebSocketPath}static get transcriptionEventKeys(){return te.privTranscriptionEventKeys}};return In.ConversationConnectionConfig=r,r.privHost="dev.microsofttranslator.com",r.privRestPath="/capito/room",r.privApiVersion="2.0",r.privDefaultLanguageCode="en-US",r.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15",r.privWebSocketPath="/capito/translate",r.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"],In}var fp;function qg(){if(fp)return En;fp=1,Object.defineProperty(En,"__esModule",{value:!0}),En.ConversationManager=void 0;const e=z(),r=_(),n=P(),u=Os();let s=class{constructor(){this.privRequestParams=u.ConversationConnectionConfig.configParams,this.privErrors=u.ConversationConnectionConfig.restErrors,this.privHost=u.ConversationConnectionConfig.host,this.privApiVersion=u.ConversationConnectionConfig.apiVersion,this.privRestPath=u.ConversationConnectionConfig.restPath,this.privRestAdapter=new e.RestMessageAdapter({})}createOrJoin(i,t,o,c){try{r.Contracts.throwIfNullOrUndefined(i,"args");const p=i.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage,u.ConversationConnectionConfig.defaultLanguageCode),d=i.getProperty(n.PropertyId.ConversationTranslator_Name,"conversation_host"),l=i.getProperty(n.PropertyId.ConversationTranslator_Host,this.privHost),h=i.getProperty(n.PropertyId.ConversationTranslator_CorrelationId),g=i.getProperty(n.PropertyId.SpeechServiceConnection_Key),f=i.getProperty(n.PropertyId.SpeechServiceConnection_Region),S=i.getProperty(n.PropertyId.SpeechServiceAuthorization_Token);r.Contracts.throwIfNullOrWhitespace(p,"languageCode"),r.Contracts.throwIfNullOrWhitespace(d,"nickname"),r.Contracts.throwIfNullOrWhitespace(l,"endpointHost");const v={};v[this.privRequestParams.apiVersion]=this.privApiVersion,v[this.privRequestParams.languageCode]=p,v[this.privRequestParams.nickname]=d;const m={};h&&(m[this.privRequestParams.correlationId]=h),m[this.privRequestParams.clientAppId]=u.ConversationConnectionConfig.clientAppId,t!==void 0?v[this.privRequestParams.roomId]=t:(r.Contracts.throwIfNullOrUndefined(f,this.privErrors.authInvalidSubscriptionRegion),m[this.privRequestParams.subscriptionRegion]=f,g?m[this.privRequestParams.subscriptionKey]=g:S?m[this.privRequestParams.authorization]=`Bearer ${S}`:r.Contracts.throwIfNullOrUndefined(g,this.privErrors.authInvalidSubscriptionKey));const C={};C.headers=m,this.privRestAdapter.options=C;const y=`https://${l}${this.privRestPath}`;this.privRestAdapter.request(e.RestRequestType.Post,y,v,null).then(R=>{const I=e.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,R.headers);if(!R.ok){if(c){let E=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",R.status.toString()),M;try{M=JSON.parse(R.data),E+=` [${M.error.code}: ${M.error.message}]`}catch{E+=` [${R.data}]`}I&&(E+=` ${I}`),c(E)}return}const w=JSON.parse(R.data);if(w&&(w.requestId=I),o){try{o(w)}catch(E){c&&c(E)}o=void 0}}).catch(()=>{})}catch(p){if(c)if(p instanceof Error){const d=p;c(d.name+": "+d.message)}else c(p)}}leave(i,t){return new Promise((o,c)=>{try{r.Contracts.throwIfNullOrUndefined(i,this.privErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrWhitespace(t,this.privErrors.invalidArgs.replace("{arg}","token"));const p=i.getProperty(n.PropertyId.ConversationTranslator_Host,this.privHost),d=i.getProperty(n.PropertyId.ConversationTranslator_CorrelationId),l={};l[this.privRequestParams.apiVersion]=this.privApiVersion,l[this.privRequestParams.sessionToken]=t;const h={};d&&(h[this.privRequestParams.correlationId]=d);const g={};g.headers=h,this.privRestAdapter.options=g;const f=`https://${p}${this.privRestPath}`;this.privRestAdapter.request(e.RestRequestType.Delete,f,l,null).then(S=>{S.ok,o()}).catch(()=>{})}catch(p){if(p instanceof Error){const d=p;c(d.name+": "+d.message)}else c(p)}})}};return En.ConversationManager=s,En}var Ee={},Tn={},An={},wn={},gp;function Wd(){if(gp)return wn;gp=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.ConversationConnectionMessage=void 0;const e=A();let r=class extends e.ConnectionMessage{constructor(u,s,a,i){super(u,s,a,i);const t=JSON.parse(this.textBody);t.type!==void 0&&(this.privConversationMessageType=t.type)}get conversationMessageType(){return this.privConversationMessageType}};return wn.ConversationConnectionMessage=r,wn}var Sp;function Lg(){if(Sp)return An;Sp=1,Object.defineProperty(An,"__esModule",{value:!0}),An.ConversationWebsocketMessageFormatter=void 0;const e=A(),r=Wd();let n=class{toConnectionMessage(s){const a=new e.Deferred;try{if(s.messageType===e.MessageType.Text){const i=new r.ConversationConnectionMessage(s.messageType,s.textContent,{},s.id);a.resolve(i)}else s.messageType===e.MessageType.Binary&&a.resolve(new r.ConversationConnectionMessage(s.messageType,s.binaryContent,void 0,s.id))}catch(i){a.reject(`Error formatting the message. Error: ${i}`)}return a.promise}fromConnectionMessage(s){const a=new e.Deferred;try{if(s.messageType===e.MessageType.Text){const i=`${s.textBody?s.textBody:""}`;a.resolve(new e.RawWebsocketMessage(e.MessageType.Text,i,s.id))}}catch(i){a.reject(`Error formatting the message. ${i}`)}return a.promise}};return An.ConversationWebsocketMessageFormatter=n,An}var mp;function Bg(){if(mp)return Tn;mp=1,Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.ConversationConnectionFactory=void 0;const e=z(),r=A(),n=_(),u=P(),s=K(),a=Os(),i=Lg();let t=class extends s.ConnectionFactoryBase{create(c,p,d){const l=c.parameters.getProperty(u.PropertyId.ConversationTranslator_Host,a.ConversationConnectionConfig.host),h=c.parameters.getProperty(u.PropertyId.ConversationTranslator_CorrelationId,(0,r.createGuid)()),g=`wss://${l}${a.ConversationConnectionConfig.webSocketPath}`,f=c.parameters.getProperty(u.PropertyId.ConversationTranslator_Token,void 0);n.Contracts.throwIfNullOrUndefined(f,"token");const S={};S[a.ConversationConnectionConfig.configParams.apiVersion]=a.ConversationConnectionConfig.apiVersion,S[a.ConversationConnectionConfig.configParams.token]=f,S[a.ConversationConnectionConfig.configParams.correlationId]=h;const v=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new e.WebsocketConnection(g,S,{},new i.ConversationWebsocketMessageFormatter,e.ProxyInfo.fromRecognizerConfig(c),v,d))}};return Tn.ConversationConnectionFactory=t,Tn}var _n={},bn={},Cp;function Fg(){if(Cp)return bn;Cp=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.ConversationRequestSession=void 0;const e=A();let r=class{constructor(u){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=u,this.privRequestId=(0,e.createNoDashGuid)(),this.privRequestCompletionDeferral=new e.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(u,s){this.privSessionId=s}onAuthCompleted(u){u&&this.onComplete()}onConnectionEstablishCompleted(u){u!==200&&u===403&&this.onComplete()}onServiceTurnEndResponse(u){u?this.privRequestId=(0,e.createNoDashGuid)():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const u of this.privDetachables)await u.detach()}}onComplete(){}};return bn.ConversationRequestSession=r,bn}var j={},yp;function Vd(){if(yp)return j;yp=1,Object.defineProperty(j,"__esModule",{value:!0}),j.ConversationReceivedTranslationEventArgs=j.ParticipantsListEventArgs=j.ParticipantAttributeEventArgs=j.ParticipantEventArgs=j.LockRoomEventArgs=j.MuteAllEventArgs=void 0;const e=P();class r extends e.SessionEventArgs{constructor(o,c){super(c),this.privIsMuted=o}get isMuted(){return this.privIsMuted}}j.MuteAllEventArgs=r;class n extends e.SessionEventArgs{constructor(o,c){super(c),this.privIsLocked=o}get isMuted(){return this.privIsLocked}}j.LockRoomEventArgs=n;class u extends e.SessionEventArgs{constructor(o,c){super(c),this.privParticipant=o}get participant(){return this.privParticipant}}j.ParticipantEventArgs=u;class s extends e.SessionEventArgs{constructor(o,c,p,d){super(d),this.privKey=c,this.privValue=p,this.privParticipantId=o}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}j.ParticipantAttributeEventArgs=s;class a extends e.SessionEventArgs{constructor(o,c,p,d,l,h,g,f,S){super(S),this.privRoomId=o,this.privSessionToken=c,this.privTranslateTo=p,this.privProfanityFilter=d,this.privRoomProfanityFilter=l,this.privIsRoomLocked=h,this.privIsRoomLocked=g,this.privParticipants=f}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}j.ParticipantsListEventArgs=a;class i{constructor(o,c,p){this.privPayload=c,this.privCommand=o,this.privSessionId=p}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return j.ConversationReceivedTranslationEventArgs=i,j}var Z={},Rp;function Hd(){if(Rp)return Z;Rp=1,Object.defineProperty(Z,"__esModule",{value:!0}),Z.ConversationTranslatorCommandTypes=Z.ConversationTranslatorMessageTypes=Z.InternalParticipants=void 0;class e{constructor(n=[],u){this.participants=n,this.meId=u}addOrUpdateParticipant(n){if(n===void 0)return;const u=this.getParticipantIndex(n.id);return u>-1?this.participants.splice(u,1,n):this.participants.push(n),this.getParticipant(n.id)}getParticipantIndex(n){return this.participants.findIndex(u=>u.id===n)}getParticipant(n){return this.participants.find(u=>u.id===n)}deleteParticipant(n){this.participants=this.participants.filter(u=>u.id!==n)}get host(){return this.participants.find(n=>n.isHost===!0)}get me(){return this.getParticipant(this.meId)}}return Z.InternalParticipants=e,Z.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"},Z.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"},Z}var ds={},Mn={},Pp;function xg(){if(Pp)return Mn;Pp=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.CommandResponsePayload=void 0;const e=n=>JSON.parse(n);let r=class $d{constructor(u){this.privCommandResponse=e(u)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(u){return new $d(u)}};return Mn.CommandResponsePayload=r,Mn}var Ie={},Ep;function Ug(){if(Ep)return Ie;Ep=1,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.ParticipantPayloadResponse=Ie.ParticipantsListPayloadResponse=void 0;const e=s=>JSON.parse(s),r=s=>JSON.parse(s);class n{constructor(a){this.privParticipantsPayloadResponse=e(a)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(a){return new n(a)}}Ie.ParticipantsListPayloadResponse=n;class u{constructor(a){this.privParticipantPayloadResponse=r(a)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(a){return new u(a)}}return Ie.ParticipantPayloadResponse=u,Ie}var Te={},Ip;function Wg(){if(Ip)return Te;Ip=1,Object.defineProperty(Te,"__esModule",{value:!0}),Te.TextResponsePayload=Te.SpeechResponsePayload=void 0;const e=s=>JSON.parse(s),r=s=>JSON.parse(s);class n{constructor(a){this.privSpeechResponse=e(a)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(a){return new n(a)}}Te.SpeechResponsePayload=n;class u{constructor(a){this.privTextResponse=r(a)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(a){return new u(a)}}return Te.TextResponsePayload=u,Te}var Tp;function Vg(){return Tp||(Tp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.TextResponsePayload=e.SpeechResponsePayload=e.ParticipantPayloadResponse=e.ParticipantsListPayloadResponse=e.CommandResponsePayload=void 0;var r=xg();Object.defineProperty(e,"CommandResponsePayload",{enumerable:!0,get:function(){return r.CommandResponsePayload}});var n=Ug();Object.defineProperty(e,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return n.ParticipantsListPayloadResponse}}),Object.defineProperty(e,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return n.ParticipantPayloadResponse}});var u=Wg();Object.defineProperty(e,"SpeechResponsePayload",{enumerable:!0,get:function(){return u.SpeechResponsePayload}}),Object.defineProperty(e,"TextResponsePayload",{enumerable:!0,get:function(){return u.TextResponsePayload}})}(ds)),ds}var Ap;function Hg(){if(Ap)return _n;Ap=1,Object.defineProperty(_n,"__esModule",{value:!0}),_n.ConversationServiceAdapter=void 0;const e=A(),r=P(),n=T(),u=Wd(),s=Fg(),a=Vd(),i=Hd(),t=Vg();let o=class extends n.ServiceRecognizerBase{constructor(p,d,l,h,g){super(p,d,l,h,g),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=g,this.privConversationAuthentication=p,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=f=>this.conversationConnectImpl(f),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new s.ConversationRequestSession((0,e.createNoDashGuid)()),this.privConversationConnectionFactory=d,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(p){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(p),await super.dispose(p)}async sendMessage(p){return(await this.fetchConnection()).send(new u.ConversationConnectionMessage(e.MessageType.Text,p))}async sendMessageAsync(p){await(await this.fetchConnection()).send(new u.ConversationConnectionMessage(e.MessageType.Text,p))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(p,d,l,h,g){this.terminateMessageLoop=!0;const f=new r.ConversationTranslationCanceledEventArgs(l,g,h,void 0,p);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,f)}catch{}}async conversationConnectImpl(p){return this.privConnectionLoop=this.startMessageLoop(),p}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const p=new e.Deferred;try{const l=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return p.resolve(),Promise.resolve();if(!l)return this.receiveConversationMessageOverride();const h=this.privConversationRequestSession.sessionId,g=l.conversationMessageType.toLowerCase();let f=!1;try{switch(g){case"info":case"participant_command":case"command":const S=t.CommandResponsePayload.fromJSON(l.textBody);switch(S.command.toLowerCase()){case"participantlist":const I=t.ParticipantsListPayloadResponse.fromJSON(l.textBody),w=I.participants.map(N=>({avatar:N.avatar,displayName:N.nickname,id:N.participantId,isHost:N.ishost,isMuted:N.ismuted,isUsingTts:N.usetts,preferredLanguage:N.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new a.ParticipantsListEventArgs(I.roomid,I.token,I.translateTo,I.profanityFilter,I.roomProfanityFilter,I.roomLocked,I.muteAll,w,h));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,i.ConversationTranslatorCommandTypes.setTranslateToLanguages,S.value,h));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,i.ConversationTranslatorCommandTypes.setProfanityFiltering,S.value,h));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,i.ConversationTranslatorCommandTypes.setMute,S.value,h));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new a.MuteAllEventArgs(S.value,h));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new r.ConversationExpirationEventArgs(S.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,i.ConversationTranslatorCommandTypes.setUseTTS,S.value,h));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new a.LockRoomEventArgs(S.value,h));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,i.ConversationTranslatorCommandTypes.changeNickname,S.value,h));break;case"joinsession":const E=t.ParticipantPayloadResponse.fromJSON(l.textBody),M={avatar:E.avatar,displayName:E.nickname,id:E.participantId,isHost:E.ishost,isMuted:E.ismuted,isUsingTts:E.usetts,preferredLanguage:E.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new a.ParticipantEventArgs(M,h));break;case"leavesession":const O={id:S.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new a.ParticipantEventArgs(O,h));break;case"disconnectsession":const U={id:S.participantId};break;case"token":const Oe=new n.CognitiveTokenAuthentication(()=>{const N=S.token;return Promise.resolve(N)},()=>{const N=S.token;return Promise.resolve(N)});this.authentication=Oe,this.privConversationServiceConnector.onToken(Oe);break;default:break}break;case"partial":case"final":const v=t.SpeechResponsePayload.fromJSON(l.textBody),m=g==="final"?r.ResultReason.TranslatedParticipantSpeech:r.ResultReason.TranslatingParticipantSpeech,C=new r.ConversationTranslationResult(v.participantId,this.getTranslations(v.translations),v.language,v.id,m,v.recognition,void 0,void 0,l.textBody,void 0);v.isFinal?((C.text!==void 0&&C.text.length>0||v.id===this.privLastPartialUtteranceId)&&(f=!0),f&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(i.ConversationTranslatorMessageTypes.final,C,h))):C.text!==void 0&&(this.privLastPartialUtteranceId=v.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(i.ConversationTranslatorMessageTypes.partial,C,h)));break;case"translated_message":const y=t.TextResponsePayload.fromJSON(l.textBody),R=new r.ConversationTranslationResult(y.participantId,this.getTranslations(y.translations),y.language,void 0,void 0,y.originalText,void 0,void 0,void 0,l.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(i.ConversationTranslatorMessageTypes.instantMessage,R,h));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return p.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const p=this.receiveConversationMessageOverride();try{return await p}catch(d){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,d),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(p=>p.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(p=>p),this.privConnectionConfigPromise)}getTranslations(p){let d;if(p!==void 0){d=new r.Translations;for(const l of p)d.set(l.lang,l.translation)}return d}};return _n.ConversationServiceAdapter=o,_n}var wp;function $g(){if(wp)return Ee;wp=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.ConversationTranslatorRecognizer=Ee.ConversationRecognizerFactory=void 0;const e=T(),r=A(),n=_(),u=P(),s=Bg(),a=Hg();class i{static fromConfig(c,p,d){return new t(c,p,d)}}Ee.ConversationRecognizerFactory=i;let t=class extends u.Recognizer{constructor(c,p,d){const l=p;n.Contracts.throwIfNull(l,"speechConfig");const h=c;n.Contracts.throwIfNull(h,"conversationImpl"),super(d,l.properties,new s.ConversationConnectionFactory),this.privConversation=h,this.privIsDisposed=!1,this.privProperties=l.properties.clone(),this.privConnection=u.Connection.fromRecognizer(this),this.privProperties.getProperty(u.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=r.Timeout.setTimeout,this.privClearTimeout=r.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(c){this.privConnection.connected=c}set disconnected(c){this.privConnection.disconnected=c}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(c,p,d){try{n.Contracts.throwIfDisposed(this.privIsDisposed),n.Contracts.throwIfNullOrWhitespace(c,"token"),this.privReco.conversationTranslatorToken=c,this.resetConversationTimeout(),this.privReco.connectAsync(p,d)}catch(l){if(d)if(l instanceof Error){const h=l;d(h.name+": "+h.message)}else d(l)}}disconnect(c,p){try{n.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{c&&c()},d=>{p&&p(d)})}catch(d){if(p)if(d instanceof Error){const l=d;p(l.name+": "+l.message)}else p(d);this.dispose(!0).catch(l=>{r.Events.instance.onEvent(new r.BackgroundEvent(l))})}}sendRequest(c,p,d){try{n.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(c,p,d)}catch(l){if(d)if(l instanceof Error){const h=l;d(h.name+": "+h.message)}else d(l);this.dispose(!0).catch(h=>{r.Events.instance.onEvent(new r.BackgroundEvent(h))})}}onToken(c){this.privConversation.onToken(c)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(c){this.privIsDisposed||c&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(c))}createRecognizerConfig(c){return new e.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,p,d,l){const h=d;return new a.ConversationServiceAdapter(c,p,h,l,this)}sendMessage(c,p,d){const l=this.privReco;((g,f,S)=>{g!==void 0?g.then(()=>{try{f&&f()}catch(v){S&&S(`'Unhandled error on promise callback: ${v}'`)}},v=>{try{S&&S(v)}catch{}}):S&&S("Null promise")})(l.sendMessageAsync(c),p,d),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return Ee.ConversationTranslatorRecognizer=t,Ee}var On={},_p;function Kg(){if(_p)return On;_p=1,Object.defineProperty(On,"__esModule",{value:!0}),On.TranscriberRecognizer=void 0;const e=A(),r=_(),n=P(),u=T(),s=W();let a=class extends n.Recognizer{constructor(t,o){const c=t;r.Contracts.throwIfNull(c,"speechTranslationConfig");const p=o;r.Contracts.throwIfNull(p,"audioConfigImpl"),r.Contracts.throwIfNullOrWhitespace(c.speechRecognitionLanguage,n.PropertyId[n.PropertyId.SpeechServiceConnection_RecoLanguage]),super(o,c.properties,new u.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(n.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(t){r.Contracts.throwIfNullOrWhitespace(t,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,t)}set conversation(t){r.Contracts.throwIfNullOrUndefined(t,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=t}getConversationInfo(){return r.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(t){r.Contracts.throwIfNullOrUndefined(t,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=t}getMeetingInfo(){return r.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(t,o){(0,e.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(s.RecognitionMode.Conversation),t,o)}stopContinuousRecognitionAsync(t,o){(0,e.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),t,o)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(t,o){const c=this.privReco;r.Contracts.throwIfNullOrUndefined(c,"serviceRecognizer"),await c.sendSpeechEventAsync(t,o)}async pushMeetingEvent(t,o){const c=this.privReco;r.Contracts.throwIfNullOrUndefined(c,"serviceRecognizer"),await c.sendMeetingSpeechEventAsync(t,o)}async enforceAudioGating(){const c=(await this.audioConfig.format).channels;if(c===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(c!==8)throw new Error(`Unsupported audio configuration: Detected ${c}-channel audio`)}connectMeetingCallbacks(t){this.isMeetingRecognizer=!0,this.canceled=(o,c)=>{t.canceled&&t.canceled(t,c)},this.recognizing=(o,c)=>{t.transcribing&&t.transcribing(t,c)},this.recognized=(o,c)=>{t.transcribed&&t.transcribed(t,c)},this.sessionStarted=(o,c)=>{t.sessionStarted&&t.sessionStarted(t,c)},this.sessionStopped=(o,c)=>{t.sessionStopped&&t.sessionStopped(t,c)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(t){this.privDisposedRecognizer||(t&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(t))}createRecognizerConfig(t){return new u.RecognizerConfig(t,this.properties)}createServiceRecognizer(t,o,c,p){const d=c;return new u.TranscriptionServiceRecognizer(t,o,d,p,this)}};return On.TranscriberRecognizer=a,On}var bp;function Jg(){return bp||(bp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InternalParticipants=e.ConversationTranslatorMessageTypes=e.ConversationTranslatorCommandTypes=e.ParticipantsListEventArgs=e.ParticipantEventArgs=e.ParticipantAttributeEventArgs=e.MuteAllEventArgs=e.LockRoomEventArgs=e.ConversationReceivedTranslationEventArgs=e.TranscriberRecognizer=e.ConversationRecognizerFactory=e.ConversationConnectionConfig=e.ConversationManager=void 0;var r=qg();Object.defineProperty(e,"ConversationManager",{enumerable:!0,get:function(){return r.ConversationManager}});var n=Os();Object.defineProperty(e,"ConversationConnectionConfig",{enumerable:!0,get:function(){return n.ConversationConnectionConfig}});var u=$g();Object.defineProperty(e,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return u.ConversationRecognizerFactory}});var s=Kg();Object.defineProperty(e,"TranscriberRecognizer",{enumerable:!0,get:function(){return s.TranscriberRecognizer}});var a=Vd();Object.defineProperty(e,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return a.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(e,"LockRoomEventArgs",{enumerable:!0,get:function(){return a.LockRoomEventArgs}}),Object.defineProperty(e,"MuteAllEventArgs",{enumerable:!0,get:function(){return a.MuteAllEventArgs}}),Object.defineProperty(e,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return a.ParticipantAttributeEventArgs}}),Object.defineProperty(e,"ParticipantEventArgs",{enumerable:!0,get:function(){return a.ParticipantEventArgs}}),Object.defineProperty(e,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return a.ParticipantsListEventArgs}});var i=Hd();Object.defineProperty(e,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return i.ConversationTranslatorCommandTypes}}),Object.defineProperty(e,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return i.ConversationTranslatorMessageTypes}}),Object.defineProperty(e,"InternalParticipants",{enumerable:!0,get:function(){return i.InternalParticipants}})}(ps)),ps}var hs={},Mp;function Kd(){return Mp||(Mp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesisAudioMetadata=e.MetadataType=void 0,function(n){n.WordBoundary="WordBoundary",n.Bookmark="Bookmark",n.Viseme="Viseme",n.SentenceBoundary="SentenceBoundary",n.SessionEnd="SessionEnd",n.AvatarSignal="TalkingAvatarSignal"}(e.MetadataType||(e.MetadataType={}));class r{constructor(u){this.privSynthesisAudioMetadata=JSON.parse(u)}static fromJSON(u){return new r(u)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}e.SynthesisAudioMetadata=r}(hs)),hs}var Dn={},$={},Op;function Gg(){if(Op)return $;Op=1,Object.defineProperty($,"__esModule",{value:!0}),$.SynthesisStartedEvent=$.ConnectingToSynthesisServiceEvent=$.SynthesisTriggeredEvent=$.SpeechSynthesisEvent=void 0;const e=A();class r extends e.PlatformEvent{constructor(i,t,o=e.EventType.Info){super(i,o),this.privRequestId=t}get requestId(){return this.privRequestId}}$.SpeechSynthesisEvent=r;class n extends r{constructor(i,t,o){super("SynthesisTriggeredEvent",i),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=o}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}$.SynthesisTriggeredEvent=n;class u extends r{constructor(i,t){super("ConnectingToSynthesisServiceEvent",i),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}$.ConnectingToSynthesisServiceEvent=u;class s extends r{constructor(i,t){super("SynthesisStartedEvent",i),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}return $.SynthesisStartedEvent=s,$}var Dp;function Qg(){if(Dp)return Dn;Dp=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.SynthesisTurn=void 0;const e=A(),r=ke(),n=P(),u=Kd(),s=Gg();let a=class Es{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,e.createNoDashGuid)(),this.privTurnDeferral=new e.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(t){this.privStreamId=t}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(t){this.privAudioOutputFormat=t}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const t=new n.PropertyCollection;return t.setProperty(n.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),t}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const t=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(t),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(t,o,c,p){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=t,this.privRawText=o,this.privIsSSML=c,this.privAudioOutputStream=new r.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",p!==void 0&&(this.privTurnAudioDestination=p,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new s.SynthesisTriggeredEvent(this.requestId,void 0,p===void 0?void 0:p.id()))}onPreConnectionStart(t){this.privAuthFetchEventId=t,this.onEvent(new s.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(t){t&&this.onComplete()}onConnectionEstablishCompleted(t){if(t===200){this.onEvent(new s.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else t===403&&this.onComplete()}onServiceResponseMessage(t){const o=JSON.parse(t);this.streamId=o.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(t){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new e.Deferred;const o=JSON.parse(t);o.webrtc&&(this.privWebRTCSDP=o.webrtc.connectionString)}onAudioChunkReceived(t){this.isSynthesizing&&(this.privAudioOutputStream.write(t),this.privBytesReceived+=t.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(t))}onTextBoundaryEvent(t){this.updateTextOffset(t.Data.text.Text,t.Type)}onVisemeMetadataReceived(t){t.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=t.Data.AnimationChunk)}onSessionEnd(t){this.privAudioDuration=t.Data.Offset}async constructSynthesisResult(){const t=await this.getAllReceivedAudioWithHeader();return new n.SpeechSynthesisResult(this.requestId,n.ResultReason.SynthesizingAudioCompleted,t,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const t=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",t}onEvent(t){e.Events.instance.onEvent(t)}static isXmlTag(t){return t.length>=2&&t[0]==="<"&&t[t.length-1]===">"}updateTextOffset(t,o){o===u.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(t,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+t.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!Es.isXmlTag(t)&&this.updateTextOffset(t,o))):(this.privSentenceOffset=this.privRawText.indexOf(t,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+t.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!Es.isXmlTag(t)&&this.updateTextOffset(t,o)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(t){return this.privRawText.indexOf("<",t+1)>this.privRawText.indexOf(">",t+1)}};return Dn.SynthesisTurn=a,Dn}var kn={},kp;function Xg(){if(kp)return kn;kp=1,Object.defineProperty(kn,"__esModule",{value:!0}),kn.SynthesisAdapterBase=void 0;const e=A(),r=P(),n=T(),u=ze();let s=class{constructor(i,t,o,c){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!i)throw new e.ArgumentNullError("authentication");if(!t)throw new e.ArgumentNullError("connectionFactory");if(!o)throw new e.ArgumentNullError("synthesizerConfig");this.privAuthentication=i,this.privConnectionFactory=t,this.privSynthesizerConfig=o,this.privIsDisposed=!1,this.privSessionAudioDestination=c,this.privSynthesisTurn=new n.SynthesisTurn,this.privConnectionEvents=new e.EventSource,this.privServiceEvents=new e.EventSource,this.privSynthesisContext=new n.SynthesisContext,this.privAgentConfig=new n.AgentConfig,this.connectionEvents.attach(p=>{if(p.name==="ConnectionClosedEvent"){const d=p;d.statusCode!==1e3&&this.cancelSynthesisLocal(r.CancellationReason.Error,d.statusCode===1007?r.CancellationErrorCode.BadRequestParameters:r.CancellationErrorCode.ConnectionFailure,`${d.reason} websocket error code: ${d.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(i){this.privActivityTemplate=i}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(i){this.privAudioOutputFormat=i,this.privSynthesisTurn.audioOutputFormat=i,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=i),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=i)}isDisposed(){return this.privIsDisposed}async dispose(i){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(i)}async connect(){await this.connectImpl()}async sendNetworkMessage(i,t){const o=typeof t=="string"?e.MessageType.Text:e.MessageType.Binary,c=typeof t=="string"?"application/json":"";return(await this.fetchConnection()).send(new u.SpeechConnectionMessage(o,i,this.privSynthesisTurn.requestId,c,t))}async Speak(i,t,o,c,p,d){let l;if(t?l=i:l=this.privSynthesizer.buildSsml(i),this.speakOverride!==void 0)return this.speakOverride(l,o,c,p);this.privSuccessCallback=c,this.privErrorCallback=p,this.privSynthesisTurn.startNewSynthesis(o,i,t,d);try{await this.connectImpl();const h=await this.fetchConnection();await this.sendSynthesisContext(h),await this.sendSsmlMessage(h,l,o),this.onSynthesisStarted(o),this.receiveMessage()}catch(h){return this.cancelSynthesisLocal(r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,h),Promise.reject(h)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new u.SpeechConnectionMessage(e.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(i,t,o,c){const p=new r.PropertyCollection;p.setProperty(n.CancellationErrorCodePropertyName,r.CancellationErrorCode[o]);const d=new r.SpeechSynthesisResult(i,r.ResultReason.Canceled,void 0,c,p);if(this.onSynthesisCancelled(d),this.privSuccessCallback)try{this.privSuccessCallback(d)}catch{}}cancelSynthesisLocal(i,t,o){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,i,t,o))}processTypeSpecificMessages(i){return!0}async receiveMessage(){try{const t=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!t)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const o=u.SpeechConnectionMessage.fromConnectionMessage(t);if(o.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(o.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(o.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(o.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===o.streamId.toLowerCase()&&o.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(o.binaryBody),this.onSynthesizing(o.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(o.binaryBody));break;case"audio.metadata":const c=n.SynthesisAudioMetadata.fromJSON(o.textBody).Metadata;for(const d of c)switch(d.Type){case n.MetadataType.WordBoundary:case n.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(d);const l=new r.SpeechSynthesisWordBoundaryEventArgs(d.Data.Offset,d.Data.Duration,d.Data.text.Text,d.Data.text.Length,d.Type===n.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,d.Data.text.BoundaryType);this.onWordBoundary(l);break;case n.MetadataType.Bookmark:const h=new r.SpeechSynthesisBookmarkEventArgs(d.Data.Offset,d.Data.Bookmark);this.onBookmarkReached(h);break;case n.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(d),d.Data.IsLastAnimation){const g=new r.SpeechSynthesisVisemeEventArgs(d.Data.Offset,d.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(g)}break;case n.MetadataType.AvatarSignal:this.onAvatarEvent(d);break;case n.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(d);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let p;try{p=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(p)}catch(d){this.privErrorCallback&&this.privErrorCallback(d)}this.onSynthesisCompleted(p);break;default:this.processTypeSpecificMessages(o)||this.privServiceEvents&&this.serviceEvents.onEvent(new e.ServiceEvent(o.path.toLowerCase(),o.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(i){this.setSynthesisContextSynthesisSection();const t=this.synthesisContext.toJSON();if(t)return i.send(new u.SpeechConnectionMessage(e.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t))}setSpeechConfigSynthesisSection(){}connectImpl(i=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(o=>o.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=(0,e.createNoDashGuid)(),this.privConnectionId=(0,e.createNoDashGuid)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const t=i?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.then(async o=>{this.privSynthesisTurn.onAuthCompleted(!1);const c=await this.privConnectionFactory.create(this.privSynthesizerConfig,o,this.privConnectionId);c.events.attach(d=>{this.connectionEvents.onEvent(d)});const p=await c.open();return p.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.resolve(c)):p.statusCode===403&&!i?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(p.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${p.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Url)} Reason: ${p.reason}`))},o=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(o)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(i,t){if(t)return i.send(new u.SpeechConnectionMessage(e.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t))}sendSsmlMessage(i,t,o){return i.send(new u.SpeechConnectionMessage(e.MessageType.Text,"ssml",o,"application/ssml+xml",t))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(i=>i.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const i=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(i):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(i,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),i)}onAvatarEvent(i){}onSynthesisStarted(i){}onSynthesizing(i){}onSynthesisCancelled(i){}onSynthesisCompleted(i){}onWordBoundary(i){}onVisemeReceived(i){}onBookmarkReached(i){}};return kn.SynthesisAdapterBase=s,s.telemetryDataEnabled=!0,kn}var zn={},zp;function Zg(){if(zp)return zn;zp=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.AvatarSynthesisAdapter=void 0;const e=P(),r=T();let n=class extends r.SynthesisAdapterBase{constructor(s,a,i,t,o){super(s,a,i,void 0),this.privAvatarSynthesizer=t,this.privSynthesizer=t,this.privAvatarConfig=o}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:this.privAvatarConfig.videoFormat?.bitrate,codec:this.privAvatarConfig.videoFormat?.codec,crop:{bottomRight:{x:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.bottomRight?.y},topLeft:{x:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.x,y:this.privAvatarConfig.videoFormat?.cropRange?.topLeft?.y}},resolution:{height:this.privAvatarConfig.videoFormat?.height,width:this.privAvatarConfig.videoFormat?.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(e.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:this.privAvatarConfig.backgroundImage?.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(s){if(this.privAvatarSynthesizer.avatarEventReceived){const a=new e.AvatarEventArgs(s.Data.Offset,s.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,a)}catch{}}}};return zn.AvatarSynthesisAdapter=n,zn}var Nn={},Np;function Yg(){if(Np)return Nn;Np=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.SpeechSynthesisAdapter=void 0;const e=P(),r=T();let n=class extends r.SynthesisAdapterBase{constructor(s,a,i,t,o){super(s,a,i,o),this.privSpeechSynthesizer=t,this.privSynthesizer=t}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(s){const a=new e.SpeechSynthesisEventArgs(new e.SpeechSynthesisResult(s,e.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,a)}onSynthesizing(s){if(this.privSpeechSynthesizer.synthesizing)try{const a=this.privSynthesisTurn.audioOutputFormat.addHeader(s),i=new e.SpeechSynthesisEventArgs(new e.SpeechSynthesisResult(this.privSynthesisTurn.requestId,e.ResultReason.SynthesizingAudio,a));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,i)}catch{}}onSynthesisCancelled(s){if(this.privSpeechSynthesizer.SynthesisCanceled){const a=new e.SpeechSynthesisEventArgs(s);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,a)}catch{}}}onSynthesisCompleted(s){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new e.SpeechSynthesisEventArgs(s))}catch{}}onWordBoundary(s){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,s)}catch{}}onVisemeReceived(s){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,s)}catch{}}onBookmarkReached(s){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,s)}catch{}}};return Nn.SpeechSynthesisAdapter=n,Nn}var jn={},jp;function eS(){if(jp)return jn;jp=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.SynthesisRestAdapter=void 0;const e=z(),r=P(),n=K(),u=q();let s=class{constructor(i,t){let o=i.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!o){const p=i.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,"westus"),d=n.ConnectionFactoryBase.getHostSuffix(p);o=i.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,`https://${p}.tts.speech${d}`)}this.privUri=`${o}/cognitiveservices/voices/list`;const c=e.RestConfigBase.requestOptions;this.privRestAdapter=new e.RestMessageAdapter(c),this.privAuthentication=t}getVoicesList(i){return this.privRestAdapter.setHeaders(u.HeaderNames.ConnectionId,i),this.privAuthentication.fetch(i).then(t=>(this.privRestAdapter.setHeaders(t.headerName,t.token),this.privRestAdapter.request(e.RestRequestType.Get,this.privUri)))}};return jn.SynthesisRestAdapter=s,jn}var ls={},qp;function tS(){return qp||(qp=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SynthesizerConfig=e.SynthesisServiceType=void 0;const r=T();var n;(function(s){s[s.Standard=0]="Standard",s[s.Custom=1]="Custom"})(n=e.SynthesisServiceType||(e.SynthesisServiceType={}));class u{constructor(a,i){this.privSynthesisServiceType=n.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=a||new r.SpeechServiceConfig(new r.Context(null)),this.privParameters=i}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(a){this.privSynthesisServiceType=a}set synthesisVideoSection(a){this.privSpeechServiceConfig.Context.synthesis={video:a}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}e.SynthesizerConfig=u}(ls)),ls}var qn={},Lp;function rS(){if(Lp)return qn;Lp=1,Object.defineProperty(qn,"__esModule",{value:!0}),qn.SynthesisContext=void 0;const e=P();let r=class{constructor(){this.privContext={}}setSection(u,s){this.privContext[u]=s}set audioOutputFormat(u){this.privAudioOutputFormat=u}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(u){const s=this.buildSynthesisContext(u);this.setSection("synthesis",s)}buildSynthesisContext(u){return{audio:{metadataOptions:{bookmarkEnabled:!!u?.bookmarkReached,punctuationBoundaryEnabled:u?.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!u?.wordBoundary),sentenceBoundaryEnabled:u?.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!u?.visemeReceived,wordBoundaryEnabled:u?.properties.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!u?.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:u?.autoDetectSourceLanguage}}}};return qn.SynthesisContext=r,qn}var Ln={},Bp;function nS(){if(Bp)return Ln;Bp=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.SpeakerRecognitionConfig=void 0;const e=T();let r=class{constructor(u,s){this.privContext=u||new e.Context(null),this.privParameters=s}get parameters(){return this.privParameters}get Context(){return this.privContext}};return Ln.SpeakerRecognitionConfig=r,Ln}var Bn={},Fp;function iS(){if(Fp)return Bn;Fp=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.SpeakerServiceRecognizer=void 0;const e=z(),r=A(),n=P(),u=T(),s=ze();let a=class extends u.ServiceRecognizerBase{constructor(t,o,c,p,d){super(t,o,c,p,d),this.privSpeakerRecognizer=d,this.privSpeakerAudioSource=c,this.recognizeSpeaker=l=>this.recognizeSpeakerOnce(l),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(t){let o=!1;const c=new n.PropertyCollection;switch(t.messageType===r.MessageType.Text&&c.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,t.textBody),t.path.toLowerCase()){case"speaker.response":const d=JSON.parse(t.textBody);let l;d.status.statusCode.toLowerCase()!=="success"?l=new n.SpeakerRecognitionResult(d,n.ResultReason.Canceled,n.CancellationErrorCode.ServiceError,d.status.reason):l=new n.SpeakerRecognitionResult(d,n.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(l),o=!0;break}const p=new r.Deferred;return p.resolve(o),p.promise}cancelRecognition(t,o,c,p,d){if(new n.PropertyCollection().setProperty(u.CancellationErrorCodePropertyName,n.CancellationErrorCode[p]),this.privResultDeferral){const h=new n.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:d,reason:d}},n.ResultReason.Canceled,p,d);try{this.privResultDeferral.resolve(h)}catch(g){this.privResultDeferral.reject(g)}}}async recognizeSpeakerOnce(t){this.privSpeakerModel=t,this.voiceProfileType=t.scenario,this.privResultDeferral||(this.privResultDeferral=new r.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(n.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const o=this.connectImpl(),c=this.sendPreAudioMessages(this.extractSpeakerContext(t)),p=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),d=await this.privSpeakerAudioSource.format,l=await this.privSpeakerAudioSource.deviceInfo,h=new e.ReplayableAudioNode(p,d.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(h,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:l};try{await o,await c}catch(S){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.ConnectionFailure,S)}const g=new n.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,g),this.receiveMessage(),this.sendAudio(h).then(()=>{},S=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.RuntimeError,S)}),this.privResultDeferral.promise}async sendPreAudioMessages(t){const o=await this.fetchConnection();await this.sendSpeakerRecognition(o,t)}async sendSpeakerRecognition(t,o){const c=JSON.stringify(o);return t.send(new s.SpeechConnectionMessage(r.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",c))}extractSpeakerContext(t){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:t.profileIds,scenario:t.scenario}}};return Bn.SpeakerServiceRecognizer=a,Bn}var Fn={},xp;function sS(){if(xp)return Fn;xp=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.VoiceServiceRecognizer=void 0;const e=z(),r=A(),n=P(),u=T(),s=ze();let a=class extends u.ServiceRecognizerBase{constructor(t,o,c,p,d){super(t,o,c,p,d),this.privDeferralMap=new r.DeferralMap,this.privSpeakerAudioSource=c,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(t){this.privSpeakerAudioSource=t}processTypeSpecificMessages(t){let o=!1;const c=new n.PropertyCollection;switch(t.messageType===r.MessageType.Text&&c.setProperty(n.PropertyId.SpeechServiceResponse_JsonResult,t.textBody),t.path.toLowerCase()){case"speaker.profiles":const d=JSON.parse(t.textBody);switch(d.operation.toLowerCase()){case"create":this.handleCreateResponse(d,t.requestId);break;case"delete":case"reset":this.handleResultResponse(d,t.requestId);break;case"fetch":const f=JSON.parse(t.textBody);this.handleFetchResponse(f,t.requestId);break}o=!0;break;case"speaker.phrases":const l=JSON.parse(t.textBody);this.handlePhrasesResponse(l,t.requestId),o=!0;break;case"speaker.profile.enrollment":const h=JSON.parse(t.textBody),g=new n.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(h.enrollment?h.enrollment.enrollmentStatus:h.status.statusCode),h.enrollment?JSON.stringify(h.enrollment):void 0,h.status.reason);this.privDeferralMap.getId(t.requestId)&&this.privDeferralMap.complete(t.requestId,g),this.privRequestSession.onSpeechEnded(),o=!0;break}const p=new r.Deferred;return p.resolve(o),p.promise}cancelRecognition(t,o,c,p,d){new n.PropertyCollection().setProperty(u.CancellationErrorCodePropertyName,n.CancellationErrorCode[p]);const h=new n.VoiceProfileEnrollmentResult(n.ResultReason.Canceled,d,d);this.privDeferralMap.getId(o)&&this.privDeferralMap.complete(o,h)}async createProfile(t,o){this.voiceProfileType=t.toString();const c=this.connectImpl();try{const p=new r.Deferred;return await c,await this.sendCreateProfile(p,t,o),this.receiveMessage(),p.promise}catch(p){throw p}}async resetProfile(t){return this.voiceProfileType=t.profileType.toString(),this.sendCommonRequest("reset",t.profileType,t)}async deleteProfile(t){return this.voiceProfileType=t.profileType.toString(),this.sendCommonRequest("delete",t.profileType,t)}async retrieveEnrollmentResult(t){return this.voiceProfileType=t.profileType.toString(),this.privExpectedProfileId=t.profileId,this.sendCommonRequest("fetch",t.profileType,t)}async getAllProfiles(t){return this.voiceProfileType=t.toString(),this.sendCommonRequest("fetch",t)}async getActivationPhrases(t,o){this.voiceProfileType=t.toString();const c=this.connectImpl();try{const p=new r.Deferred;return await c,await this.sendPhrasesRequest(p,t,o),this.receiveMessage(),p.promise}catch(p){throw p}}async enrollProfile(t){this.voiceProfileType=t.profileType.toString();const o=new r.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(n.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const c=this.connectImpl(),p=this.sendPreAudioMessages(t,o),d=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),l=await this.privSpeakerAudioSource.format,h=await this.privSpeakerAudioSource.deviceInfo,g=new e.ReplayableAudioNode(d,l.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(g,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:h};try{await c,await p}catch(v){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.ConnectionFailure,v)}const f=new n.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,f),this.receiveMessage(),this.sendAudio(g).then(()=>{},v=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,n.CancellationReason.Error,n.CancellationErrorCode.RuntimeError,v)}),o.promise}async sendPreAudioMessages(t,o){const c=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,o),await this.sendBaseRequest(c,"enroll",this.scenarioFrom(t.profileType),t)}async sendPhrasesRequest(t,o,c){const p=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,t);const d=this.scenarioFrom(o),l={locale:c,scenario:d};return p.send(new s.SpeechConnectionMessage(r.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(l)))}async sendCreateProfile(t,o,c){const p=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,t);const d=o===n.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":o===n.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",l={locale:c,number:"1",scenario:d};return p.send(new s.SpeechConnectionMessage(r.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(l)))}async sendCommonRequest(t,o,c=void 0){const p=this.connectImpl();try{const d=new r.Deferred;this.privRequestSession.onSpeechContext(),await p;const l=await this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,d),await this.sendBaseRequest(l,t,this.scenarioFrom(o),c),this.receiveMessage(),d.promise}catch(d){throw d}}async sendBaseRequest(t,o,c,p){const d={scenario:c};return p?d.profileIds=[p.profileId]:d.maxPageSize=-1,t.send(new s.SpeechConnectionMessage(r.MessageType.Text,`speaker.profile.${o}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(d)))}extractSpeakerContext(t){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:t.profileIds,scenario:t.scenario}}handlePhrasesResponse(t,o){if(this.privDeferralMap.getId(o))if(t.status.statusCode.toLowerCase()!=="success"){const c=n.ResultReason.Canceled,p=new n.VoiceProfilePhraseResult(c,t.status.statusCode,t.passPhraseType,[]);this.privDeferralMap.complete(o,p)}else if(t.phrases&&t.phrases.length>0){const c=n.ResultReason.EnrollingVoiceProfile,p=new n.VoiceProfilePhraseResult(c,t.status.statusCode,t.passPhraseType,t.phrases);this.privDeferralMap.complete(o,p)}else throw new Error("Voice Profile get activation phrases failed, no phrases received");else throw new Error(`Voice Profile get activation phrases request for requestID ${o} not found`)}handleCreateResponse(t,o){if(t.profiles&&t.profiles.length>0)if(this.privDeferralMap.getId(o)){const c=t.profiles.map(p=>p.profileId);this.privDeferralMap.complete(o,c)}else throw new Error(`Voice Profile create request for requestID ${o} not found`);else throw new Error("Voice Profile create failed, no profile id received")}handleResultResponse(t,o){if(this.privDeferralMap.getId(o)){const c=t.operation.toLowerCase()==="delete"?n.ResultReason.DeletedVoiceProfile:n.ResultReason.ResetVoiceProfile,p=t.status.statusCode.toLowerCase()==="success"?c:n.ResultReason.Canceled,d=new n.VoiceProfileResult(p,`statusCode: ${t.status.statusCode}, errorDetails: ${t.status.reason}`);this.privDeferralMap.complete(o,d)}else throw new Error(`Voice Profile create request for requestID ${o} not found`)}handleFetchResponse(t,o){if(this.privDeferralMap.getId(o)&&t.profiles[0]){if(this.privExpectedProfileId&&t.profiles.length===1&&t.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const c=t.profiles[0],p=new n.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(c.enrollmentStatus),JSON.stringify(c),t.status.reason);this.privDeferralMap.complete(o,p)}else if(t.profiles.length>0){const c=t.profiles,p=[];for(const d of c)p.push(new n.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(d.enrollmentStatus),JSON.stringify(d),t.status.reason));this.privDeferralMap.complete(o,p)}}else throw new Error(`Voice Profile fetch request for requestID ${o} not found`)}enrollmentReasonFrom(t){switch(t.toLowerCase()){case"enrolled":return n.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return n.ResultReason.Canceled;default:return n.ResultReason.EnrollingVoiceProfile}}scenarioFrom(t){return t===n.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":t===n.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}};return Fn.VoiceServiceRecognizer=a,Fn}var vs={},Up;function oS(){return Up||(Up=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.type=e.connectivity=e.Device=e.OS=e.System=e.Context=e.SpeechServiceConfig=void 0;class r{constructor(t){this.context=t}serialize(){return JSON.stringify(this,(t,o)=>{if(o&&typeof o=="object"&&!Array.isArray(o)){const c={};for(const p in o)Object.hasOwnProperty.call(o,p)&&(c[p&&p.charAt(0).toLowerCase()+p.substring(1)]=o[p]);return c}return o})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(t){this.recognition=t.toLowerCase()}}e.SpeechServiceConfig=r;class n{constructor(t){this.system=new u,this.os=t}}e.Context=n;class u{constructor(){const t="1.44.1";this.name="SpeechSDK",this.version=t,this.build="JavaScript",this.lang="JavaScript"}}e.System=u;class s{constructor(t,o,c){this.platform=t,this.name=o,this.version=c}}e.OS=s;class a{constructor(t,o,c){this.manufacturer=t,this.model=o,this.version=c}}e.Device=a,function(i){i.Bluetooth="Bluetooth",i.Wired="Wired",i.WiFi="WiFi",i.Cellular="Cellular",i.InBuilt="InBuilt",i.Unknown="Unknown"}(e.connectivity||(e.connectivity={})),function(i){i.Phone="Phone",i.Speaker="Speaker",i.Car="Car",i.Headset="Headset",i.Thermostat="Thermostat",i.Microphones="Microphones",i.Deskphone="Deskphone",i.RemoteControl="RemoteControl",i.Unknown="Unknown",i.File="File",i.Stream="Stream"}(e.type||(e.type={}))}(vs)),vs}var Wp;function T(){return Wp||(Wp=1,function(e){var r=ie&&ie.__createBinding||(Object.create?function(a,i,t,o){o===void 0&&(o=t),Object.defineProperty(a,o,{enumerable:!0,get:function(){return i[t]}})}:function(a,i,t,o){o===void 0&&(o=t),a[o]=i[t]}),n=ie&&ie.__exportStar||function(a,i){for(var t in a)t!=="default"&&!Object.prototype.hasOwnProperty.call(i,t)&&r(i,a,t)};Object.defineProperty(e,"__esModule",{value:!0}),e.AutoDetectSourceLanguagesOpenRangeOptionName=e.ForceDictationPropertyName=e.ServicePropertiesPropertyName=e.CancellationErrorCodePropertyName=e.OutputFormatPropertyName=e.SpeechSynthesisAdapter=e.AvatarSynthesisAdapter=void 0,n(zl(),e),n(Nl(),e),n(Ts(),e),n(jl(),e),n(ql(),e),n(Ff(),e),n(xf(),e),n(Ms(),e),n(Xf(),e),n(Zf(),e),n(Yf(),e),n(eg(),e),n(tg(),e),n(rg(),e),n(ng(),e),n(ig(),e),n(sg(),e),n(Dd(),e),n(og(),e),n(ag(),e),n(cg(),e),n(ug(),e),n(pg(),e),n(dg(),e),n(hg(),e),n(lg(),e),n(vg(),e),n(fg(),e),n(Sg(),e),n(mg(),e),n(Cg(),e),n(yg(),e),n(Rg(),e),n(Pg(),e),n(Eg(),e),n(Ig(),e),n(Ag(),e),n(_g(),e),n(Mg(),e),n(Ng(),e),n(jg(),e),n(Jg(),e),n(Kd(),e),n(Qg(),e),n(Xg(),e);var u=Zg();Object.defineProperty(e,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return u.AvatarSynthesisAdapter}});var s=Yg();Object.defineProperty(e,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return s.SpeechSynthesisAdapter}}),n(eS(),e),n(tS(),e),n(rS(),e),n(nS(),e),n(iS(),e),n(sS(),e),n(oS(),e),e.OutputFormatPropertyName="OutputFormat",e.CancellationErrorCodePropertyName="CancellationErrorCode",e.ServicePropertiesPropertyName="ServiceProperties",e.ForceDictationPropertyName="ForceDictation",e.AutoDetectSourceLanguagesOpenRangeOptionName="UND"}(ie)),ie}var Vp;function IC(){return Vp||(Vp=1,function(e){var r=ne&&ne.__createBinding||(Object.create?function(s,a,i,t){t===void 0&&(t=i),Object.defineProperty(s,t,{enumerable:!0,get:function(){return a[i]}})}:function(s,a,i,t){t===void 0&&(t=i),s[t]=a[i]}),n=ne&&ne.__exportStar||function(s,a){for(var i in s)i!=="default"&&!Object.prototype.hasOwnProperty.call(a,i)&&r(a,s,i)};Object.defineProperty(e,"__esModule",{value:!0});const u=T();new u.AgentConfig,n(P(),e)}(ne)),ne}export{IC as r};
